<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2023-04-15 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>OpenID Connect</title>
<meta name="generator" content="Org mode">
<meta name="author" content="root">
<link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css' /><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Ultra&display=swap" rel="stylesheet"><link rel='stylesheet' href='../css/site.css' /><link rel='stylesheet' href='../roam/css/code.css' /><link rel='stylesheet' href='css/site.css' /><link rel='stylesheet' href='css/code.css' />
</head>
<body>
<div id="preamble" class="status">
<div><div class="header"><div class="container"><div class="row"><div class="col-sm-12 col-md-12"><nav class="navbar navbar-light"/></div></div></div></div></div>
</div>
<div id="content">
<h1 class="title">OpenID Connect</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgda1590d">概要</a></li>
<li><a href="#orgdf44f17">Memo</a>
<ul>
<li><a href="#org5e2b6bd">OAuthとの違い</a></li>
<li><a href="#org97c3b47">アクセストークンとIDトークン</a></li>
</ul>
</li>
<li><a href="#org8ca8cb7">Tasks</a>
<ul>
<li><a href="#org765bc49"><span class="todo TODO">TODO</span> THE OPENID CONNECT ハンドブック</a></li>
</ul>
</li>
<li><a href="#orgbec6015">Reference</a>
<ul>
<li><a href="#orgef8e152">一番分かりやすい OpenID Connect の説明 - Qiita</a></li>
<li><a href="#org6c3fb6f">IDトークンが分かれば OpenID Connect が分かる - Qiita</a></li>
<li><a href="#orge747386">OpenID Connect｜セキュリティ用語解説｜NRIセキュア</a></li>
</ul>
</li>
<li><a href="#org1a28c07">Archives</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgda1590d" class="outline-2">
<h2 id="orgda1590d"><a href="#orgda1590d">概要</a></h2>
<div class="outline-text-2" id="text-orgda1590d">
<p>
OpenID Connectとは、サービス間で、利用者の同意に基づきID情報を流通するための標準仕様。利用者がOpenID提供サイトに登録したID情報を使って、ほかのOpenID対応サイトにログインすることが可能になる。
</p>

<p>
OIDCと略される。
</p>

<p>
OpenID ConnectはOauth 2.0の拡張仕様。OAuth 2.0はアクセストークンを発行するための処理フローを定めている。流用してIDトークンも発行できるようにしたのがOpenID Connect。大雑把にいうと、「OpenID ConnectはIDトークンを発行するための仕様」。IDトークンはユーザが認証されたという事実とそのユーザの属性情報を捏造されていないことを確認可能な方法で、各所へ引き回すためにある。
</p>
</div>
</div>

<div id="outline-container-orgdf44f17" class="outline-2">
<h2 id="orgdf44f17"><a href="#orgdf44f17">Memo</a></h2>
<div class="outline-text-2" id="text-orgdf44f17">
</div>
<div id="outline-container-org5e2b6bd" class="outline-3">
<h3 id="org5e2b6bd"><a href="#org5e2b6bd">OAuthとの違い</a></h3>
<div class="outline-text-3" id="text-org5e2b6bd">
<p>
よく混同される。認証と認可の違い。
</p>

<ul class="org-ul">
<li><a href="20230203233541-oauth.html#ID-fb4240f7-7947-4897-98c7-4b6d325e8e29">OAuth</a>は認可の規格である(誰であるかは無視し、何ができるかに着目する。切符のようなもの)
<ul class="org-ul">
<li>認証は規格にないので、安全に認証に使うために独自実装が必要になる</li>
<li>AuthN</li>
</ul></li>
<li>OpenID Connectは<a href="20230203233541-oauth.html#ID-fb4240f7-7947-4897-98c7-4b6d325e8e29">OAuth</a>を拡張して、認証に対応できるようにしたもの
<ul class="org-ul">
<li>AuthZ</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-mermaid">flowchart LR
  a[OAuth]
  b[OpenID Connect]
  a -- 拡張 --&gt; b
</pre>
</div>


<div id="orgea86181" class="figure">
<p><img src="images/20230206221312-isxqxf5fpo.png" alt="20230206221312-isxqxf5fpo.png">
</p>
</div>

<div class="org-src-container">
<pre class="src src-mermaid">flowchart LR
C[クライアント]
S[認可サーバ]
R[リソースオーナー]

C -- 1.権限の移譲依頼 --&gt; S
S -- 2.許可の確認 --&gt; R
R -- 3.移譲許可 --&gt; S
S -- 4.アクセストークン発行 --&gt; C
</pre>
</div>


<div id="org286187d" class="figure">
<p><img src="images/20230206221343-VCXtSaBOae.png" alt="20230206221343-VCXtSaBOae.png">
</p>
</div>
</div>
</div>

<div id="outline-container-org97c3b47" class="outline-3">
<h3 id="org97c3b47"><a href="#org97c3b47">アクセストークンとIDトークン</a></h3>
<div class="outline-text-3" id="text-org97c3b47">
<ul class="org-ul">
<li>IDトークンは認証、アクセストークンが認可</li>
<li>IDトークンはユーザが認証されたことを証明するトークン。認証後のその先のリソースサーバにアクセスするための認可には使用できない</li>
<li>アクセストークンは認可サーバが生成し、クライアントがAPIでリソースを取り出すときに使う</li>
<li>IDトークンにはaudクレームが含まれる。そのトークンがどのクライアントのために発行されたものかという情報が入っている。なのでクライアントは自身のためのトークンかどうか調べることができる</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org8ca8cb7" class="outline-2">
<h2 id="org8ca8cb7"><a href="#org8ca8cb7">Tasks</a></h2>
<div class="outline-text-2" id="text-org8ca8cb7">
</div>
<div id="outline-container-org765bc49" class="outline-3">
<h3 id="org765bc49"><a href="#org765bc49"><span class="todo TODO">TODO</span> <a href="https://assets.ctfassets.net/2ntc334xpx65/5r2ozpfZopwqXGRxwipk9H/db4a4edda5e270cc9989c1fd5feeede0/jp-the-openid-connect-handbook.pdf">THE OPENID CONNECT ハンドブック</a></a></h3>
<div class="outline-text-3" id="text-org765bc49">
<p>
解説のPDF。
</p>
</div>
</div>
</div>
<div id="outline-container-orgbec6015" class="outline-2">
<h2 id="orgbec6015"><a href="#orgbec6015">Reference</a></h2>
<div class="outline-text-2" id="text-orgbec6015">
</div>
<div id="outline-container-orgef8e152" class="outline-3">
<h3 id="orgef8e152"><a href="#orgef8e152"><a href="https://qiita.com/TakahikoKawasaki/items/498ca08bbfcc341691fe">一番分かりやすい OpenID Connect の説明 - Qiita</a></a></h3>
<div class="outline-text-3" id="text-orgef8e152">
<p>
わかりやすい解説。
</p>

<ul class="org-ul">
<li>発行者の署名付きログイン情報</li>
<li>IDトークンの発行者をOpenID プロバイダーと呼ぶ</li>
<li>OpenIDプロバイダーがクライアントアプリケーションに対してIDトークンを発行する</li>
<li>トークンを発行する前にユーザに発行するか尋ねる。発行する場合は本人確認情報の提示を求める</li>
<li>本人確認情報が正しければIDトークンを生成し、クライアントアプリケーションに渡す</li>
<li>OpenID ConnectはOauth 2.0の拡張仕様。OAuth 2.0はアクセストークンを発行するための処理フローを定めている。流用してIDトークンも発行できるようにしたのがOpenID Connect</li>
<li>「OpenID Connect 1.0 は OAuth 2.0 プロトコル上のシンプルなアイデンティティレイヤーである」</li>
<li>IDトークンはユーザが認証されたという事実とそのユーザの属性情報を捏造されていないことを確認可能な方法で、各所に引き回すためにある</li>
</ul>
</div>
</div>
<div id="outline-container-org6c3fb6f" class="outline-3">
<h3 id="org6c3fb6f"><a href="#org6c3fb6f"><a href="https://qiita.com/TakahikoKawasaki/items/8f0e422c7edd2d220e06">IDトークンが分かれば OpenID Connect が分かる - Qiita</a></a></h3>
<div class="outline-text-3" id="text-org6c3fb6f">
<p>
トークンの中身を見ながらの解説。
</p>
</div>
</div>
<div id="outline-container-orge747386" class="outline-3">
<h3 id="orge747386"><a href="#orge747386"><a href="https://www.nri-secure.co.jp/glossary/openid-connect">OpenID Connect｜セキュリティ用語解説｜NRIセキュア</a></a></h3>
<div class="outline-text-3" id="text-orge747386">
<p>
解説。
</p>
</div>
</div>
</div>
<div id="outline-container-org1a28c07" class="outline-2">
<h2 id="org1a28c07"><a href="#org1a28c07">Archives</a></h2>
</div>
</div>
<div id="postamble" class="status">
<footer class="footer py-3"><div class="container"><div class="row "><div class="col-md-4"></div><div class="col-sm col-md"><nav class="navbar"><a class="nav-link text-secondary small px-0" href="./index.html">Insomnia</a><a class="nav-link text-secondary small px-0" href="./sitemap.html">Sitemap</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD/roam">Repository</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD">@kijimaD</a></nav></div><div class="col-md-4"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"/>
</div>
</body>
</html>
