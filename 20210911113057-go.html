<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-09-17 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Go</title>
<meta name="generator" content="Org mode">
<meta name="author" content="root">
<link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css' /><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Ultra&display=swap" rel="stylesheet"><link rel='stylesheet' href='css/site.css' /><link rel='stylesheet' href='css/code.css' />
</head>
<body>
<div id="preamble" class="status">
<div><div class="header"><div class="container"><div class="row"><div class="col-sm-12 col-md-12"><nav class="navbar navbar-light"/></div></div></div></div></div>
</div>
<div id="content">
<h1 class="title">Go</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org86067f0">概要</a></li>
<li><a href="#orga488039">Memo</a>
<ul>
<li><a href="#orgeab6f8e">基本コマンド</a></li>
<li><a href="#org6f2fa57">Emacsでの実行方法</a></li>
</ul>
</li>
<li><a href="#org5fa5a80">Tasks</a>
<ul>
<li><a href="#orgf4d9d7b"><span class="todo TODO">TODO</span> GoでDockerのAPIを叩いてみる | フューチャー技術ブログ</a></li>
<li><a href="#org424f69c"><span class="todo TODO">TODO</span> はじめてのゲームプログラミング（Ebiten）</a></li>
<li><a href="#org7c1be8f"><span class="todo TODO">TODO</span> Creating Cool Games With Ebiten | Golang Project Structure</a></li>
<li><a href="#orgac273fa"><span class="todo TODO">TODO</span> Roguelike Tutorial | Fat Old Yeti</a></li>
<li><a href="#org7fb1502"><span class="todo TODO">TODO</span> 2D Game Development in Golang — Part 1 | by Chris Andrews | Medium</a></li>
<li><a href="#orgc194be1"><span class="todo TODO">TODO</span> ファミコンエミュレータの創り方　- Hello, World!編 - - Qiita</a></li>
<li><a href="#orgdd471be"><span class="todo TODO">TODO</span> ゲームボーイのエミュレータをGoで作った話</a></li>
<li><a href="#org8ba93fd"><span class="todo WIP">WIP</span> 改訂2版 基礎からわかる Go言語 | 古川昇 | 工学 | Kindleストア | Amazon</a></li>
<li><a href="#org2433e7b"><span class="todo TODO">TODO</span> 「テスタビリティの高いGoのAPIサーバを開発しよう」というハンズオンを公開しました - DeNA Testing Blog</a></li>
<li><a href="#org0104cec"><span class="todo TODO">TODO</span> Goならわかるシステムプログラミング | 渋川 よしき, ごっちん |本 | 通販 - Amazon.co.jp</a></li>
<li><a href="#orgdb4a022"><span class="todo TODO">TODO</span> Client | Docker Code Walk</a></li>
<li><a href="#org1a39f1b"><span class="todo TODO">TODO</span> NuxtとGoではじめるWebアプリ開発【委託】 - 達人出版会</a></li>
<li><a href="#org7f17274"><span class="todo TODO">TODO</span> スターティングgRPC【委託】 - 達人出版会</a></li>
<li><a href="#orgbdf2e6c"><span class="todo TODO">TODO</span> エキスパートたちのGo言語 一流のコードから応用力を学ぶ | Gihyo Digital Publishing … 技術評論社の電子書籍</a></li>
<li><a href="#org524bcc7"><span class="todo TODO">TODO</span> 改訂2版 みんなのGo言語 | Gihyo Digital Publishing … 技術評論社の電子書籍</a></li>
<li><a href="#orga29c602"><span class="todo TODO">TODO</span> Goプログラミング実践入門 標準ライブラリでゼロからWebアプリを作る【委託】 - 達人出版会</a></li>
<li><a href="#org4be620e"><span class="todo TODO">TODO</span> O&rsquo;Reilly Japan - Go言語でつくるインタプリタ</a></li>
<li><a href="#orga6c9fd2"><span class="todo TODO">TODO</span> 詳解Go言語Webアプリケーション開発｜Tech Book Zone Manatee</a></li>
<li><a href="#org7bc89bb"><span class="todo TODO">TODO</span> Go Design Patterns</a></li>
<li><a href="#orge2ed8c1"><span class="todo TODO">TODO</span> Cloud Native Go</a></li>
<li><a href="#orgb4952a0"><span class="todo TODO">TODO</span> Go and Go-Moku The Oriental Board Games</a></li>
<li><a href="#org9d8aada"><span class="todo TODO">TODO</span> Mastering Go Create Golang production applications using network libraries, concurrency, and advanced Go data structures</a></li>
<li><a href="#orgf0563ab"><span class="todo TODO">TODO</span> RESTful Go APIs Design und Implementierung leichtgewichtiger Hypermedia Services</a></li>
<li><a href="#orga8456a0"><span class="todo TODO">TODO</span> Hands-On System Programming with Go</a></li>
<li><a href="#org97d8ea4"><span class="todo TODO">TODO</span> Powerful Command-Line Applications in Go</a></li>
<li><a href="#org134cc7d"><span class="todo TODO">TODO</span> Build an Orchestrator in Go</a></li>
<li><a href="#orgdd2bea3"><span class="todo TODO">TODO</span> The Docker Book</a></li>
</ul>
</li>
<li><a href="#org4714c5e">Reference</a>
<ul>
<li><a href="#orgedbbb7a">The Go Programming Language Specification - The Go Programming Language</a></li>
<li><a href="#org781765c">Ebitengine - A dead simple 2D game library for Go</a></li>
</ul>
</li>
<li><a href="#orgf7c3a34">Archives</a>
<ul>
<li><a href="#orgc3c7e67"><span class="done DONE">DONE</span> EmacsにLSP+DAPを設定する</a></li>
<li><a href="#org2d16dd0"><span class="done DONE">DONE</span> Go言語を楽しむ5つのレシピ コタツと蜜柑とゴーファーとわたし【委託】 - 達人出版会</a></li>
<li><a href="#org8fd4af4"><span class="done DONE">DONE</span> A Tour of Go</a></li>
<li><a href="#org21524bd"><span class="done DONE">DONE</span> Docker Engine SDKでコンテナ一覧を取得する | DevelopersIO</a></li>
<li><a href="#orge2a5da7"><span class="done DONE">DONE</span> GoでDockerを操る [Docker Engine SDK] - はいばらのブログ</a></li>
<li><a href="#org005cb19"><span class="done DONE">DONE</span> Goで作成したAPIをDockerで動かす</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org86067f0" class="outline-2">
<h2 id="org86067f0"><a href="#org86067f0">概要</a></h2>
<div class="outline-text-2" id="text-org86067f0">
<p>
Go言語はGoogleによって開発された<a href="20210509101246-programming_language.html#ID-868ac56a-2d42-48d7-ab7f-7047c85a8f39">Programming Language</a>。<a href="20210805005543-docker.html#ID-1658782a-d331-464b-9fd7-1f8233b8b7f8">Docker</a>はGoで書かれている。シンプルさをコンセプトにしている。シンプルすぎて必要な機能が足りてない、という批判もあるくらい。
</p>
</div>
</div>
<div id="outline-container-orga488039" class="outline-2">
<h2 id="orga488039"><a href="#orga488039">Memo</a></h2>
<div class="outline-text-2" id="text-orga488039">
</div>
<div id="outline-container-orgeab6f8e" class="outline-3">
<h3 id="orgeab6f8e"><a href="#orgeab6f8e">基本コマンド</a></h3>
<div class="outline-text-3" id="text-orgeab6f8e">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>mod.goを作成する</label><pre class="src src-shell">go mod init example
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>依存パッケージをインストールする。mod.goに記載される</label><pre class="src src-shell">go install
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>ビルド+実行</label><pre class="src src-shell">go run hello.go
</pre>
</div>

<p>
<a href="20210508234743-emacs.html#ID-1ad8c3d5-97ba-4905-be11-e6f2626127ad">Emacs</a> dap-modeでデバッガ起動。行の横をクリックしてブレークポイントをセットしたのち、コマンド実行。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 4: </span>デバッグ実行</label><pre class="src src-emacs-lisp">M-x dap-debug
</pre>
</div>
</div>
</div>

<div id="outline-container-org6f2fa57" class="outline-3">
<h3 id="org6f2fa57"><a href="#org6f2fa57"><a href="20210508234743-emacs.html#ID-1ad8c3d5-97ba-4905-be11-e6f2626127ad">Emacs</a>での実行方法</a></h3>
<div class="outline-text-3" id="text-org6f2fa57">
<p>
ob-goをインストールして <code>(require "ob-go")</code> する。実行方法が少し変わっていて、下のように指定する。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 5: </span>babel引数で指定importを指定する。本文には書かない</label><pre class="src src-go">fmt.Println("hello world")
</pre>
</div>

<div class="results" id="orgb442f0c">
<p>
hello world
</p>

</div>

<ul class="org-ul">
<li><a href="https://github.com/pope/ob-go">pope/ob-go: Org-Babel support for evaluating go code.</a></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org5fa5a80" class="outline-2">
<h2 id="org5fa5a80"><a href="#org5fa5a80">Tasks</a></h2>
<div class="outline-text-2" id="text-org5fa5a80">
</div>
<div id="outline-container-orgf4d9d7b" class="outline-3">
<h3 id="orgf4d9d7b"><a href="#orgf4d9d7b"><span class="todo TODO">TODO</span> <a href="https://future-architect.github.io/articles/20210427b/">GoでDockerのAPIを叩いてみる | フューチャー技術ブログ</a></a></h3>
<div class="outline-text-3" id="text-orgf4d9d7b">
<p>
goとdocker。
</p>
</div>
</div>
<div id="outline-container-org424f69c" class="outline-3">
<h3 id="org424f69c"><a href="#org424f69c"><span class="todo TODO">TODO</span> <a href="https://zenn.dev/hokita/articles/66cc118b227ae3">はじめてのゲームプログラミング（Ebiten）</a></a></h3>
<div class="outline-text-3" id="text-org424f69c">
<p>
簡単なゲームのチュートリアル。
</p>
</div>
</div>
<div id="outline-container-org7c1be8f" class="outline-3">
<h3 id="org7c1be8f"><a href="#org7c1be8f"><span class="todo TODO">TODO</span> <a href="https://golangprojectstructure.com/creating-cool-games-with-ebiten-in-go/">Creating Cool Games With Ebiten | Golang Project Structure</a></a></h3>
<div class="outline-text-3" id="text-org7c1be8f">
<p>
ゲームのチュートリアル。
</p>
</div>
</div>
<div id="outline-container-orgac273fa" class="outline-3">
<h3 id="orgac273fa"><a href="#orgac273fa"><span class="todo TODO">TODO</span> <a href="https://www.fatoldyeti.com/categories/roguelike-tutorial/">Roguelike Tutorial | Fat Old Yeti</a></a></h3>
<div class="outline-text-3" id="text-orgac273fa">
<p>
Ebitenでローグライクを作るチュートリアル。
</p>
</div>
</div>
<div id="outline-container-org7fb1502" class="outline-3">
<h3 id="org7fb1502"><a href="#org7fb1502"><span class="todo TODO">TODO</span> <a href="https://medium.com/@chrisandrews_76960/2d-game-development-in-golang-part-1-5e2c11a513ed">2D Game Development in Golang — Part 1 | by Chris Andrews | Medium</a></a></h3>
<div class="outline-text-3" id="text-org7fb1502">
<p>
Ebitenの小さなチュートリアル。
</p>
</div>
</div>
<div id="outline-container-orgc194be1" class="outline-3">
<h3 id="orgc194be1"><a href="#orgc194be1"><span class="todo TODO">TODO</span> <a href="https://qiita.com/bokuweb/items/1575337bef44ae82f4d3">ファミコンエミュレータの創り方　- Hello, World!編 - - Qiita</a></a></h3>
<div class="outline-text-3" id="text-orgc194be1">
<p>
エミュレータの作り方の概要。
</p>
</div>
</div>
<div id="outline-container-orgdd471be" class="outline-3">
<h3 id="orgdd471be"><a href="#orgdd471be"><span class="todo TODO">TODO</span> <a href="https://zenn.dev/akatsuki/articles/ec95ab95f0e89ea8c38f">ゲームボーイのエミュレータをGoで作った話</a></a></h3>
<div class="outline-text-3" id="text-orgdd471be">
<p>
作り方の解説。
</p>
</div>
</div>
<div id="outline-container-org8ba93fd" class="outline-3">
<h3 id="org8ba93fd"><a href="#org8ba93fd"><span class="todo WIP">WIP</span> <a href="https://www.amazon.co.jp/%E6%94%B9%E8%A8%822%E7%89%88-%E5%9F%BA%E7%A4%8E%E3%81%8B%E3%82%89%E3%82%8F%E3%81%8B%E3%82%8B-Go%E8%A8%80%E8%AA%9E-%E5%8F%A4%E5%B7%9D%E6%98%87-ebook/dp/B06WP6S2QT/ref=sr_1_1?__mk_ja_JP=%E3%82%AB%E3%82%BF%E3%82%AB%E3%83%8A&amp;crid=1GPYX46MK3OK&amp;keywords=%E5%9F%BA%E7%A4%8E%E3%81%8B%E3%82%89%E3%82%8F%E3%81%8B%E3%82%8B+go%E8%A8%80%E8%AA%9E&amp;qid=1663028634&amp;sprefix=%E5%9F%BA%E7%A4%8E%E3%81%8B%E3%82%89%E3%82%8F%E3%81%8B%E3%82%8Bgo%E8%A8%80%E8%AA%9E%2Caps%2C2056&amp;sr=8-1">改訂2版 基礎からわかる Go言語 | 古川昇 | 工学 | Kindleストア | Amazon</a></a></h3>
<div class="outline-text-3" id="text-org8ba93fd">
<ul class="org-ul">
<li>117, 133, 141</li>
</ul>

<p>
Go言語の入門本。
</p>

<ul class="org-ul">
<li>Goでは、最初の文字が大文字で始まる名前は、外部のパッケージから参照できるエクスポートされた名前。例えばPiはmathパッケージでエクスポートされる</li>
</ul>

<div class="org-src-container">
<pre class="src src-go">package main
import (
        "fmt"
        "math"
)
func main() {
        fmt.println(Math.pi)
}
</pre>
</div>

<ul class="org-ul">
<li>変数が存在するメモリ上の位置を「アドレス」といい、そのアドレスを格納可能な変数を「ポインタ」という</li>
<li><code>int</code> 型変数のアドレスを格納できるポインタの型は <code>*int</code> 型というように、アスタリスクをつける</li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 6: </span>ポインタ</label><pre class="src src-go">var ptr *int
var i int = 12345
ptr = &amp;i

fmt.Println("iのアドレス:", &amp;i)
fmt.Println("ptrの値(変数iのアドレス):", ptr)

fmt.Println("iの値:", i)
fmt.Println("ポインタ経由のiの値:", *ptr)

*ptr = 999
fmt.Println("ポインタ経由で変更したiの値:", i)
</pre>
</div>

<div class="results" id="orgd887c8d">
<p>
iのアドレス: 0xc0000b6010
ptrの値(変数iのアドレス): 0xc0000b6010
iの値: 12345
ポインタ経由のiの値: 12345
ポインタ経由で変更したiの値: 999
</p>

</div>

<div class="org-src-container">
<pre class="src src-go">func main() {
        a, b := 1, 1

        double(a, &amp;b)
        fmt.Println("値渡し:", a)
        fmt.Println("ポインタ渡し:", b)
}

func double(x int, y *int) {
        x = x * 2
        *y = *y * 2
}
</pre>
</div>

<div class="results" id="org11d45e9">
<p>
値渡し: 1
ポインタ渡し: 2
</p>

</div>

<p>
関数リテラル。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 7: </span>関数リテラル = 無名関数</label><pre class="src src-go">func main() {
        val := 123

        // 関数リテラルの記述と呼び出しを同時に行う
        func(i int) {
                // 関数リテラル外の変数valにアクセス可能
                fmt.Println(i * val)
        }(10)

        // 関数リテラルを変数に代入
        f := func(s string) {
                fmt.Println(s)
        }

        f("hoge")
}
</pre>
</div>

<div class="results" id="orga3bd689">
<p>
1230
hoge
</p>

</div>

<p>
関数型。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 8: </span>代入して呼び出す</label><pre class="src src-go">func main() {
        // 関数型の変数宣言
        var f func(int, int) int

        // 関数リテラルの値を代入
        f = func(a int, b int) int {
                return a + b
        }

        // 関数型の変数経由で関数を呼び出す
        fmt.Println(f(1, 2))


        // 関数型の変数に値を代入
        f = multiply

        // 関数型の変数経由で関数を呼び出す
        fmt.Println(f(1, 2))
}

func multiply(x int, y int) int {
        return x * y
}
</pre>
</div>

<div class="results" id="orgf5d1d54">
<p>
3
2
</p>

</div>

<p>
メソッドの宣言。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 9: </span>型に実装する</label><pre class="src src-go">type myType int

// myType型をレシーバに持つ関数、すなわちmyType型のメソッドを宣言。レシーバは一番最初に書く
func (value myType) println() {
        fmt.Println(value)
}

func main() {
        // myType型の変数を宣言する
        var z myType = 1234

        // myType型のメソッドを呼び出す
        z.println()
}
</pre>
</div>

<div class="results" id="org609cdf5">
<p>
1234
</p>

</div>

<p>
メソッドのレシーバをポインタにする。
</p>

<div class="org-src-container">
<pre class="src src-go">// int型
type myType int

func (value myType) setByValue(newValue myType) {
        // ここで値を代入しても無意味。Valueはコピーされるので
        value = newValue
}

func(value *myType) setByPointer(newValue myType) {
        // 代入した値が反映される
        *value = newValue
}
func main() {
        var x myType = 0

        // レシーバは値。値は変更できない
        x.setByValue(1)
        fmt.Println("値: 0 -&gt;", x)

        // レシーバはポインタ。値は変更できる
        x.setByPointer(2)
        fmt.Println("ポインタ: 0 -&gt;", x)
}

</pre>
</div>

<div class="results" id="orgf8748c2">
<p>
値: 0 -&gt; 0
ポインタ: 0 -&gt; 2
</p>

</div>

<p>
構造体型に名前をつける。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 10: </span>構造体にMyDataという新しい型名を与える</label><pre class="src src-go">type MyData struct {
      s string
      b byte
}
</pre>
</div>

<div class="results" id="org2df5b10">

</div>

<ul class="org-ul">
<li>メソッドの宣言には値レシーバ、ポインタレシーバの2つがある。混在させるべきではない
<ul class="org-ul">
<li>変数レシーバではメソッドの操作は元の変数のコピーを操作する</li>
<li>ポインタレシーバでは、ポインタを使うので元の変数を変更できる</li>
</ul></li>
<li>ポインタレシーバを使う2つの理由
<ul class="org-ul">
<li>メソッドがレシーバが指す先の変数を変更するため</li>
<li>メソッドの呼び出し毎に変数のコピーを避けるため</li>
</ul></li>
</ul>

<p>
匿名フィールド。匿名フィールドが持つフィールドとメソッドが、埋め込み先の構造体型にも実装されているかのように扱われる。Go言語には型の実装はないが、構造体に他の型を埋め込むことで継承似たようなことを実現できる。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 11: </span>埋め込み</label><pre class="src src-go">// 埋め込まれる型の構造体
type embedded struct {
        i int
}

// embedded型のメソッド
func (x embedded) doSomething() {
        fmt.Println("test.doSomething()")
}

// 埋め込み先の構造体
type test struct {
        embedded // embedded型の埋め込み
}

func main() {
        var x test

        // embedded型に実装されているメソッドに、test型の値でアクセス
        x.doSomething()

        // embedded型のフィールドに、test型の値でアクセス
        fmt.Println(x.i)
}
</pre>
</div>

<div class="results" id="org2ac99ca">
<p>
test.doSomething()
0
</p>

</div>

<p>
構造体の初期化。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 12: </span>2つの方法がある</label><pre class="src src-go">type Person struct {
        name string
        age int
}

func main() {
        // 構造体リテラルを使用せず、フィールドを個別に初期化
        var p1 Person
        p1.name = "Jhon"
        p1.age = 23

        // 構造体リテラルで初期化
        p2 := Person{age: 31, name: "Tom"}
        p3 := Person{"Jane", 42}
        p4 := &amp;Person{"Mike", 36}
        fmt.Println(p1, p2, p3, p4)
}
</pre>
</div>

<div class="results" id="org1d371da">
<p>
{Jhon 23} {Tom 31} {Jane 42} &amp;{Mike 36}
</p>

</div>

<p>
埋め込みを行った構造体を構造体リテラルで初期化する。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 13: </span>埋め込み</label><pre class="src src-go">type Person struct {
        name string
        age int
}

type Employee struct {
        id int
        Person // 埋め込み
}

func main() {
        e := Employee{1, Person{"jack", 28}}
        fmt.Println(e)
}
</pre>
</div>

<div class="results" id="orgaeb9c20">
<p>
{1 {jack 28}}
</p>

</div>

<p>
Go言語のインターフェースの役割は「振る舞い」を規定すること。Go言語のインターフェースは「インターフェース」と「それを実装した型」との関係性を明示的に記述する必要がない。インターフェースに定義されている関数をメソッドとして実装している型は、自動的にそのインターフェースを実装していることになる。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 14: </span>インターフェースと型は自動で関連付けられる</label><pre class="src src-go">type Calculator interface {
        // 関数の定義
        Calculate(a int, b int) int
}

type Add struct {
        // フィールドは持たない
}

// Add型にCalculatorインターフェースのCalculator関数を実装
func (x Add) Calculate(a int, b int) int {
        return a + b
}

type Sub struct { }

func (x Sub) Calculate(a int, b int) int {
        return a - b
}

func main() {
        var add Add
        var sub Sub

        var cal Calculator // interface

        cal = add // interfaceを満たす関数を持っているので、自動的にインターフェースを実装していることになり、代入できる
        fmt.Println("和:", cal.Calculate(1, 2))

        cal = sub
        fmt.Println("差:", cal.Calculate(1, 2))
}
</pre>
</div>

<div class="results" id="org30fd08e">
<p>
和: 3
差: -1
</p>

</div>

<p>
空インターフェース。関数を持たない空のインターフェース。定義関数をすべて実装している型はインターフェースを実装したことになるので、すべての型は空インターフェースを実装していることになる。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 15: </span>空インターフェース。どんな値でも代入できる。_ は未使用エラーを防ぐため</label><pre class="src src-go">var empty interface {}

empty = "abc"
empty = 12345
empty = 3.14

_ = empty
</pre>
</div>

<div class="results" id="org511e0bc">

</div>

<p>
関数を1つしか持たないインターフェースの場合、そのインターフェース名は「関数名+er」とするのが慣わし。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 16: </span>関数名がReadであれば、インターフェース名はReader</label><pre class="src src-go">type Reader interface {
        Read(p []byte) (n int, err error)
}
</pre>
</div>

<p>
型アサーションはインターフェース型の値を他の型へ変換するとき、または変換できるか確認するときに使う。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 17: </span>型アサーション</label><pre class="src src-go">func main() {
        // 空インターフェースにstring型の値を格納
        var i interface{} = "test"
        // 型アサーションを使いstring型へ
        var s string = i.(string) // 型アサーション
        fmt.Printf("i: %T\n", i)
        fmt.Printf("s: %T\n", s)
}
</pre>
</div>

<div class="results" id="org1bf63b6">
<p>
i: string
s: string
</p>

</div>

<p>
型アサーション失敗時にランタイムパニックを発生させない。チェックに使う。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 18: </span>型アサーションから2番目の値を受け取るときは、変換できなくてもランタイムパニックは起きない</label><pre class="src src-go">func main() {
        // 空インターフェースにstring型の値を格納
        var i interface{} = "test"

        // 型アサーションに成功する例
        s1, ok := i.(string)
        fmt.Println(s1, ok)

        // 型アサーションに失敗する例
        // string型はdummyメソッドを持たないので変換できない
        s2, ok := i.(interface {
                dummy()
        })
        fmt.Println(s2, ok)
}
</pre>
</div>

<div class="results" id="org94e8988">
<p>
test true
&lt;nil&gt; false
</p>

</div>

<p>
型switch文。通常のswitch文とは異なる。式switchが値によって分岐するのに対し、型switch文は値が持つ型によって分岐する。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 19: </span>型switch</label><pre class="src src-go">func main() {
        showType(nil)
        showType(12345)
        showType("abcdef")
        showType(3.14)
}

func showType(x interface{}) {
        switch x.(type) {

        case nil:
                fmt.Println("nil")

        case int, int32, int64:
                fmt.Println("整数")

        case string:
                fmt.Println("文字列")

        default:
                fmt.Println("不明")
        }
}
</pre>
</div>

<div class="results" id="orge0e767b">
<p>
nil
整数
文字列
不明
</p>

</div>

<p>
配列アクセス。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 20: </span>配列にアクセスする</label><pre class="src src-go">func main() {
        var date [7]string

        date[0] = "日曜日"
        date[1] = "月曜日"
        date[2] = "火曜日"
        date[3] = "水曜日"
        date[4] = "木曜日"
        date[5] = "金曜日"
        date[6] = "土曜日"

        // indexバージョン
        for i := 0; i &lt; len(date); i++ {
                fmt.Print(date[i], " ")
        }

        // rangeバージョン
        // 改行
        fmt.Println()

        for _, value := range date {
                fmt.Print(value, " ")
        }

        fmt.Println()
}
</pre>
</div>

<div class="results" id="org3e1d777">
<p>
日曜日 月曜日 火曜日 水曜日 木曜日 金曜日 土曜日
日曜日 月曜日 火曜日 水曜日 木曜日 金曜日 土曜日
</p>

</div>

<ul class="org-ul">
<li>スライス → 可変長</li>
<li>配列 → 非可変長</li>
</ul>

<p>
スライス式。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 21: </span>スライスにアクセスする</label><pre class="src src-go">func main() {
        // 配列を宣言
        x := [5]string{"a", "b", "c", "d", "e"}
        // スライス型の変数を宣言
        var s1 []string

        // 配列全体をスライス
        s1 = x[:]
        fmt.Println(s1)

        // インデックス1~3までをスライス
        s2 := x[1:4]
        fmt.Println(s2)

        // インデックス3~をスライス
        s3 := x[3:]
        fmt.Println(s3)

        // インデックス1~3をスライス
        s4 := x[:4]
        fmt.Println(s4)
}
</pre>
</div>

<div class="results" id="org33ef9dc">
<p>
[a b c d e]
[b c d]
[d e]
[a b c d]
</p>

</div>

<p>
スライスは「参照型」の1つ。Go言語にはスライス、マップ、チャネルという3つの参照型がある。データの実体を持たず、データへの参照情報しか持たない。
</p>

<p>
スライスを可変長パラメータに直接受け渡す。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 22: </span>スライス&#x2026;で展開して渡す</label><pre class="src src-go">func main() {
        s := []string{"a", "b", "c"}

        // 以下2つの結果は同じ
        test(s...)
        test("a", "b", "c")
}
func test(s ...string) {
        fmt.Println(len(s), s)
}
</pre>
</div>

<div class="results" id="orgb1c9cc4">
<p>
3 [a b c]
3 [a b c]
</p>

</div>

<p>
エラーハンドリング。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 23: </span>存在しないファイルを参照して失敗させて検証する</label><pre class="src src-go">func main() {
        file, err := os.Open("test.txt")

        if err != nil {
                fmt.Println(err.Error())
                // os.Exit(1)
        }

        file.Close()
        fmt.Println("finish")
}
</pre>
</div>

<div class="results" id="orgcbe911c">
<p>
open test.txt: no such file or directory
finish
</p>

</div>

<p>
独自のエラー処理。
</p>

<div class="org-src-container">
<pre class="src src-go">        type MyError struct {
                message string
        }

        func (err MyError) Error() string {
                return err.message
        }

      func main() {
          val, err := hex2int("1")
          fmt.Println(val, err)

          val, err = hex2int("00000f")
          fmt.Println(val, err)

          val, err = hex2int("abcd")
          fmt.Println(val, err)

          val, err = hex2int("z")
          fmt.Println(val, err)
    }

// 16進数文字列をint型に変換する
  func hex2int(hex string) (val int, err error) {
        // 1文字づつ取り出す
      for _, r := range hex {
            val *= 16
            switch {
                  case '0' &lt;= r &amp;&amp; r &lt;= '9':
                  val += int(r - '0')
                  case 'a' &lt;= r &amp;&amp; r &lt;= 'f':
                  val += int(r-'a') + 10
                  default:
                  return 0, MyError{"不正な文字列です。" + string(r)}
            }
      }

      // 戻り値errには初期値であるnilが返る
      return
}

</pre>
</div>

<div class="results" id="org2a91a67">
<p>
1 &lt;nil&gt;
15 &lt;nil&gt;
43981 &lt;nil&gt;
0 不正な文字列です。z
</p>

</div>
</div>
</div>


<div id="outline-container-org2433e7b" class="outline-3">
<h3 id="org2433e7b"><a href="#org2433e7b"><span class="todo TODO">TODO</span> <a href="https://swet.dena.com/entry/2021/12/07/123000">「テスタビリティの高いGoのAPIサーバを開発しよう」というハンズオンを公開しました - DeNA Testing Blog</a></a></h3>
<div class="outline-text-3" id="text-org2433e7b">
<p>
GoのAPIハンズオン。
</p>
</div>
</div>
<div id="outline-container-org0104cec" class="outline-3">
<h3 id="org0104cec"><a href="#org0104cec"><span class="todo TODO">TODO</span> <a href="https://www.amazon.co.jp/Go%E3%81%AA%E3%82%89%E3%82%8F%E3%81%8B%E3%82%8B%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0-%E6%B8%8B%E5%B7%9D-%E3%82%88%E3%81%97%E3%81%8D/dp/4908686033/ref=sr_1_3?keywords=go+%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0&amp;qid=1653145833&amp;sprefix=go+%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%2Caps%2C206&amp;sr=8-3">Goならわかるシステムプログラミング | 渋川 よしき, ごっちん |本 | 通販 - Amazon.co.jp</a></a></h3>
<div class="outline-text-3" id="text-org0104cec">
<p>
途中まで読んだが、あまりおもしろくないので後回しにする。
</p>

<ul class="org-ul">
<li>36, 53</li>
</ul>

<p>
低レイヤ処理をGoで学ぶ本。
</p>

<ul class="org-ul">
<li>まずデバッガ環境を整えることから</li>
<li>ファイルディスクリプタに対応するものは、通常のファイルに限らない。標準入出力/ソケット/OS/CPUに内蔵されている乱数生成の仕組みなど、ファイルではないものにもファイルディスクリプタが割り当てられ、どれもファイルと同じようにアクセスできる</li>
<li>OSは、プロセスが起動されるとまず3つの疑似ファイルを作成し、それぞれにファイルディスクリプタを割り当てる。0が標準入力、1が標準出力、2が標準エラー出力</li>
<li>可能な限りすべてのものがファイルとして抽象化されている</li>
<li>go言語ではファイルディスクリプタのような共通化の仕組みを言語レベルで持ってOSによる差異を吸収している。io.Writer</li>
<li>インターフェースは、構造体と違って何かしら実態を持つものを表すのではなく、「どんなことができるか」を宣言しているだけ</li>
</ul>
</div>
</div>

<div id="outline-container-orgdb4a022" class="outline-3">
<h3 id="orgdb4a022"><a href="#orgdb4a022"><span class="todo TODO">TODO</span> <a href="https://wxdublin.gitbooks.io/docker-code-walk/content/client.html">Client | Docker Code Walk</a></a></h3>
<div class="outline-text-3" id="text-orgdb4a022">
<p>
Dockerコードの概略。
</p>
</div>
</div>
<div id="outline-container-org1a39f1b" class="outline-3">
<h3 id="org1a39f1b"><a href="#org1a39f1b"><span class="todo TODO">TODO</span> <a href="https://tatsu-zine.com/books/nuxt-go-web-app-development">NuxtとGoではじめるWebアプリ開発【委託】 - 達人出版会</a></a></h3>
<div class="outline-text-3" id="text-org1a39f1b">
<p>
動画検索アプリを題材に、NuxtとGoを使ったアプリ開発。
</p>
</div>
</div>
<div id="outline-container-org7f17274" class="outline-3">
<h3 id="org7f17274"><a href="#org7f17274"><span class="todo TODO">TODO</span> <a href="https://tatsu-zine.com/books/starting-grpc">スターティングgRPC【委託】 - 達人出版会</a></a></h3>
<div class="outline-text-3" id="text-org7f17274">
<p>
サーバ側Go, クライアント側Rubyと異なる言語を用いてサンプルアプリケーションを実装する。
</p>
</div>
</div>
<div id="outline-container-orgbdf2e6c" class="outline-3">
<h3 id="orgbdf2e6c"><a href="#orgbdf2e6c"><span class="todo TODO">TODO</span> <a href="https://gihyo.jp/dp/ebook/2021/978-4-297-12520-2">エキスパートたちのGo言語 一流のコードから応用力を学ぶ | Gihyo Digital Publishing … 技術評論社の電子書籍</a></a></h3>
<div class="outline-text-3" id="text-orgbdf2e6c">
<p>
ノウハウ集。
</p>
</div>
</div>
<div id="outline-container-org524bcc7" class="outline-3">
<h3 id="org524bcc7"><a href="#org524bcc7"><span class="todo TODO">TODO</span> <a href="https://gihyo.jp/dp/ebook/2019/978-4-297-10728-4">改訂2版 みんなのGo言語 | Gihyo Digital Publishing … 技術評論社の電子書籍</a></a></h3>
<div class="outline-text-3" id="text-org524bcc7">
<p>
わかりやすいという入門書。
</p>
</div>
</div>
<div id="outline-container-orga29c602" class="outline-3">
<h3 id="orga29c602"><a href="#orga29c602"><span class="todo TODO">TODO</span> <a href="https://tatsu-zine.com/books/go-web-programming">Goプログラミング実践入門 標準ライブラリでゼロからWebアプリを作る【委託】 - 達人出版会</a></a></h3>
<div class="outline-text-3" id="text-orga29c602">
<ul class="org-ul">
<li>27</li>
</ul>

<p>
ゼロから実装する。
</p>
</div>
</div>
<div id="outline-container-org4be620e" class="outline-3">
<h3 id="org4be620e"><a href="#org4be620e"><span class="todo TODO">TODO</span> <a href="https://www.oreilly.co.jp/books/9784873118222/">O&rsquo;Reilly Japan - Go言語でつくるインタプリタ</a></a></h3>
<div class="outline-text-3" id="text-org4be620e">
<p>
インタプリタを実装する。
</p>
</div>
</div>
<div id="outline-container-orga6c9fd2" class="outline-3">
<h3 id="orga6c9fd2"><a href="#orga6c9fd2"><span class="todo TODO">TODO</span> <a href="https://book.mynavi.jp/manatee/books/detail/id=131170">詳解Go言語Webアプリケーション開発｜Tech Book Zone Manatee</a></a></h3>
<div class="outline-text-3" id="text-orga6c9fd2">
<p>
web開発の入門書。
</p>
</div>
</div>
<div id="outline-container-org7bc89bb" class="outline-3">
<h3 id="org7bc89bb"><a href="#org7bc89bb"><span class="todo TODO">TODO</span> Go Design Patterns</a></h3>
</div>
<div id="outline-container-orge2ed8c1" class="outline-3">
<h3 id="orge2ed8c1"><a href="#orge2ed8c1"><span class="todo TODO">TODO</span> Cloud Native Go</a></h3>
</div>
<div id="outline-container-orgb4952a0" class="outline-3">
<h3 id="orgb4952a0"><a href="#orgb4952a0"><span class="todo TODO">TODO</span> Go and Go-Moku The Oriental Board Games</a></h3>
</div>
<div id="outline-container-org9d8aada" class="outline-3">
<h3 id="org9d8aada"><a href="#org9d8aada"><span class="todo TODO">TODO</span> Mastering Go Create Golang production applications using network libraries, concurrency, and advanced Go data structures</a></h3>
</div>
<div id="outline-container-orgf0563ab" class="outline-3">
<h3 id="orgf0563ab"><a href="#orgf0563ab"><span class="todo TODO">TODO</span> RESTful Go APIs Design und Implementierung leichtgewichtiger Hypermedia Services</a></h3>
</div>
<div id="outline-container-orga8456a0" class="outline-3">
<h3 id="orga8456a0"><a href="#orga8456a0"><span class="todo TODO">TODO</span> Hands-On System Programming with Go</a></h3>
</div>
<div id="outline-container-org97d8ea4" class="outline-3">
<h3 id="org97d8ea4"><a href="#org97d8ea4"><span class="todo TODO">TODO</span> Powerful Command-Line Applications in Go</a></h3>
</div>
<div id="outline-container-org134cc7d" class="outline-3">
<h3 id="org134cc7d"><a href="#org134cc7d"><span class="todo TODO">TODO</span> Build an Orchestrator in Go</a></h3>
</div>
<div id="outline-container-orgdd2bea3" class="outline-3">
<h3 id="orgdd2bea3"><a href="#orgdd2bea3"><span class="todo TODO">TODO</span> The Docker Book</a></h3>
</div>
</div>
<div id="outline-container-org4714c5e" class="outline-2">
<h2 id="org4714c5e"><a href="#org4714c5e">Reference</a></h2>
<div class="outline-text-2" id="text-org4714c5e">
</div>
<div id="outline-container-orgedbbb7a" class="outline-3">
<h3 id="orgedbbb7a"><a href="#orgedbbb7a"><a href="https://go.dev/ref/spec">The Go Programming Language Specification - The Go Programming Language</a></a></h3>
<div class="outline-text-3" id="text-orgedbbb7a">
<p>
言語の仕様書。
</p>
</div>
</div>
<div id="outline-container-org781765c" class="outline-3">
<h3 id="org781765c"><a href="#org781765c"><a href="https://ebiten.org/">Ebitengine - A dead simple 2D game library for Go</a></a></h3>
<div class="outline-text-3" id="text-org781765c">
<p>
Goのゲームライブラリ。
</p>
</div>
</div>
</div>
<div id="outline-container-orgf7c3a34" class="outline-2">
<h2 id="orgf7c3a34"><a href="#orgf7c3a34">Archives</a></h2>
<div class="outline-text-2" id="text-orgf7c3a34">
</div>
<div id="outline-container-orgc3c7e67" class="outline-3">
<h3 id="orgc3c7e67"><a href="#orgc3c7e67"><span class="done DONE">DONE</span> EmacsにLSP+DAPを設定する</a></h3>
<div class="outline-text-3" id="text-orgc3c7e67">
<p>
DAP(Debug Adapter Protocol)はデバッガー補助。エディタ関係なくIDEのようにエディタ上でブレークポイントをセットできるプロトコル。<a href="20220305121848-lsp.html#ID-eb807577-cd69-478c-8f82-264243c67354">LSP</a>のデバッガーバージョン。
</p>

<p>
go用のファイルはemacs側で自動インストールできず、手動でインストールする必要がある。
</p>

<ul class="org-ul">
<li><a href="https://emacs-lsp.github.io/dap-mode/page/configuration/#go">Configuration - DAP Mode</a>
<ul class="org-ul">
<li>外部コマンドをgo installでインストール
<ul class="org-ul">
<li>LSPは <code>gopls</code></li>
<li>Debuggerは <code>delve</code> (注意: VScode用のプログラムを用いる方法はdeprecatedで、現在は直接installするのが最新)</li>
</ul></li>
<li>Emacs側で設定、Emacs側が認識できるようにする</li>
</ul></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 24: </span>インストールする</label><pre class="src src-shell">$ go get golang.org/x/tools/gopls                <span class="org-comment-delimiter"># </span><span class="org-comment">Language Server</span>
$ go get -v github.com/uudashr/gopkgs/cmd/gopkgs <span class="org-comment-delimiter"># </span><span class="org-comment">Go &#12497;&#12483;&#12465;&#12540;&#12472;</span>
$ go install golang.org/x/tools/cmd/goimports    <span class="org-comment-delimiter"># </span><span class="org-comment">import &#12398;&#36942;&#19981;&#36275;&#12434;&#33258;&#21205;&#12391;&#35036;&#23436;</span>
</pre>
</div>

<p>
自分の環境では一瞬デバッガのボタンが表示されて Debug Adapter finished になってしまう状態になった。Warningには <code>Warning (emacs): Initialize request failed: Failed to launch Disable showing Disable logging</code> が表示される。理由がよくわからないため、表示させる。 <code>(setq dap-print-io t)</code> を評価すると、messageバッファに詳細なログを出力する。
</p>

<p>
原因は、しっかりと表示されていた。
</p>

<blockquote>
<p>
&ldquo;format&rdquo;: &ldquo;Failed to launch: Go version 1.14.15 is too old for this version of Delve (minimum supported version 1.17, suppress this error with &#x2013;check-go-version=false)&rdquo;,
</p>
</blockquote>

<p>
ということで、goのバージョンを上げると無事デバッガが起動するようになった。
</p>
</div>
</div>
<div id="outline-container-org2d16dd0" class="outline-3">
<h3 id="org2d16dd0"><a href="#org2d16dd0"><span class="done DONE">DONE</span> <a href="https://tatsu-zine.com/books/go-five-recipes">Go言語を楽しむ5つのレシピ コタツと蜜柑とゴーファーとわたし【委託】 - 達人出版会</a></a></h3>
<div class="outline-text-3" id="text-org2d16dd0">
<p>
画像処理やWebAssemblyなど。
</p>

<p>
ざっと読んだだけ。コードの中は読んでないので必要になったら確認する。
</p>
</div>
</div>
<div id="outline-container-org8fd4af4" class="outline-3">
<h3 id="org8fd4af4"><a href="#org8fd4af4"><span class="done DONE">DONE</span> <a href="https://go-tour-jp.appspot.com/list">A Tour of Go</a></a></h3>
<div class="outline-text-3" id="text-org8fd4af4">
<p>
最初のチュートリアル。
</p>
</div>
</div>
<div id="outline-container-org21524bd" class="outline-3">
<h3 id="org21524bd"><a href="#org21524bd"><span class="done DONE">DONE</span> <a href="https://dev.classmethod.jp/articles/list-containers-by-docker-sdk-go/">Docker Engine SDKでコンテナ一覧を取得する | DevelopersIO</a></a></h3>
<div class="outline-text-3" id="text-org21524bd">
<p>
小さなコマンドラインツールの例。
</p>
</div>
</div>
<div id="outline-container-orge2a5da7" class="outline-3">
<h3 id="orge2a5da7"><a href="#orge2a5da7"><span class="done DONE">DONE</span> <a href="https://haibara-works.hatenablog.com/entry/2020/12/05/235227">GoでDockerを操る [Docker Engine SDK] - はいばらのブログ</a></a></h3>
<div class="outline-text-3" id="text-orge2a5da7">
<p>
goとdockerの解説。
</p>
</div>
</div>
<div id="outline-container-org005cb19" class="outline-3">
<h3 id="org005cb19"><a href="#org005cb19"><span class="done DONE">DONE</span> <a href="https://zenn.dev/kenny/articles/b9dd668bf09efe">Goで作成したAPIをDockerで動かす</a></a></h3>
<div class="outline-text-3" id="text-org005cb19">
<p>
APIのサンプルコード。
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<footer class="footer py-3"><div class="container"><div class="row "><div class="col-md-4"></div><div class="col-sm col-md"><nav class="navbar"><a class="nav-link text-secondary small px-0" href="./index.html">Insomnia</a><a class="nav-link text-secondary small px-0" href="./sitemap.html">Sitemap</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD/roam">Repository</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD">@kijimaD</a></nav></div><div class="col-md-4"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"/>
</div>
</body>
</html>
