<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2023-05-07 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Web Browser</title>
<meta name="generator" content="Org mode">
<meta name="author" content="root">
<link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css' /><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css'><link rel='stylesheet' href='../css/site.css' /><link rel='stylesheet' href='../roam/css/code.css' /><link rel='stylesheet' href='css/site.css' /><link rel='stylesheet' href='css/code.css' />
</head>
<body>
<div id="preamble" class="status">
<div><div class="header"><div class="container"><div class="row"><div class="col-sm-12 col-md-12"><nav class="navbar navbar-light"/></div></div></div></div></div>
</div>
<div id="content">
<h1 class="title">Web Browser</h1>
<div id="outline-container-orgcb27000" class="outline-2">
<h2 id="orgcb27000"><a href="#orgcb27000">概要</a></h2>
<div class="outline-text-2" id="text-orgcb27000">
<p>
ウェブブラウザは、パソコンやスマートフォン等でWebサーバに接続するためのソフトウェア。
</p>
</div>
</div>
<div id="outline-container-org08187c5" class="outline-2">
<h2 id="org08187c5"><a href="#org08187c5">Memo</a></h2>
</div>
<div id="outline-container-orgc611c66" class="outline-2">
<h2 id="orgc611c66"><a href="#orgc611c66">Tasks</a></h2>
<div class="outline-text-2" id="text-orgc611c66">
</div>
<div id="outline-container-org49597c7" class="outline-3">
<h3 id="org49597c7"><a href="#org49597c7"><span class="todo WIP">WIP</span> <a href="https://www.oreilly.co.jp/books/9784873119038/">O&rsquo;Reilly Japan - Real World HTTP 第2版</a></a></h3>
<div class="outline-text-3" id="text-org49597c7">
<p>
HTTPの解説。
</p>

<ul class="org-ul">
<li>372</li>

<li>機能が追加されたり修正されるのには理由がある。最初のコンセプトはシンプルであることが多い。その流れを知れば、全体を理解しやすくなる</li>
<li>RFCはRequest For Comment。仕様書なのにこの言葉が使われているのは、軍事用としてスタートしたため。公開するためには意見を募るためという名目が必要だった</li>
<li>初期バージョンのHTTPにはバージョン番号がなかった</li>
<li>MIMEタイプはファイルの種類を区別するための文字列で、電子メールのために作られ、HTTPでも流用された。ヘッダー名はContent-Type。当初の仕様にはなく、ドキュメントを送ることしかできなかった</li>
<li>電子メールとHTTPは基本は同じ。ヘッダー + 本文がある。HTTPの通信は高速で電子メールが往復しているのと同じようなもの</li>
<li>HTTPはファイルシステムのような思想で作られている</li>
<li>ブラウザによってはリダイレクトを行ったときにメソッドが変更されるものがある。そのため、メソッドが対応してないエラーが表示されることがある</li>
<li>URNは名前。URLは住所。URLは住所なので、移動するとアクセスできない。いっぽうURNは名前でしかないので、どこにあるかの情報は別に必要</li>
<li>URIにはURNという名前の付け方のルールも含まれる</li>
<li>URLの <code>#</code> はフラグメントで、ブラウザ内部でのみ利用されるので、サーバーに送信されるのはフラグメントより前の部分だけ</li>
<li>&lt;link rel=&ldquo;canonical&rdquo; href=&ldquo;&#x2026;&rdquo;&gt; によって、正規のURLをサーバに教えられる。これによって、たとえばURLパラメータにトラッキングIDがついたURLが検索エンジンに登録されるのを防げる
<ul class="org-ul">
<li>あるいは、ソーシャルブックマークで別のURLと認識されることを防げる</li>
</ul></li>
<li>クッキーはHTTPヘッダーをベースにして実装されている。 <code>Set-Cookie: LAST_ACCESS=12:04</code> とすると、サーバ側がクライアント(ブラウザ)に保存を指示する
<ul class="org-ul">
<li>クライアントは値を保存しておき、次回のアクセス時に <code>Cookie: LAST_ACCESS=12:04</code> の形式で送信する。サーバ側はこの設定を読み取ることでクライアントが最後にアクセスした時刻を知ることができる</li>
</ul></li>
<li>オリジン &#x2026; ブラウザはスキーム、ドメイン、ポートの3つの組が同じであれば同一のサイトと判断する
<ul class="org-ul">
<li>ほかのサイトにクッキーなどを使えたら、セキュリティが</li>
</ul></li>
<li>キャッシュしてほしいがされてない場合のチェック
<ul class="org-ul">
<li>GETとHEAD以外のべき等ではないメソッド</li>
<li>Cache-Controlヘッダーにprivateが設定されている</li>
<li>Cache-Controlヘッダーにno-storeが設定されている</li>
<li>Authorizationヘッダーがあるが、Cache-Controlヘッダーにpublicがない</li>
</ul></li>
<li>ETagは、キャッシュがフレッシュかを判断するのにファイルに関連するハッシュ値を使って比較する。これによって、動的な送信内容であってもキャッシュを利用できるか判断できる</li>
<li>同じURLでもクライアントに返す結果が異なることを示すヘッダーがVary</li>
<li>referer はRFCに提案されたときのスペルミス</li>
<li>公開鍵 → 南京錠</li>
<li>TLSの骨格になる、「サーバを認証し、鍵を交換して通信を行う」というフローはTLS1.0から1.3まで大きく変わらない。その一方で、鍵交換の方法、メッセージの暗号化、メッセージの署名方式などそれぞれの場面で使うアルゴリズムの組み合わせをリスト化して管理している。サーバ・クライアント間で共通に使えるものを選択する仕組みにすることで、新しいアルゴリズムを少しずつ導入したり、古いアルゴリズムを非推奨にするといったことを、バージョン間で行いやすくなっている。このアルゴリズムのセットを暗号スイートという
<ul class="org-ul">
<li>暗号スイートの一覧を出す</li>
<li><code>$ openssl ciphers -v</code></li>
</ul></li>
<li><code>data:application/json,{"message": "hello"}</code> をブラウザのURLバーに入れるとそのまま表示できる</li>
<li>ブラウザがファイルをどのように処理するのか決めているのは、拡張子ではなくサーバから送られたMIMEタイプ
<ul class="org-ul">
<li>Content-Dispositionヘッダーの内容によって、ブラウザはこの動作を変更する</li>
<li>次のヘッダーがサーバから返ってくると、ブラウザはレスポンスは表示用のものではなく、ダウンロードしてローカルに保存するためのものであると認識する</li>
<li><code>Content-Disposition: attachment; filename=filename.xlsx</code></li>
</ul></li>
<li>自動ダウンロードの開始(はじまらない場合はクリック、みたいな)の実現方法
<ul class="org-ul">
<li>サーバは2つURLを提供する。ひとつは実際にファイルをダウンロードするページ。もうひとつはHTMLのページを返し、そこにはダウンロードありがとうメッセージと下記のヘッダーを含む
<ul class="org-ul">
<li><code>&lt;meta http-equiv="refresh" content="0;URL=./download_file"&gt;</code></li>
</ul></li>
<li>ブラウザがページを表示するときにContent-Dispositionヘッダーがあると、ページの表示をリセットせずにダウンロードだけを行う。まず完了ページをユーザに見せる。ブラウザはコンテンツを表示するときにメタタグを見つけるので、そのページにジャンプしようとする</li>
</ul></li>
<li>ダウンロードの中断、再開は大きなファイルの指定範囲を切り出してダウンロード、という形で可能になっている
<ul class="org-ul">
<li>サーバ側が指定範囲ダウンロードをサポートしている場合には、Accept-Rangesヘッダーをレスポンスに付与する</li>
</ul></li>
<li>ユーザエージェントは正規化されていない情報</li>
<li id="オープングラフプロトコル(OGP)">SNS等に貼り付けたときに記事の一部が引用され、画像も表示される</li>
<li>GETはべき等で、何度実行しても副作用がない。例えばブラウザの挙動はこれに基づいているから、「よく開くページ」にはGETのページだけが表示される。クローラはGETのページだけをクローリングする</li>
<li>サーバーレスと名付けたのは、アジャイル界隈で有名なマーチン・ファウラー。マーチン・ファウラーは必要以上にかっこいい名前をつけてバズらせてしまうことで有名</li>
<li>CGIのデメリットは、リクエストを受けるたびにプロセスを起動して処理をさせたあとにプロセスが終了すること。プロセスの起動はOSの中でも重い処理。スクリプト言語であればライブラリロードのコストなどが毎回のリクエストに上乗せされる
<ul class="org-ul">
<li>プロセスを起動しっぱなしにして、ソケット通信でリクエストを処理プログラムに渡す方式のFastCGIが考案された</li>
</ul></li>
</ul>

<blockquote>
<p>
今後新しいフレームワークが出てきたとしても、本章で触れた内容から大きく外れるものが生み出されることはおそらくなく、これらの技術に新しいアイディアが追加されたものになるでしょう。他の章と同様、未来を予測するものではありませんが、将来登場する未知の技術のキャッチアップを高速に行えるようになるはずです。
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org15390a5" class="outline-3">
<h3 id="org15390a5"><a href="#org15390a5"><span class="todo TODO">TODO</span> <a href="https://blog.amedama.jp/entry/2016/01/03/115602">Xvfb を使って仮想ディスプレイを作る - CUBE SUGAR CONTAINER</a></a></h3>
<div class="outline-text-3" id="text-org15390a5">
<p>
ディスプレイがない環境で、ディスプレイなしにテストができる。
</p>
</div>
</div>
<div id="outline-container-orgb098ba3" class="outline-3">
<h3 id="orgb098ba3"><a href="#orgb098ba3"><span class="todo TODO">TODO</span> ブラウザがどうサーバと接続し、HTMLページを表示までやっているか&#xa0;&#xa0;&#xa0;<span class="tag"><span class="DontKnow">DontKnow</span></span></a></h3>
</div>
</div>
<div id="outline-container-org5f32ceb" class="outline-2">
<h2 id="org5f32ceb"><a href="#org5f32ceb">Reference</a></h2>
<div class="outline-text-2" id="text-org5f32ceb">
</div>
<div id="outline-container-org0446645" class="outline-3">
<h3 id="org0446645"><a href="#org0446645"><a href="https://github.com/pion/awesome-pion">pion/awesome-pion: A curated list of awesome things related to Pion</a></a></h3>
<div class="outline-text-3" id="text-org0446645">
<p>
WebRTCの事例集。
</p>
</div>
</div>
<div id="outline-container-org1de4074" class="outline-3">
<h3 id="org1de4074"><a href="#org1de4074"><a href="https://gist.github.com/voluntas/379e48807635ed18ebdbcedd5f3beefa">仕事で WebRTC</a></a></h3>
<div class="outline-text-3" id="text-org1de4074">
<p>
WebRTCの資料。
</p>
</div>
</div>
<div id="outline-container-org4de7049" class="outline-3">
<h3 id="org4de7049"><a href="#org4de7049"><a href="https://www.oreilly.co.jp/books/9784873116761/">O&rsquo;Reilly Japan - ハイパフォーマンス ブラウザネットワーキング</a></a></h3>
<div class="outline-text-3" id="text-org4de7049">
<p>
ネットワークのパフォーマンス最適化の本。
</p>
</div>
</div>
<div id="outline-container-org39265fc" class="outline-3">
<h3 id="org39265fc"><a href="#org39265fc"><a href="https://techracho.bpsinc.jp/hachi8833/2023_03_10/97431">保存版: Web画像フォーマットを「正しく」扱う（1）ピクセルとDPRを完全理解する（翻訳）｜TechRacho by BPS株式会社</a></a></h3>
<div class="outline-text-3" id="text-org39265fc">
<p>
画像フォーマットの連載。
</p>
</div>
</div>
<div id="outline-container-org9832e50" class="outline-3">
<h3 id="org9832e50"><a href="#org9832e50"><a href="https://ja.wikipedia.org/wiki/%E3%82%A6%E3%82%A7%E3%83%96%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6">ウェブブラウザ - Wikipedia</a></a></h3>
</div>
</div>
<div id="outline-container-orgc595592" class="outline-2">
<h2 id="orgc595592"><a href="#orgc595592">Archives</a></h2>
</div>
</div>
<div id="postamble" class="status">
<footer class="footer py-3"><div class="container"><div class="row "><div class="col-md-4"></div><div class="col-sm col-md"><nav class="navbar"><a class="nav-link text-secondary small px-0" href="./index.html">Insomnia</a><a class="nav-link text-secondary small px-0" href="./sitemap.html">Sitemap</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD/roam">Repository</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD">@kijimaD</a></nav></div><div class="col-md-4"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"/>
</div>
</body>
</html>
