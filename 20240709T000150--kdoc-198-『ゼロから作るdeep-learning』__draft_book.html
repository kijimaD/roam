<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2024-07-10 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>KDOC 198: 『ゼロから作るDeep Learning』</title>
<meta name="generator" content="Org mode">
<meta name="author" content="root">
<link rel='shortcut icon' type='image/x-icon' href='/roam/favicon.ico' /><link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css' /><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css' /><link rel='stylesheet' href='../css/site.css' /><link rel='stylesheet' href='../roam/css/code.css' /><link rel='stylesheet' href='css/site.css' /><link rel='stylesheet' href='css/code.css' />
</head>
<body>
<div id="preamble" class="status">
<div><div class="header"><div class="container"><div class="row"><div class="col-sm-12 col-md-12"><nav class="navbar navbar-light"/></div></div></div></div></div>
</div>
<div id="content">
<h1 class="title">KDOC 198: 『ゼロから作るDeep Learning』</h1>

<div id="outline-container-org4324e25" class="outline-2">
<h2 id="org4324e25"><a href="#org4324e25">この文書のステータス</a></h2>
<div class="outline-text-2" id="text-org4324e25">
<ul class="org-ul">
<li>作成
<ul class="org-ul">
<li class="off"><input type='checkbox' /> &lt;署名&gt;</li>
</ul></li>
</ul>

<ul class="org-ul">
<li>レビュー
<ul class="org-ul">
<li class="off"><input type='checkbox' /> &lt;署名&gt;</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org57a0c51" class="outline-2">
<h2 id="org57a0c51"><a href="#org57a0c51">概要</a></h2>
<div class="outline-text-2" id="text-org57a0c51">
<p>
<a href="https://www.oreilly.co.jp/books/9784873117584/">ゼロから作るDeep Learning</a>は、深層学習を実装して学ぶ本。
</p>
</div>
</div>
<div id="outline-container-org7c374f1" class="outline-2">
<h2 id="org7c374f1"><a href="#org7c374f1">メモ</a></h2>
<div class="outline-text-2" id="text-org7c374f1">
<ul class="org-ul">
<li>パーセプトロンの限界は、このように 1 本の直線で分けた領域だけしか表現できない点にある(p30)</li>
<li>パーセプトロンの素晴らしさは、“層を重ねる”ことができる点にある(p31)</li>
<li>行列Aと行列Bの積を計算するとき、Aの列数とBの行数を同じ値にする必要がある
<ul class="org-ul">
<li>A(2x3) と B(3x4) みたいに</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgeef337b" class="outline-2">
<h2 id="orgeef337b"><a href="#orgeef337b">実行メモ</a></h2>
<div class="outline-text-2" id="text-orgeef337b">
<p>
別のエントリに移動させる。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>NumPy配列との演算</label><pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np
<span class="org-variable-name">x</span> = np.array([-1.0, 1.0, 2.0])
<span class="org-keyword">print</span>(x)

<span class="org-variable-name">y</span> = x &gt; 0
<span class="org-keyword">print</span>(y)

<span class="org-variable-name">z</span> = y.astype(<span class="org-builtin">int</span>)
<span class="org-keyword">print</span>(z)
</pre>
</div>

<pre class="example">
[-1.  1.  2.]
[False  True  True]
[0 1 1]
</pre>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>org-babelで実行が終わらないのでshow()はコメントアウトしている</label><pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np
<span class="org-keyword">import</span> matplotlib.pylab <span class="org-keyword">as</span> plt

<span class="org-keyword">def</span> <span class="org-function-name">step_function</span>(x):
    <span class="org-keyword">return</span> np.array(x &gt; 0, dtype=<span class="org-builtin">int</span>)

<span class="org-variable-name">x</span> = np.arange(-5.0, 5.0, 0.1)
<span class="org-variable-name">y</span> = step_function(x)
plt.plot(x, y)
plt.ylim(-0.1, 1.1)
<span class="org-comment-delimiter"># </span><span class="org-comment">plt.show()</span>
</pre>
</div>

<pre class="example">

</pre>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>シグモイド関数</label><pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np

<span class="org-keyword">def</span> <span class="org-function-name">sigmoid</span>(x):
  <span class="org-keyword">return</span> 1 / (1 + np.exp(-x))

<span class="org-keyword">print</span>(sigmoid(-5))
<span class="org-keyword">print</span>(sigmoid(-1))
<span class="org-keyword">print</span>(sigmoid(0))
<span class="org-keyword">print</span>(sigmoid(1))
<span class="org-keyword">print</span>(sigmoid(5))
</pre>
</div>

<pre class="example">
0.0066928509242848554
0.2689414213699951
0.5
0.7310585786300049
0.9933071490757153
</pre>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 4: </span>NumPy配列の演算</label><pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np

<span class="org-variable-name">t</span> = np.array([1.0, 2.0, 3.0])
<span class="org-keyword">print</span>(1.0 + t)
<span class="org-keyword">print</span>(1.0 / t)
</pre>
</div>

<pre class="example">
[2. 3. 4.]
[1.         0.5        0.33333333]
</pre>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 5: </span>ReLU関数</label><pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np

<span class="org-keyword">def</span> <span class="org-function-name">rel</span>(x):
    <span class="org-keyword">return</span> np.maximum(0, x)

<span class="org-keyword">print</span>(rel(-1))
<span class="org-keyword">print</span>(rel(0))
<span class="org-keyword">print</span>(rel(1))
</pre>
</div>

<pre class="example">
0
0
1
</pre>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 6: </span>多次元配列</label><pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np

<span class="org-variable-name">A</span> = np.array([10, 20, 30, 40])
<span class="org-keyword">print</span>(A)
<span class="org-keyword">print</span>(np.ndim(A))
<span class="org-keyword">print</span>(A.shape)
<span class="org-keyword">print</span>(A.shape[0])

<span class="org-keyword">print</span>(<span class="org-string">"================"</span>)

<span class="org-variable-name">B</span> = np.array([[10, 20, 30, 40], [10, 20, 30, 40]])
<span class="org-keyword">print</span>(B)
<span class="org-keyword">print</span>(np.ndim(B))
<span class="org-keyword">print</span>(B.shape)
<span class="org-keyword">print</span>(B.shape[0])
</pre>
</div>

<pre class="example">
[10 20 30 40]
1
(4,)
4
================
[[10 20 30 40]
 [10 20 30 40]]
2
(2, 4)
2
</pre>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 7: </span>行列同士の演算</label><pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np

<span class="org-variable-name">A</span> = np.array([[1, 2], [3, 4]])
A.shape

<span class="org-variable-name">B</span> = np.array([[5, 6], [7, 8]])
B.shape

<span class="org-keyword">print</span>(np.dot(A, B))
</pre>
</div>

<pre class="example">
[[19 22]
 [43 50]]
</pre>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 8: </span>行列同士の演算では、順番を変えると結果が変わる</label><pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np

<span class="org-variable-name">A</span> = np.array([[1, 2], [3, 4]])
A.shape

<span class="org-variable-name">B</span> = np.array([[7, 8], [5, 6]])
B.shape

<span class="org-keyword">print</span>(np.dot(A, B))
</pre>
</div>

<pre class="example">
[[17 20]
 [41 48]]
</pre>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 9: </span>1x2 と 2x3 の積</label><pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np
<span class="org-variable-name">X</span> = np.array([1, 2])
<span class="org-keyword">print</span>(X)
<span class="org-variable-name">W</span> = np.array([[1, 3, 5], [2, 4, 8]])
<span class="org-keyword">print</span>(W)

<span class="org-keyword">print</span>(X.shape)
<span class="org-keyword">print</span>(W.shape)
<span class="org-keyword">print</span>(np.dot(X, W))
</pre>
</div>

<pre class="example">
[1 2]
[[1 3 5]
 [2 4 8]]
(2,)
(2, 3)
[ 5 11 21]
</pre>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 10: </span>基本式を実装する 1x2 と 2x3</label><pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np

<span class="org-keyword">def</span> <span class="org-function-name">sigmoid</span>(x):
    <span class="org-keyword">return</span> 1 / (1 + np.exp(-x))

<span class="org-variable-name">X</span> = np.array([1.0, 0.5])
<span class="org-variable-name">W1</span> = np.array([[0.1, 0.3, 0.5], [0.2, 0.4, 0.6]])
<span class="org-variable-name">B1</span> = np.array([0.1, 0.2, 0.3])

<span class="org-keyword">print</span>(X.shape)
<span class="org-keyword">print</span>(W1.shape)
<span class="org-keyword">print</span>(B1.shape)

<span class="org-variable-name">A1</span> = np.dot(X, W1) + B1
<span class="org-variable-name">Z1</span> = sigmoid(A1)
<span class="org-keyword">print</span>(A1)
<span class="org-keyword">print</span>(Z1)
</pre>
</div>

<pre class="example">
(2,)
(2, 3)
(3,)
[0.3 0.7 1.1]
[0.57444252 0.66818777 0.75026011]
</pre>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 11: </span>まとめ</label><pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np

<span class="org-keyword">def</span> <span class="org-function-name">sigmoid</span>(x):
  <span class="org-keyword">return</span> 1 / (1 + np.exp(-x))

<span class="org-keyword">def</span> <span class="org-function-name">identity_function</span>(x):
  <span class="org-keyword">return</span> x

<span class="org-keyword">def</span> <span class="org-function-name">init_network</span>():
  <span class="org-variable-name">network</span> = {}
  <span class="org-variable-name">network</span>[<span class="org-string">'W1'</span>] = np.array([[0.1, 0.3, 0.5], [0.2, 0.4, 0.6]])
  <span class="org-variable-name">network</span>[<span class="org-string">'b1'</span>] = np.array([0.1, 0.2, 0.3])
  <span class="org-variable-name">network</span>[<span class="org-string">'W2'</span>] = np.array([[0.1, 0.4], [0.2, 0.5], [0.3, 0.6]])
  <span class="org-variable-name">network</span>[<span class="org-string">'b2'</span>] = np.array([0.1, 0.2])
  <span class="org-variable-name">network</span>[<span class="org-string">'W3'</span>] = np.array([[0.1, 0.3], [0.2, 0.4]])
  <span class="org-variable-name">network</span>[<span class="org-string">'b3'</span>] = np.array([0.1, 0.2])

  <span class="org-keyword">return</span> network

<span class="org-keyword">def</span> <span class="org-function-name">forward</span>(network, x):
  <span class="org-variable-name">W1</span>, <span class="org-variable-name">W2</span>, <span class="org-variable-name">W3</span> = network[<span class="org-string">'W1'</span>], network[<span class="org-string">'W2'</span>], network[<span class="org-string">'W3'</span>]
  <span class="org-variable-name">b1</span>, <span class="org-variable-name">b2</span>, <span class="org-variable-name">b3</span> = network[<span class="org-string">'b1'</span>], network[<span class="org-string">'b2'</span>], network[<span class="org-string">'b3'</span>]

  <span class="org-variable-name">a1</span> = np.dot(x, W1) + b1
  <span class="org-variable-name">z1</span> = sigmoid(a1)
  <span class="org-variable-name">a2</span> = np.dot(z1, W2) + b2
  <span class="org-variable-name">z2</span> = sigmoid(a2)
  <span class="org-variable-name">a3</span> = np.dot(z2, W3) + b3
  <span class="org-variable-name">y</span> = identity_function(a3)

  <span class="org-keyword">return</span> y

<span class="org-variable-name">network</span> = init_network()
<span class="org-variable-name">x</span> = np.array([1.0, 0.5])
<span class="org-variable-name">y</span> = forward(network, x)
<span class="org-keyword">print</span>(y)
</pre>
</div>

<pre class="example">
[0.31682708 0.69627909]
</pre>
</div>
</div>

<div id="outline-container-orga10eb8c" class="outline-2">
<h2 id="orga10eb8c"><a href="#orga10eb8c">関連</a></h2>
<div class="outline-text-2" id="text-orga10eb8c">
</div>
</div>
</div>
<div id="postamble" class="status">
<footer class="footer py-3"><div class="container"><div class="row "><div class="col-md-4"></div><div class="col-sm col-md"><nav class="navbar"><a class="nav-link text-secondary small px-0" href="./index.html">Insomnia</a><a class="nav-link text-secondary small px-0" href="./sitemap.html">Sitemap</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD/roam">Repository</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD">@kijimaD</a></nav></div><div class="col-md-4"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"/>
</div>
</body>
</html>
