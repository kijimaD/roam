<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><author><name>Kijima Daigo</name></author>
<title>Insomnia</title>
<generator>Emacs webfeeder.el</generator>
<link href="https://kijimad.github.io/roam"/>
<link href="https://kijimad.github.io/roam/atom.xml" rel="self"/>
<id>https://kijimad.github.io/roam/atom.xml</id>
<updated>2025-07-03T07:18:36+09:00</updated>
<entry>
  <title>KDOC 416: Goのエスケープ解析における2つの不変条件を見る</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orga2f8b22" class="outline-2">
 <h2 id="orga2f8b22"> <a href="#orga2f8b22">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orga2f8b22">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul> <ul class="org-ul"> <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org6ec2dce" class="outline-2">
 <h2 id="org6ec2dce"> <a href="#org6ec2dce">概要</a></h2>
 <div class="outline-text-2" id="text-org6ec2dce">
 <p>
Goのドキュメントにヒープエスケープの不変条件が書かれていたので、見る。
</p>

 <div class="org-src-container">
 <pre class="src src-git-permalink">https://github.com/golang/go/blob/988a20c8c5e2c9eb49f8749e5ee94ce3c964fe59/src/cmd/compile/internal/escape/escape.go#L20-L29
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">// Escape analysis.
//
// Here we analyze functions to determine which Go variables
// (including implicit allocations such as calls to "new" or "make",
// composite literals, etc.) can be allocated on the stack. The two
// key invariants we have to ensure are: (1) pointers to stack objects
// cannot be stored in the heap, and (2) pointers to a stack object
// cannot outlive that object (e.g., because the declaring function
// returned and destroyed the object's stack frame, or its space is
// reused across loop iterations for logically distinct variables).
</pre>
</div>

 <p>
2つの不変条件。
</p>

 <ul class="org-ul"> <li>(1)スタックオブジェクトへのポインタはヒープに保存できない
 <ul class="org-ul"> <li>スタックオブジェクトは関数を抜けると同時に解放される。解放されるとポインタは不明な値を指すことになる(ダングリングポインタ)</li>
 <li>したがってスタックに割り当てられた変数のアドレスがヒープにエスケープしないようにする。スタック変数をヒープに移す。</li>
</ul></li>
 <li>(2)スタックオブジェクトへのポインタはそのオブジェクトより長生きできない
 <ul class="org-ul"> <li>関数を抜けるとオブジェクトのスタックフレームは解放される。もしくは解放されたスペースがループ内で論理的に異なる変数として再利用される</li>
 <li>スタック変数のライフタイムが、その変数へのポインタへのライフタイムより短くならないようにする。必要に応じてスタック変数をヒープに移す</li>
</ul></li>
</ul> <p>
つまり、(1)スタックにあるとオブジェクトが開放されてしまうのでヒープに保存しない、(2)スタックオブジェクトとスタックオブジェクトのポインタの関係性。
</p>
</div>
</div>
 <div id="outline-container-orgc43b25e" class="outline-2">
 <h2 id="orgc43b25e"> <a href="#orgc43b25e">関連</a></h2>
 <div class="outline-text-2" id="text-orgc43b25e">
 <ul class="org-ul"> <li> <a href="20250701T174437--kdoc-413-ローカル変数がヒープにエスケープされるのを見る__draft_wiki.html#ID-20250701T174437">KDOC 413: ローカル変数がヒープにエスケープされるのを見る</a>。エスケープされる具体例。「スタックオブジェクトへのポインタはヒープに保存しない」を守るためにスタックオブジェクトをエスケープする例</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250702T194815--kdoc-416-goのエスケープ解析における2つの不変条件を見る__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20250702T194815--kdoc-416-goのエスケープ解析における2つの不変条件を見る__draft_permanent.html</id>
  <updated>2025-07-03T16:18:33+09:00</updated>
</entry>
<entry>
  <title>KDOC 415: io.Readerのシグネチャはヒープエスケープを避ける設計になっている</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orgf93a9b1" class="outline-2">
 <h2 id="orgf93a9b1"> <a href="#orgf93a9b1">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orgf93a9b1">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-07-01 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgc664f3f" class="outline-2">
 <h2 id="orgc664f3f"> <a href="#orgc664f3f">概要</a></h2>
 <div class="outline-text-2" id="text-orgc664f3f">
 <p>
io.Reader, io.Writerのインターフェース設計には、ヒープのエスケープも関係しているという。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 1: </span>io.Readerのシグネチャ</label> <pre class="src src-go">type Reader interface {
        Read(p []byte) (n int, err error)
}
</pre>
</div>

 <p>
 <code>[]byte</code> の初期化は呼び出し側の責務になっている。これによって呼び出し側がメモリ管理できるようになる。スタックに留まり、スタックにエスケープするのを抑えられる。Readを何度呼んでも新しいヒープ確保が発生しない。
</p>

 <p>
実際に試してみる。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 2: </span>Read1だけがヒープのエスケープが発生する</label> <pre class="src src-shell"> <span class="org-variable-name">tmpfile</span>=$(mktemp /tmp/tmpgo.XXXXXX.go)

cat > $ <span class="org-variable-name">tmpfile</span> <<EOF
 <span class="org-sh-heredoc">package main</span>

 <span class="org-sh-heredoc">func main() {</span>
 <span class="org-sh-heredoc">  // スタックで渡せる</span>
 <span class="org-sh-heredoc">  buf := make([]byte, 2)</span>
 <span class="org-sh-heredoc">  Read2(buf)</span>
 <span class="org-sh-heredoc">}</span>

 <span class="org-sh-heredoc">// Read側で初期化して返すと、ヒープに置かなければならない</span>
 <span class="org-sh-heredoc">func Read1() []byte {</span>
 <span class="org-sh-heredoc">  return make([]byte, 1)</span>
 <span class="org-sh-heredoc">}</span>

 <span class="org-sh-heredoc">// 呼び出し側で初期化してもらうようにすると、スタックに置ける</span>
 <span class="org-sh-heredoc">func Read2([]byte) {}</span>

 <span class="org-sh-heredoc">EOF</span>

go build -gcflags= <span class="org-string">"-m"</span> -o bin $ <span class="org-variable-name">tmpfile</span> 2>&1
rm bin
rm $ <span class="org-variable-name">tmpfile</span>
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil"># command-line-arguments
/tmp/tmpgo.Q5eDch.go:12:6: can inline Read2
/tmp/tmpgo.Q5eDch.go:3:6: can inline main
/tmp/tmpgo.Q5eDch.go:8:6: can inline Read1
/tmp/tmpgo.Q5eDch.go:5:8: inlining call to Read2
/tmp/tmpgo.Q5eDch.go:4:14: make([]byte, 2) does not escape
/tmp/tmpgo.Q5eDch.go:9:14: make([]byte, 1) escapes to heap
</pre>
</div>
</div>
</div>
 <div id="outline-container-org49209f5" class="outline-2">
 <h2 id="org49209f5"> <a href="#org49209f5">関連</a></h2>
 <div class="outline-text-2" id="text-org49209f5">
 <ul class="org-ul"> <li> <a href="https://syntactic-sugar.dev/blog/nested-route/go-escape-analysis">Stack or Heap? Going Deeper with Escape Analysis in Go for Better Performance</a>。io.Readerとio.Writerインターフェースの設計について言及していた</li>
 <li> <a href="20250701T193212--kdoc-414-インターフェースがヒープにエスケープされるのを見る__draft_wiki.html#ID-20250701T193212">KDOC 414: インターフェースがヒープにエスケープされるのを見る</a>。調べている中で記事を見かけ、調べるきっかけになった</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250701T213624--kdoc-415-ioreaderのシグネチャはヒープエスケープを避ける設計になっている__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20250701T213624--kdoc-415-ioreaderのシグネチャはヒープエスケープを避ける設計になっている__draft_permanent.html</id>
  <updated>2025-07-03T16:18:32+09:00</updated>
</entry>
<entry>
  <title>KDOC 406: TCP/IPでは1つのIPアドレスでネットワークとノードをまとめて表す</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orge078a16" class="outline-2">
 <h2 id="orge078a16"> <a href="#orge078a16">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orge078a16">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-24 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-29 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org73683c7" class="outline-2">
 <h2 id="org73683c7"> <a href="#org73683c7">概要</a></h2>
 <div class="outline-text-2" id="text-org73683c7">
 <p>
TCP/IPの特徴の1つに、1つのIPアドレスでネットワークとノードをまとめて表すという点がある(位置400)。
</p>
</div>
</div>
 <div id="outline-container-orge191000" class="outline-2">
 <h2 id="orge191000"> <a href="#orge191000">関連</a></h2>
 <div class="outline-text-2" id="text-orge191000">
 <ul class="org-ul"> <li> <a href="20250506T120102--kdoc-377-『一日で読めてわかるtcpipのエッセンス』__book.html#ID-20250506T120102">KDOC 377: 『一日で読めてわかるTCP/IPのエッセンス』</a>から</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250624T085212--kdoc-406-tcpipでは1つのipアドレスでネットワークとノードをまとめて表す__book.html"/>
  <id>https://kijimad.github.io/roam/20250624T085212--kdoc-406-tcpipでは1つのipアドレスでネットワークとノードをまとめて表す__book.html</id>
  <updated>2025-07-03T16:18:29+09:00</updated>
</entry>
<entry>
  <title>KDOC 405: IPアドレスは論理アドレスで、MACアドレスは物理アドレスである</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org726591a" class="outline-2">
 <h2 id="org726591a"> <a href="#org726591a">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org726591a">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-24 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-29 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org3347e09" class="outline-2">
 <h2 id="org3347e09"> <a href="#org3347e09">概要</a></h2>
 <div class="outline-text-2" id="text-org3347e09">
 <p>
IPアドレスは論理アドレスであり、MACアドレスは物理アドレスである(位置569)。
</p>

 <p>
物理的な実態に紐付けられた概念の上に、抽象された論理的な層が構成される。メモリなど、コンピュータではよくみるパターン。
</p>
</div>
</div>
 <div id="outline-container-org858066b" class="outline-2">
 <h2 id="org858066b"> <a href="#org858066b">関連</a></h2>
 <div class="outline-text-2" id="text-org858066b">
 <ul class="org-ul"> <li> <a href="20250506T120102--kdoc-377-『一日で読めてわかるtcpipのエッセンス』__book.html#ID-20250506T120102">KDOC 377: 『一日で読めてわかるTCP/IPのエッセンス』</a>から</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250624T002111--kdoc-405-ipアドレスは論理アドレスで、macアドレスは物理アドレスである__book.html"/>
  <id>https://kijimad.github.io/roam/20250624T002111--kdoc-405-ipアドレスは論理アドレスで、macアドレスは物理アドレスである__book.html</id>
  <updated>2025-07-03T16:18:28+09:00</updated>
</entry>
<entry>
  <title>KDOC 401: 起動中のプロセスをstraceで観察する</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org9ba4639" class="outline-2">
 <h2 id="org9ba4639"> <a href="#org9ba4639">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org9ba4639">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-21 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-26 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org0a5f666" class="outline-2">
 <h2 id="org0a5f666"> <a href="#org0a5f666">概要</a></h2>
 <div class="outline-text-2" id="text-org0a5f666">
 <p>
 <code>strace</code> ですでに起動しているプロセスを見てみると気軽に発行システムコールを眺められる。コマンドをメモしておく。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 1: </span>viteの開発サーバに対してアタッチする。ホットリロードのためにポーリングがされているのがわかる</label> <pre class="src src-shell">sudo strace -p $(pgrep node | head -n1)
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">strace: Process 1550973 attached
epoll_pwait(15, [{events=EPOLLIN, data={u32=22, u64=22}}], 1024, 638, NULL, 8) = 1
read(22, "\35\0\0\0H\253\0\0\6\1\0\0\0\7\0\0\0command\3\4\0\0\0pin"..., 65536) = 33
write(20, "\t\0\0\0I\253\0\0\6\0\0\0\0", 13) = 13
epoll_pwait(15, [], 1024, 0, NULL, 8)   = 0
(略)
</pre>
</div>
</div>
</div>
 <div id="outline-container-org2a3e8ec" class="outline-2">
 <h2 id="org2a3e8ec"> <a href="#org2a3e8ec">関連</a></h2>
 <div class="outline-text-2" id="text-org2a3e8ec">
 <p>
なし。
</p>
</div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250621T094036--kdoc-401-起動中のプロセスをstraceで観察する__wiki.html"/>
  <id>https://kijimad.github.io/roam/20250621T094036--kdoc-401-起動中のプロセスをstraceで観察する__wiki.html</id>
  <updated>2025-07-03T16:18:26+09:00</updated>
</entry>
<entry>
  <title>KDOC 413: ローカル変数がヒープにエスケープされるのを見る</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orga2a49b3" class="outline-2">
 <h2 id="orga2a49b3"> <a href="#orga2a49b3">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orga2a49b3">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-07-01 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org9ee384b" class="outline-2">
 <h2 id="org9ee384b"> <a href="#org9ee384b">概要</a></h2>
 <div class="outline-text-2" id="text-org9ee384b">
 <p>
関数を抜けた後も使うようなケースでは、消されないようにスタックからヒープに移す必要がある。後も使うケースとしては、ポインタを返すなどがある。ローカル変数として宣言されていても、ヒープに移動させられる。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 1: </span>ローカル変数がヒープにエスケープされる様子を見る</label> <pre class="src src-shell"> <span class="org-variable-name">tmpfile</span>=$(mktemp /tmp/tmpgo.XXXXXX.go)

cat > $ <span class="org-variable-name">tmpfile</span> <<EOF
 <span class="org-sh-heredoc">package main</span>

 <span class="org-sh-heredoc">func main() {}</span>

 <span class="org-sh-heredoc">func f() *int {</span>
 <span class="org-sh-heredoc">        x := 42</span>
 <span class="org-sh-heredoc">        return &x // ヒープへ</span>
 <span class="org-sh-heredoc">}</span>

 <span class="org-sh-heredoc">EOF</span>

go build -gcflags= <span class="org-string">"-m"</span> -o bin $ <span class="org-variable-name">tmpfile</span> 2>&1
rm bin
rm $ <span class="org-variable-name">tmpfile</span>
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil"># command-line-arguments
/tmp/tmpgo.G6OymE.go:3:6: can inline main
/tmp/tmpgo.G6OymE.go:5:6: can inline f
/tmp/tmpgo.G6OymE.go:6:9: moved to heap: x
</pre>
</div>
</div>
</div>
 <div id="outline-container-orgd8ac1a8" class="outline-2">
 <h2 id="orgd8ac1a8"> <a href="#orgd8ac1a8">関連</a></h2>
 <div class="outline-text-2" id="text-orgd8ac1a8">
 <ul class="org-ul"> <li> <a href="20250630T185540--kdoc-411-スタックは積み重ねて取り出して解放する。ではヒープは__draft_permanent.html#ID-20250630T185540">KDOC 411: スタックは積み重ねて取り出して解放する。ではヒープは?</a>。ヒープを調べるきっかけになった</li>
</ul></div>
</div>
 <div id="outline-container-org8339084" class="outline-2">
 <h2 id="org8339084"> <a href="#org8339084">Backlinks</a></h2>
 <div class="outline-text-2" id="text-org8339084">
 <ul class="org-ul"> <li> <a href="./20250702T194815--kdoc-416-goのエスケープ解析における2つの不変条件を見る__draft_permanent.html">KDOC 416: Goのエスケープ解析における2つの不変条件を見る</a></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250701T174437--kdoc-413-ローカル変数がヒープにエスケープされるのを見る__draft_wiki.html"/>
  <id>https://kijimad.github.io/roam/20250701T174437--kdoc-413-ローカル変数がヒープにエスケープされるのを見る__draft_wiki.html</id>
  <updated>2025-07-03T16:18:22+09:00</updated>
</entry>
<entry>
  <title>KDOC 410: 物事に対する情熱は行動の後に生まれる</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orgbfcadd8" class="outline-2">
 <h2 id="orgbfcadd8"> <a href="#orgbfcadd8">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orgbfcadd8">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-29 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org6d61991" class="outline-2">
 <h2 id="org6d61991"> <a href="#org6d61991">概要</a></h2>
 <div class="outline-text-2" id="text-org6d61991">
 <p>
大人や社会は「好きなことを仕事にしろ」と言った。しかし、「好きなこと」をどうやって見つけるのかには口をつぐんだ。本当は知らないと自白する代わりに、「色んなことをしてそれを探せ」と言った。
</p>

 <p>
受け取ったメッセージを思い返してみると、こういうことだ。
</p>

 <ul class="org-ul"> <li>自分が好きなものは広い世界のどこかに存在している</li>
 <li>いろんな体験をすれば発見できる。だからバイトしろ。海外に行け。勉強しろ。スポーツしろ</li>
 <li>ないならもっと探せ。でも時間制限があるから、22歳までに見つけろ</li>
 <li>好きなものかはやってみれば直感や感情で判定できる</li>
 <li>エゴや憧れも好きのうちだ。実際に体験してなくてもそれは好きに分類できる</li>
 <li>本当に好きならたくさん努力できるだろう。努力できないなら好きとはいえない</li>
</ul> <p>
「砂漠のどこかにダイヤが転がっているからそれを探せ」と言っているように聞こえた。このモデルの問題点は、ダイヤはどこにも転がっていないという点だ。自分探しに成功した人間が存在しないように、好きなことは未知の場所を探して見つけられるものではない。
</p>

 <hr></hr> <hr></hr> <p>
「物事に対する情熱はやり続けた後に生まれる」という考え方もある。
</p>

 <p>
行動が先にあって好きになっていくということだ。ダイヤを探すのではなく、手に持っている石を磨き続ければダイヤになる。現時点で情熱がないとしたらそれはまだ発見できていないということではなく、何も続けていないということだ。何でもいいからやり始めればいい。重要なのは  <b>「選ぶこと」</b> ではなく  <b>「磨き始めること」</b> だ。
</p>

 <p>
ありもしないものを探せというアドバイスより、何でもいいから続けてみろ、というアドバイスのほうが建設的に見える。
</p>
</div>
</div>
 <div id="outline-container-org414c542" class="outline-2">
 <h2 id="org414c542"> <a href="#org414c542">関連</a></h2>
 <div class="outline-text-2" id="text-org414c542">
 <ul class="org-ul"> <li> <a href="20221027T235104--kdoc-3-『ない仕事の作り方』__book.html#ID-20221027T235104">KDOC 3: 『ない仕事の作り方』</a>では、好きだから集めるのではなく、大量に集めるから好きになるのだ、と主張する</li>
 <li> <a href="20250611T180912--kdoc-385-『続ける思考』__book.html#ID-20250611T180912">KDOC 385: 『続ける思考』</a>では、意味など考えず時間をかけた結果として好きになる、と主張する</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250629T110721--kdoc-410-物事に対する情熱は行動の後に生まれる__draft_essay.html"/>
  <id>https://kijimad.github.io/roam/20250629T110721--kdoc-410-物事に対する情熱は行動の後に生まれる__draft_essay.html</id>
  <updated>2025-07-03T16:18:22+09:00</updated>
</entry>
<entry>
  <title>KDOC 409: 挫折し続けた運動を習慣化できたのは毎日やったから</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org451ed36" class="outline-2">
 <h2 id="org451ed36"> <a href="#org451ed36">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org451ed36">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-26 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-29 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org8b09b36" class="outline-2">
 <h2 id="org8b09b36"> <a href="#org8b09b36">概要</a></h2>
 <div class="outline-text-2" id="text-org8b09b36">
 <p>
運動を1年間継続してやっている。体の変化を実感し、自信になっている。肉体だけでない。自分がやると決めたことを続けられる人間なのだということを誇らしく感じる。
</p>

 <p>
 <a href="20240810T073930--kdoc-215-運動習慣を身につけるヒントを考える__essay.html#ID-20240810T073930">KDOC 215: 運動習慣を身につけるヒントを考える</a>では、継続1ヶ月時点で、なぜ続けられているのかを考えている。今は最大の要因について違う意見を持っている。もっとも重要な要因は、「毎日やっていたから」に見える。本で紹介していたトレーニングのスケジュールが曜日ごとに違う部位のトレーニングを1種類やる、というものだったのでそのとおりに毎日やっていた。
</p>

 <p>
意見を変えた理由は、ほかの習慣における再現性である。運動は習慣化できたが、ほかのことへの応用はうまくいっていなかった。
</p>

 <p>
最近、 <a href="20250624T222943--kdoc-408-続けるコツは週7日やることである__essay.html#ID-20250624T222943">KDOC 408: 続けるコツは週7日やることである</a>がよさそうに見えたので、毎日やるのを実践している。毎日5分本を読む、5分英語の動画を見る、といった習慣をはじめてしばらく期間が経過したのだが、じつに自然に継続している。
</p>

 <p>
重要なのは、毎日実行すること、毎日実行できるようにハードルを下げる、ということだったように見える。
</p>
</div>
</div>
 <div id="outline-container-orge52f6f4" class="outline-2">
 <h2 id="orge52f6f4"> <a href="#orge52f6f4">関連</a></h2>
 <div class="outline-text-2" id="text-orge52f6f4">
 <ul class="org-ul"> <li> <a href="20240708T214636--kdoc-197-『プリズナー・トレーニング』__book.html#ID-20240708T214636">KDOC 197: 『プリズナー・トレーニング』</a>。運動を習慣化できた本</li>
 <li> <a href="20250611T180912--kdoc-385-『続ける思考』__book.html#ID-20250611T180912">KDOC 385: 『続ける思考』</a>。習慣化するために誰でも再現可能な方法を解説する本</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250626T085406--kdoc-409-挫折し続けた運動を習慣化できたのは毎日やったから__essay.html"/>
  <id>https://kijimad.github.io/roam/20250626T085406--kdoc-409-挫折し続けた運動を習慣化できたのは毎日やったから__essay.html</id>
  <updated>2025-07-03T16:18:21+09:00</updated>
</entry>
<entry>
  <title>KDOC 412: ヒープ管理方法の変遷を見る</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org07ea1f8" class="outline-2">
 <h2 id="org07ea1f8"> <a href="#org07ea1f8">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org07ea1f8">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-30 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org7ed7c13" class="outline-2">
 <h2 id="org7ed7c13"> <a href="#org7ed7c13">概要</a></h2>
 <div class="outline-text-2" id="text-org7ed7c13">
 <p>
ヒープ管理方法の変遷を見る。
</p>

 <ol class="org-ol"> <li>従来はプログラマーが  <code>malloc</code> や  <code>free</code> でヒープを確保・解放していた
 <ul class="org-ul"> <li>課題: メモリ解放忘れや解放済みのポインタへのアクセス。安全性に問題があった</li>
</ul></li>
 <li>処理系にガベージコレクションを組み込み、メモリ管理を自動で行うようにした
 <ul class="org-ul"> <li>課題: パフォーマンスへの影響、一時停止、管理の複雑さ</li>
</ul></li>
 <li>所有権に基づいてメモリを管理する。コンパイル時にメモリ管理の正しさを検証し、実行時のオーバーヘッドなく安全性を得る
 <ul class="org-ul"> <li>課題: リストなど特定のケースで実装が難しいことがあるという</li>
</ul></li>
</ol></div>
</div>
 <div id="outline-container-orgabafd3b" class="outline-2">
 <h2 id="orgabafd3b"> <a href="#orgabafd3b">関連</a></h2>
 <div class="outline-text-2" id="text-orgabafd3b">
 <ul class="org-ul"> <li> <a href="https://ja.wikipedia.org/wiki/%E3%82%AC%E3%83%99%E3%83%BC%E3%82%B8%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3">ガベージコレクション - Wikipedia</a></li>
 <li> <a href="20250630T185540--kdoc-411-スタックは積み重ねて取り出して解放する。ではヒープは__draft_permanent.html#ID-20250630T185540">KDOC 411: スタックは積み重ねて解放する。ではヒープは?</a>。きっかけになった疑問</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250630T192238--kdoc-412-ヒープ管理方法の変遷を見る__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20250630T192238--kdoc-412-ヒープ管理方法の変遷を見る__draft_permanent.html</id>
  <updated>2025-07-03T16:18:02+09:00</updated>
</entry>
<entry>
  <title>KDOC 403: 六義園を観察する</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orgaa59870" class="outline-2">
 <h2 id="orgaa59870"> <a href="#orgaa59870">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orgaa59870">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-21 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-29 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org1c9e50a" class="outline-2">
 <h2 id="org1c9e50a"> <a href="#org1c9e50a">概要</a></h2>
 <div class="outline-text-2" id="text-org1c9e50a">
 <p>
六義園は、東京都文京区にある庭園である。博物館かどうかは微妙だが、来歴や解説の展示も割とあるので博物館観察シリーズに入れる。
</p>

 <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3905.019232201816!2d139.74315321198782!3d35.733100472456165!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60188dbdf73e4461%3A0x7648774313f66fe5!2sRikugien%20Gardens!5e1!3m2!1sen!2sjp!4v1750636306703!5m2!1sen!2sjp" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
</div>
</div>
 <div id="outline-container-org65703db" class="outline-2">
 <h2 id="org65703db"> <a href="#org65703db">メモ</a></h2>
 <div class="outline-text-2" id="text-org65703db">
 <ul class="org-ul"> <li>公園ではなく、庭園である。代々木公園とは違う。広い庭園だが順路以外は入れない。座れる場所もそう多くない。ゆっくりするというより、庭園の設計どおりに観覧客が視点を移動させ風景を味わうものであるという意図を感じた。この点、博物館に近い
 <ul class="org-ul"> <li>人が留まらないので、静かである</li>
</ul></li>
 <li>太神楽(だいかぐら)という、大道芸的な伝統芸能があるのを知った。あじさいの美しい庭園の入り口部分で、和装の芸人2人が観覧席を前に技芸を披露していた。芸人なのでおひねりを要求するのだが、やはり場所によるプレミア感なのか、額面の入りがよかったように見えた。小銭を入れている人はいなかった(自分も札を出した)。これが仮に錦糸町駅前のパフォーマンスだったとすると、同じ額になってはいなかったように見える</li>
 <li>外国人の比率が多かったように見える。客層を反映しているのか、園内は英語が付記されたものが多かった。太神楽の芸人もブロークンな英語を交えてトークしていた</li>
 <li>園内のいたるところに解説板がある。場所の名前についての解説、意匠の解説などがある</li>
</ul></div>
</div>
 <div id="outline-container-orgbc680a7" class="outline-2">
 <h2 id="orgbc680a7"> <a href="#orgbc680a7">関連</a></h2>
 <div class="outline-text-2" id="text-orgbc680a7">
 <p>
なし。
</p>
</div>
</div>
 <div id="outline-container-orgd8bae8b" class="outline-2">
 <h2 id="orgd8bae8b"> <a href="#orgd8bae8b">Backlinks</a></h2>
 <div class="outline-text-2" id="text-orgd8bae8b">
 <ul class="org-ul"> <li> <a href="./20240908T180537--kdoc-238-他人の博物館を観察して参考にする__project.html">KDOC 238: 他人の博物館を観察して参考にする</a></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250621T205407--kdoc-403-六義園を観察する__essay.html"/>
  <id>https://kijimad.github.io/roam/20250621T205407--kdoc-403-六義園を観察する__essay.html</id>
  <updated>2025-07-03T16:17:57+09:00</updated>
</entry>
<entry>
  <title>KDOC 399: 『PostgreSQL 17.0』</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org431bb6c" class="outline-2">
 <h2 id="org431bb6c"> <a href="#org431bb6c">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org431bb6c">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul> <ul class="org-ul"> <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org3d9d4f6" class="outline-2">
 <h2 id="org3d9d4f6"> <a href="#org3d9d4f6">概要</a></h2>
 <div class="outline-text-2" id="text-org3d9d4f6">
 <p>
 <a href="https://pgsql-jp.github.io/jpug-doc/17.0/postgresql-17.0-A4.pdf">PostgreSQL 17.0文書</a>は、PostgreSQLのマニュアル。
</p>
</div>
</div>
 <div id="outline-container-org2d3c666" class="outline-2">
 <h2 id="org2d3c666"> <a href="#org2d3c666">メモ</a></h2>
 <div class="outline-text-2" id="text-org2d3c666">
 <ul class="org-ul"> <li>PostgreSQLはクライアント/サーバモデルを採用している。クライアントとサーバのホストが異なる場合、TCP/IPネットワーク経由で通信する(p4)
 <ul class="org-ul"> <li>(感想)ホストが同じ場合はソケット接続という理解で合っているか</li>
</ul></li>
 <li>サーバは接続ごとに新しいプロセスを開始(fork)する。これによってクライアントからの複数同時接続を取り扱える(p4)</li>
 <li>左外部結合というのは、結合演算子の左側に指定したテーブルの各行が最低でも1度出力されるから。いっぽう右側では左側のテーブルの行に一致するもののみが出力される(p14)</li>
 <li>SQLのWHEREとHAVINGの間の相互作用を理解するのが重要である。WHEREとHAVINGの基本的な違いは、WHEREがグループや集約を演算する前に入力行を選択するのに対し、HAVINGはグループと集約を演算したあとにグループ化された行を選択する。したがって、WHERE句は集約関数を持てない。集約を使ってどの行をその集約の入力にすることになるから(p17)</li>
 <li>複数のトランザクションが同時に動作しているとき、それぞれのトランザクションは別のトランザクションが行っている未完了の変更を見ることができてはならない。作業中のトランザクションによる更新は、ほかのトランザクションからはトランザクションが完結するまで不可視である。そのトランザクションが完結した時点でトランザクションで行った更新のすべてが見えるようになる(p21)</li>
 <li>PostgreSQLはすべてのSQL文をトランザクション内で実行するようになっている。BEGINを発行しない場合、それぞれの文は暗黙的にBEGINが付いているとみなし、成功すればCOMMITで囲われているものとする(p21)</li>
 <li>セーブポイントはトランザクションを構成するある部分を選択的に破棄するいっぽう、破棄されない残りの部分をコミットする(p22)</li>
 <li>システムは  <code>NAMEDATALEN</code> - 1より長い識別子を使わない。より長い名前を書くと短く切られる。デフォルトでは  <code>NAMEDATALEN</code> は64バイトなので、識別子は最長で63バイト。定数は変えて増やせる(p40)</li>
 <li>任意の文字の連なりをダブルクォートで囲ったものを区切り識別子 or 引用符付き識別子という(p40)
 <ul class="org-ul"> <li>(感想)なぜプログラミング言語のように文字列リテラルといわないのか</li>
 <li>(感想)名前の列あるいはテーブルを問い合わせるために使うから。データそのものでなく、識別子として使うからこのような名前になっている</li>
</ul></li>
 <li>引用符がつかない名前は常に小文字に解釈される。識別子を引用符で囲むことで大文字と小文字が区別される(p40)</li>
 <li>SQLにおける文字列定数は、単一引用符で括られた任意の文字の並びである(p41)
 <ul class="org-ul"> <li>(感想)なぜ文字列定数というのだろう</li>
</ul></li>
 <li>対象の文字列内に単一引用符が多くあると、それらをすべて二重にしなければならないので理解しづらくなる。そのような場合は単一引用符をエスケープすることなく使用できるドル引用符付けが便利。ただし標準SQLで定義されていない(p44)</li>
 <li>定数は文脈に基づいて自動的にもっとも適切な型に変換される(p46)</li>
 <li>(感想)集約とか関数とかはあまり使ったことがないしあまり使うケースもないように見えるので、細かい話があまり頭に入ってこない</li>
 <li>SQLではテーブル内の行の順序は保証されない。テーブルを読み込むと、明示的に並び替えを要求しない限り行は不特定な順番で並び替えられる(p69)</li>
 <li>リレーショナルデータベース理論では、すべてのテーブルに主キーが1つ必要とされている。PostgrSQLは強制しないが、これに従うことが推奨される(p80)</li>
 <li>関連削除のデフォルト設定はNO ACTIONである。NO ACTIONでは検査をトランザクション中で後回しにできる。RESTRICTは後回しにできない(p83)</li>
 <li>排他制約  <code>EXCLUDE</code> によって、2つの行に関して演算子の比較の少なくとも1つが偽もしくはnullを返すのを確実にする(p84)</li>
</ul></div>
</div>
 <div id="outline-container-org5b19cfa" class="outline-2">
 <h2 id="org5b19cfa"> <a href="#org5b19cfa">関連</a></h2>
 <div class="outline-text-2" id="text-org5b19cfa">
 <p>
なし。
</p>
</div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250618T233353--kdoc-399-『postgresql-170』__draft_book.html"/>
  <id>https://kijimad.github.io/roam/20250618T233353--kdoc-399-『postgresql-170』__draft_book.html</id>
  <updated>2025-07-03T16:17:56+09:00</updated>
</entry>
<entry>
  <title>KDOC 404: ネットワークは階層化によってネットワークやアプリケーションの自由度を高くしている</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org0bc9233" class="outline-2">
 <h2 id="org0bc9233"> <a href="#org0bc9233">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org0bc9233">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-22 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-29 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org52ca595" class="outline-2">
 <h2 id="org52ca595"> <a href="#org52ca595">概要</a></h2>
 <div class="outline-text-2" id="text-org52ca595">
 <p>
ネットワークシステムは何段階にも機能を分け、組み合わせた形で構築されている。実際のネットワーク方式(Wi-Fi、有線…)、伝送の制御、アプリケーション…。このようにすることでネットワーク方式やアプリケーションの自由度が高くなる(位置206)
</p>
</div>
</div>
 <div id="outline-container-orgb7b8df4" class="outline-2">
 <h2 id="orgb7b8df4"> <a href="#orgb7b8df4">関連</a></h2>
 <div class="outline-text-2" id="text-orgb7b8df4">
 <ul class="org-ul"> <li> <a href="20250506T120102--kdoc-377-『一日で読めてわかるtcpipのエッセンス』__book.html#ID-20250506T120102">KDOC 377: 『一日で読めてわかるTCP/IPのエッセンス』</a></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250622T091856--kdoc-404-ネットワークは階層化によってネットワークやアプリケーションの自由度を高くしている__book.html"/>
  <id>https://kijimad.github.io/roam/20250622T091856--kdoc-404-ネットワークは階層化によってネットワークやアプリケーションの自由度を高くしている__book.html</id>
  <updated>2025-07-03T16:17:52+09:00</updated>
</entry>
<entry>
  <title>KDOC 398: GORMフックはレシーバーがnilになる可能性がある</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orgd75891e" class="outline-2">
 <h2 id="orgd75891e"> <a href="#orgd75891e">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orgd75891e">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-19 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-25 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgb0e2d30" class="outline-2">
 <h2 id="orgb0e2d30"> <a href="#orgb0e2d30">概要</a></h2>
 <div class="outline-text-2" id="text-orgb0e2d30">
 <p>
GORMでは <a href="https://gorm.io/ja_JP/docs/hooks.html">Hooks</a>を使用できる。これによってCRUD操作の前後の処理を挿入できる。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 1: </span>Userを削除する前に実行される</label> <pre class="src src-go">func (u *User) BeforeDelete(tx *gorm.DB) (error) {
        return nil
}
</pre>
</div>

 <p>
もし  <code>Delete()</code> にスライスのUserを渡し一括で削除しようとすると、フックは1度だけ実行され、レシーバはnilになる。
</p>

 <p>
直感的ではないが、こうなっていなければ1件1件削除するたびにモデル情報を取得する必要があり、パフォーマンスの問題になるだろう。
</p>
</div>
</div>
 <div id="outline-container-orgd10ac2f" class="outline-2">
 <h2 id="orgd10ac2f"> <a href="#orgd10ac2f">関連</a></h2>
 <div class="outline-text-2" id="text-orgd10ac2f">
 <p>
なし。
</p>
</div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250618T232434--kdoc-398-gormフックはレシーバーがnilになる可能性がある__wiki.html"/>
  <id>https://kijimad.github.io/roam/20250618T232434--kdoc-398-gormフックはレシーバーがnilになる可能性がある__wiki.html</id>
  <updated>2025-07-03T16:17:48+09:00</updated>
</entry>
<entry>
  <title>KDOC 408: 続けるコツは週7日やることである</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org514e08d" class="outline-2">
 <h2 id="org514e08d"> <a href="#org514e08d">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org514e08d">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-24 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-29 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orge7f5364" class="outline-2">
 <h2 id="orge7f5364"> <a href="#orge7f5364">概要</a></h2>
 <div class="outline-text-2" id="text-orge7f5364">
 <p>
ラクに続けるコツは、週7日やることである(位置372)。
</p>

 <p>
今日はいいから明日やろう、となる余地があるとすぐにやらなくなるのを何度も経験してきた。毎朝5分、例外なく毎日やることで意思の力に関係なく続けやすい。そして、取り組み始めれば意外とノッてきて長くできるものである。
</p>
</div>
</div>
 <div id="outline-container-org83f98e4" class="outline-2">
 <h2 id="org83f98e4"> <a href="#org83f98e4">関連</a></h2>
 <div class="outline-text-2" id="text-org83f98e4">
 <ul class="org-ul"> <li> <a href="20250611T180912--kdoc-385-『続ける思考』__book.html#ID-20250611T180912">KDOC 385: 『続ける思考』</a>から</li>
</ul></div>
</div>
 <div id="outline-container-orgd8dd2c1" class="outline-2">
 <h2 id="orgd8dd2c1"> <a href="#orgd8dd2c1">Backlinks</a></h2>
 <div class="outline-text-2" id="text-orgd8dd2c1">
 <ul class="org-ul"> <li> <a href="./20250626T085406--kdoc-409-挫折し続けた運動を習慣化できたのは毎日やったから__essay.html">KDOC 409: 挫折し続けた運動を習慣化できたのは毎日やったから</a></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250624T222943--kdoc-408-続けるコツは週7日やることである__essay.html"/>
  <id>https://kijimad.github.io/roam/20250624T222943--kdoc-408-続けるコツは週7日やることである__essay.html</id>
  <updated>2025-07-03T16:17:46+09:00</updated>
</entry>
<entry>
  <title>KDOC 402: Goの識別子の境界を探る</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orgc88cda4" class="outline-2">
 <h2 id="orgc88cda4"> <a href="#orgc88cda4">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orgc88cda4">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-21 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-29 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orged36fd1" class="outline-2">
 <h2 id="orged36fd1"> <a href="#orged36fd1">概要</a></h2>
 <div class="outline-text-2" id="text-orged36fd1">
 <p>
多くの現代的なプログラミング言語では識別子にUnicodeの文字(コードポイント)を使えるということを知っていたが、ちゃんとGoの仕様を調べたことはなかった。確認する。
</p>

 <p>
最初に、何も調べずに実行してみて確かめてみる。違和感がすごいが、英語ネイティブが見ているのはこういう景色なのだろう。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 1: </span>すべて正しいシンタックス。ビルド、実行できる</label> <pre class="src src-go">import "fmt"
func main() {
        // 変数名に日本語が使える
        あ := "a"
        fmt.Println(あ)

        // 関数名に日本語が使える
        漢字()

        // 型名に日本語が使える
        type 地名 struct {}
        var 江戸川橋 地名
        fmt.Println(江戸川橋)
}

func 漢字() {}
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">a
{}
</pre>
</div>

 <p>
調べてみる。
</p>

 <p>
 <a href="https://go.dev/ref/spec#letter">言語仕様書</a>によると、識別子( <code>identifier</code>)の定義はこうだ。出てきた  <code>letter</code>,  <code>unicode_letter</code> も辿って調べた。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 2: </span>identifierの定義</label> <pre class="src src-code">identifier = letter { letter | unicode_digit } .
letter     = unicode_letter | "_" .
unicode_letter = /* a Unicode code point categorized as "Letter" */ .
</pre>
</div>

 <p>
ここからわかること、考察。
</p>

 <ul class="org-ul"> <li>Unicodeにはカテゴリという概念がある。letter(文字), mark(結合記号), number(数字), punctuation(句読点), …
 <ul class="org-ul"> <li>結合記号はアクセント記号のように、ほかの文字と組み合わせて使う記号のことである</li>
 <li>たとえば漢字はletterのサブカテゴリotherに属する</li>
</ul></li>
 <li>識別子の先頭にletterカテゴリの文字があれば、あとはなんでもいい。逆にいえば、結合記号、数字、句読点、…から開始できない</li>
 <li>アンダースコア  <code>_</code> は句読点カテゴリの文字である。例外的にletterとして許容されている
 <ul class="org-ul"> <li>自然に使っていて、全く意識してなかった</li>
</ul></li>
</ul> <p>
以上から、無効なパターンを試した <sup> <a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 3: </span>結合記号、数字、句読点、…から開始できない</label> <pre class="src src-shell"> <span class="org-variable-name">tmpfile</span>=$(mktemp /tmp/tmpgo.XXXXXX.go)

cat > $ <span class="org-variable-name">tmpfile</span> <<EOF
 <span class="org-sh-heredoc">package main</span>

 <span class="org-sh-heredoc">func main() {</span>
 <span class="org-sh-heredoc">  // 先頭のアクセント記号は不可</span>
 <span class="org-sh-heredoc">  ◌̀ := "あ"</span>
 <span class="org-sh-heredoc">  print(◌̀)</span>

 <span class="org-sh-heredoc">  // 先頭の数字は不可</span>
 <span class="org-sh-heredoc">  ９ := "あ"</span>
 <span class="org-sh-heredoc">  print(９)</span>

 <span class="org-sh-heredoc">  // 先頭の漢数字はletter扱いなので問題ない</span>
 <span class="org-sh-heredoc">  九 := "あ"</span>
 <span class="org-sh-heredoc">  print(九)</span>

 <span class="org-sh-heredoc">  // 先頭の句読点は不可</span>
 <span class="org-sh-heredoc">  、 := "あ"</span>
 <span class="org-sh-heredoc">  print(、)</span>

 <span class="org-sh-heredoc">  // 先頭のシンボルは不可</span>
 <span class="org-sh-heredoc">  👍 := "あ"</span>
 <span class="org-sh-heredoc">  print(👍)</span>
 <span class="org-sh-heredoc">}</span>
 <span class="org-sh-heredoc">EOF</span>

go run $ <span class="org-variable-name">tmpfile</span> 2>&1
rm $ <span class="org-variable-name">tmpfile</span>
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">/tmp/tmpgo.FO1KQz.go:5:3: invalid character U+25CC '◌' in identifier
/tmp/tmpgo.FO1KQz.go:5:6: invalid character U+0300 '̀' in identifier
/tmp/tmpgo.FO1KQz.go:6:9: invalid character U+25CC '◌' in identifier
/tmp/tmpgo.FO1KQz.go:6:12: invalid character U+0300 '̀' in identifier
/tmp/tmpgo.FO1KQz.go:9:3: identifier cannot begin with digit U+FF19 '９'
/tmp/tmpgo.FO1KQz.go:10:9: identifier cannot begin with digit U+FF19 '９'
/tmp/tmpgo.FO1KQz.go:17:3: invalid character U+3001 '、' in identifier
/tmp/tmpgo.FO1KQz.go:18:9: invalid character U+3001 '、' in identifier
/tmp/tmpgo.FO1KQz.go:21:3: invalid character U+1F44D '👍' in identifier
/tmp/tmpgo.FO1KQz.go:22:9: invalid character U+1F44D '👍' in identifier
/tmp/tmpgo.FO1KQz.go:22:9: too many errors
</pre>
</div>

 <p>
調べる前の認識は、正確ではなかったのがわかった。
</p>
</div>
</div>
 <div id="outline-container-org5fa12e7" class="outline-2">
 <h2 id="org5fa12e7"> <a href="#org5fa12e7">関連</a></h2>
 <div class="outline-text-2" id="text-org5fa12e7">
 <ul class="org-ul"> <li> <a href="https://en.wikipedia.org/wiki/Unicode_character_property">Unicode character property - Wikipedia</a>。カテゴリ表を参考にした</li>
 <li> <a href="https://go.dev/ref/spec#letter">The Go Programming Language Specification</a>。Goの言語仕様書</li>
</ul></div>
</div>
 <div id="footnotes">
 <h2 class="footnotes">Footnotes: </h2>
 <div id="text-footnotes">

 <div class="footdef"> <sup> <a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"> <p class="footpara">
org-babelで標準エラーを出すためシェルスクリプトから実行している。
</p></div></div>


</div>
</div></div>]]></content>
  <link href="https://kijimad.github.io/roam/20250621T183743--kdoc-402-goの識別子の境界を探る__wiki.html"/>
  <id>https://kijimad.github.io/roam/20250621T183743--kdoc-402-goの識別子の境界を探る__wiki.html</id>
  <updated>2025-07-03T16:17:45+09:00</updated>
</entry>
<entry>
  <title>KDOC 397: 技術力とは、技術選択の理由を説明できることである</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orgd4d2a67" class="outline-2">
 <h2 id="orgd4d2a67"> <a href="#orgd4d2a67">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orgd4d2a67">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-26 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-26 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org2301a8f" class="outline-2">
 <h2 id="org2301a8f"> <a href="#org2301a8f">概要</a></h2>
 <div class="outline-text-2" id="text-org2301a8f">
 <p>
技術力とは、技術選択の理由を説明できること、長期的な影響を予測できること、そしてプロジェクト全体における個々の実装の位置づけを理解できることである、という。
</p>

 <p>
考えたこと。
</p>

 <p>
選択は誰にでもできる。どの選択肢の中からなぜ選んだかを説明できるのが技術力である。それをやるには、問題の前提条件の理解や、どの文脈で有用かなどの本質的な理解が必要になるのだ。
</p>
</div>
</div>
 <div id="outline-container-org33e7fd0" class="outline-2">
 <h2 id="org33e7fd0"> <a href="#org33e7fd0">関連</a></h2>
 <div class="outline-text-2" id="text-org33e7fd0">
 <ul class="org-ul"> <li> <a href="https://syu-m-5151.hatenablog.com/entry/2025/02/04/203205">滅びゆく「なぜ？」と「どうして？」の学びをどう受け止めればよいのか？新人エンジニアの指導で感じる生成AI時代の指導の難しさ - じゃあ、おうちで学べる</a>からのメモ</li>
 <li> <a href="20250616T220141--kdoc-396-優れた技術ブログは思考プロセスを含む__essay.html#ID-20250616T220141">KDOC 396: 優れた技術ブログは思考プロセスを含む</a>。同じブログの作者の言葉。「優れた技術」についての一貫した見解</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250617T082740--kdoc-397-技術力とは、技術選択の理由を説明できることである__essay.html"/>
  <id>https://kijimad.github.io/roam/20250617T082740--kdoc-397-技術力とは、技術選択の理由を説明できることである__essay.html</id>
  <updated>2025-07-03T16:17:45+09:00</updated>
</entry>
<entry>
  <title>KDOC 411: スタックは積み重ねて取り出して解放する。ではヒープは?</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orgdb2ce3e" class="outline-2">
 <h2 id="orgdb2ce3e"> <a href="#orgdb2ce3e">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orgdb2ce3e">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-30 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org9849e06" class="outline-2">
 <h2 id="org9849e06"> <a href="#org9849e06">概要</a></h2>
 <div class="outline-text-2" id="text-org9849e06">
 <p>
スタックとヒープについて聞かれた。
</p>

 <p>
スタック領域は関数呼び出しとともに積み重ねてローカル変数を保存していき、抜けるとともに解放できる明確なイメージがあった。しかし、ヒープはどう使われているかを答えられなくて凹んだ。
</p>

 <hr></hr> <hr></hr> <p>
逆になぜ、スタックの使用方法は明確なイメージがあったのだろうか。それはよくコードとアセンブリを比較していたからだ。スタックベースの操作が頻繁に登場し、関数呼び出し時にメモリを確保し、抜けるときに破棄する流れをよく見た。
</p>

 <p>
多くのCPUの命令セットアーキテクチャは  <code>push</code> /  <code>pop</code> /  <code>ret</code> などのスタック操作をサポートしている。これらの命令は「一番上に積む」「一番上から取る」という制限された動きしかできず柔軟性はない。だからコンパイル時にサイズを決めて機械的に変換でき、どの領域が使われているかは明確である。スタックは、CPUレベルで使っていると言える。
</p>

 <p>
いっぽう、アセンブリでヒープ確保は、  <code>malloc</code> のようなライブラリ関数の呼び出し( <code>call</code>)として現れる。そのさきで何が行われているかは、OSや言語処理系レベルの話だ。スタックより柔軟に使えるが複雑なために、上のレイヤーに任せているといえる。
</p>
</div>
</div>
 <div id="outline-container-org25c9511" class="outline-2">
 <h2 id="org25c9511"> <a href="#org25c9511">関連</a></h2>
 <div class="outline-text-2" id="text-org25c9511">
 <ul class="org-ul"> <li> <a href="https://ja.wikipedia.org/wiki/%E3%83%92%E3%83%BC%E3%83%97%E9%A0%98%E5%9F%9F">ヒープ領域 - Wikipedia</a></li>
 <li> <a href="20240427T120833--kdoc-141-cのポインタ操作をアセンブリで見る__wiki.html#ID-20240427T120833">KDOC 141: Cのポインタ操作をアセンブリで見る</a>。アセンブラを見ていた例</li>
</ul></div>
</div>
 <div id="outline-container-org9dde4c8" class="outline-2">
 <h2 id="org9dde4c8"> <a href="#org9dde4c8">Backlinks</a></h2>
 <div class="outline-text-2" id="text-org9dde4c8">
 <ul class="org-ul"> <li> <a href="./20250630T192238--kdoc-412-ヒープ管理方法の変遷を見る__draft_permanent.html">KDOC 412: ヒープ管理方法の変遷を見る</a></li>
 <li> <a href="./20250701T174437--kdoc-413-ローカル変数がヒープにエスケープされるのを見る__draft_wiki.html">KDOC 413: ローカル変数がヒープにエスケープされるのを見る</a></li>
 <li> <a href="./20250701T193212--kdoc-414-インターフェースがヒープにエスケープされるのを見る__draft_wiki.html">KDOC 414: インターフェースがヒープにエスケープされるのを見る</a></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250630T185540--kdoc-411-スタックは積み重ねて取り出して解放する。ではヒープは__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20250630T185540--kdoc-411-スタックは積み重ねて取り出して解放する。ではヒープは__draft_permanent.html</id>
  <updated>2025-07-03T16:17:37+09:00</updated>
</entry>
<entry>
  <title>KDOC 407: 1W5Hでユーザーストーリーを書く</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org3931c80" class="outline-2">
 <h2 id="org3931c80"> <a href="#org3931c80">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org3931c80">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-24 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-29 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org255c244" class="outline-2">
 <h2 id="org255c244"> <a href="#org255c244">概要</a></h2>
 <div class="outline-text-2" id="text-org255c244">
 <p>
 <a href="https://speakerdeck.com/soudai/grow-one-day-each-day?slide=30">**強い**エンジニアのなり方 - フィードバックサイクルを勝ち取る / grow one day each day</a>で、問題設定の文脈において1W5H形式でユーザーストーリーに記載することが書かれていた。
</p>

 <p>
これらは当たり前に見える。しかしだからこそ、ズレが生まれる。それを明確にすることが大事なのだと考えた。
</p>

 <p>
メモ。
</p>

 <ul class="org-ul"> <li>Why
 <ul class="org-ul"> <li>なぜ必要なのか</li>
</ul></li>
 <li>What
 <ul class="org-ul"> <li>実現したいことは何か</li>
 <li>成果物は何か</li>
 <li>完了の定義</li>
</ul></li>
 <li>When
 <ul class="org-ul"> <li>タスクの期限</li>
</ul></li>
 <li>Where
 <ul class="org-ul"> <li>ビジョンやゴールはどこか</li>
 <li>どこで実行されるか</li>
</ul></li>
 <li>Who
 <ul class="org-ul"> <li>ステークホルダーは誰か</li>
 <li>利用者は誰か</li>
 <li>依頼者は誰か</li>
 <li>レビューは誰にお願いするか</li>
</ul></li>
 <li>How
 <ul class="org-ul"> <li>どのように実現するか</li>
 <li>実装のための制約や方針も含む</li>
</ul></li>
</ul> <p>
ユーザーストーリーの見直し。
</p>

 <ul class="org-ul"> <li>もっとも実現したいことにフォーカスする</li>
 <li>複数の方法に置き換え</li>
 <li>実現する場所、実装する場所を置き換える</li>
 <li>届けたいペルソナを絞る</li>
 <li>制約を減らす方法を検討する</li>
 <li>今やるべきか検討する</li>
</ul></div>
</div>
 <div id="outline-container-orgfe4ea62" class="outline-2">
 <h2 id="orgfe4ea62"> <a href="#orgfe4ea62">関連</a></h2>
 <div class="outline-text-2" id="text-orgfe4ea62">
 <p>
なし。
</p>
</div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250624T214442--kdoc-407-1w5hでユーザーストーリーを書く__essay.html"/>
  <id>https://kijimad.github.io/roam/20250624T214442--kdoc-407-1w5hでユーザーストーリーを書く__essay.html</id>
  <updated>2025-07-03T16:17:37+09:00</updated>
</entry>
<entry>
  <title>KDOC 414: インターフェースがヒープにエスケープされるのを見る</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org7b94625" class="outline-2">
 <h2 id="org7b94625"> <a href="#org7b94625">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org7b94625">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-07-01 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgeadbd12" class="outline-2">
 <h2 id="orgeadbd12"> <a href="#orgeadbd12">概要</a></h2>
 <div class="outline-text-2" id="text-orgeadbd12">
 <p>
関数を抜けた後も使うようなケースでは、消されないようにスタックからヒープに移す必要がある。インターフェースを返すと、実体を関数から抜けた後も保持しておく必要があるため、ヒープにエスケープされる。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 1: </span>最初スタックにあったローカル変数がヒープにエスケープされる様子を見る</label> <pre class="src src-shell"> <span class="org-variable-name">tmpfile</span>=$(mktemp /tmp/tmpgo.XXXXXX.go)

cat > $ <span class="org-variable-name">tmpfile</span> <<EOF
 <span class="org-sh-heredoc">package main</span>

 <span class="org-sh-heredoc">func main() {}</span>

 <span class="org-sh-heredoc">func f() any {</span>
 <span class="org-sh-heredoc">  x := "hello"</span>
 <span class="org-sh-heredoc">  return x // ヒープへ</span>
 <span class="org-sh-heredoc">}</span>

 <span class="org-sh-heredoc">EOF</span>

go build -gcflags= <span class="org-string">"-m"</span> -o bin $ <span class="org-variable-name">tmpfile</span> 2>&1
rm bin
rm $ <span class="org-variable-name">tmpfile</span>
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil"># command-line-arguments
/tmp/tmpgo.wTCwGe.go:3:6: can inline main
/tmp/tmpgo.wTCwGe.go:5:6: can inline f
/tmp/tmpgo.wTCwGe.go:7:10: x escapes to heap
</pre>
</div>
</div>
</div>
 <div id="outline-container-orgcbc89a0" class="outline-2">
 <h2 id="orgcbc89a0"> <a href="#orgcbc89a0">関連</a></h2>
 <div class="outline-text-2" id="text-orgcbc89a0">
 <ul class="org-ul"> <li> <a href="20250630T185540--kdoc-411-スタックは積み重ねて取り出して解放する。ではヒープは__draft_permanent.html#ID-20250630T185540">KDOC 411: スタックは積み重ねて取り出して解放する。ではヒープは?</a>。ヒープを調べるきっかけになった</li>
</ul></div>
</div>
 <div id="outline-container-orgbd5a187" class="outline-2">
 <h2 id="orgbd5a187"> <a href="#orgbd5a187">Backlinks</a></h2>
 <div class="outline-text-2" id="text-orgbd5a187">
 <ul class="org-ul"> <li> <a href="./20250701T213624--kdoc-415-ioreaderのシグネチャはヒープエスケープを避ける設計になっている__draft_permanent.html">KDOC 415: io.Readerのシグネチャはヒープエスケープを避ける設計になっている</a></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250701T193212--kdoc-414-インターフェースがヒープにエスケープされるのを見る__draft_wiki.html"/>
  <id>https://kijimad.github.io/roam/20250701T193212--kdoc-414-インターフェースがヒープにエスケープされるのを見る__draft_wiki.html</id>
  <updated>2025-07-03T16:17:36+09:00</updated>
</entry>
<entry>
  <title>KDOC 400: 役割や責任を明確にすることでチーム内のコミュニケーションが円滑になる</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org733d00c" class="outline-2">
 <h2 id="org733d00c"> <a href="#org733d00c">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org733d00c">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-21 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-06-25 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org1efd4b5" class="outline-2">
 <h2 id="org1efd4b5"> <a href="#org1efd4b5">概要</a></h2>
 <div class="outline-text-2" id="text-org1efd4b5">
 <p>
役割や責任を明確にすることでチーム内のコミュニケーションが円滑になる、という。プロジェクトのポジションのフレームワークとして、RACIチャート、DACIモデルというものがある。プロジェクトを始めたり人員が変化するタイミングで確認するとよい。
</p>
</div>
</div>
 <div id="outline-container-orgc098664" class="outline-2">
 <h2 id="orgc098664"> <a href="#orgc098664">関連</a></h2>
 <div class="outline-text-2" id="text-orgc098664">
 <ul class="org-ul"> <li> <a href="https://soudai.hatenablog.com/entry/2024/11/23/132843">仕事を任せるコツとやり方 - そーだいなるらくがき帳</a>から。自分の経験と照らし合わせて、言語化されたように感じた</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20250620T082616--kdoc-400-役割や責任を明確にすることでチーム内のコミュニケーションが円滑になる__essay.html"/>
  <id>https://kijimad.github.io/roam/20250620T082616--kdoc-400-役割や責任を明確にすることでチーム内のコミュニケーションが円滑になる__essay.html</id>
  <updated>2025-07-03T16:17:35+09:00</updated>
</entry>
</feed>
