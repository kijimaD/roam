#+title: Rails
* 単発メモ
** factorybot
create_list - factorybot
** ネストしたvalidate
 特定の条件だけで発動するvalidation + 条件。`with_options: if`内で`if`を使うと、中のif条件が優先して実行されるため、こう書く必要があります。
#+begin_src ruby
validates :term_date, date: { after: proc { Time.zone.now } }, if: proc { |p| p.term_date? && p.sellable?  }
#+end_src

** `includes`
 N+1問題を回避するために用います。
** キャスト
文字列で返ってくる真偽値を、booleanオブジェクトとして扱いとき。ActiveModelのmoduleを使用する。
言われてみるとDBでは意識せずに使える。

#+begin_src ruby
ActiveModel::Type::Boolean.new.cast(value) == true
#+end_src
