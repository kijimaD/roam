:properties:
:ID: 20240207T095628
:end:
#+title:      KDOC 78: org-modeで脚注を再割り振りする方法
#+date:       [2024-02-07 Wed 09:56]
#+filetags: :code:
#+identifier: 20240207T095628

* この文書のステータス
- 作成
  - [X] 2024-02-07 貴島
- レビュー
  - [X] 2024-02-08 貴島
* 概要
[[id:7e85e3f3-a6b9-447e-9826-307a3618dac8][org-mode]]は脚注を書ける。あとから脚注を追加して、番号が増減したときに自動で並び替える方法をまとめる。
* 並び替え方
~org-footnote-renumber-fn:N~ を使って自動で並び替えられる。ユースケースを示す。

orgドキュメントで、このような脚注になっているとする。

#+caption: 既存の状態
#+begin_src
ここに脚注a[fn:1]。
ここに脚注b[fn:2]。

,* FootNotes
[fn:1]aの定義。
[fn:2]bの定義。
#+end_src

先頭に、脚注を追加したいとすると、番号がかぶってしまうのでずらさなければならない。面倒である。

#+caption: 番号がかぶる
#+begin_src
ここに追加[fn:1] ← かぶってしまう
ここに脚注a[fn:1]。
ここに脚注b[fn:2]。

,* FootNotes
[fn:1]aの定義。
[fn:2]bの定義。
#+end_src

そこで番号を前後する形で一時的に新しく番号をふる。

#+caption: 前後する番号をふる
#+begin_src
ここに追加[fn:3] ← 新しく番号をふる
ここに脚注a[fn:1]。
ここに脚注b[fn:2]。

,* FootNotes
[fn:1]aの定義。
[fn:2]bの定義。
[fn:3]追加部分の定義。
#+end_src

そして、 ~org-footnote-renumber-fn:N~ を実行する。すると対応関係を維持しつつ、脚注が登場した順番に番号が割り振られ、定義が並び替えられる。

#+caption: 正しい形になる
#+begin_src
ここに追加[fn:1]
ここに脚注a[fn:2]。
ここに脚注b[fn:3]。

,* FootNotes
[fn:1]追加部分の定義。
[fn:2]aの定義。
[fn:2]bの定義。
#+end_src

* 関連
- [[id:20240204T105547][KDOC 71: KDOCエントリの書き方]]。推敲の途中で脚注を追加したり削除するのがよくある
