<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2024-02-10 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Git</title>
<meta name="generator" content="Org mode">
<meta name="author" content="root">
<link rel='shortcut icon' type='image/x-icon' href='/roam/favicon.ico' /><link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css' /><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css' /><link rel='stylesheet' href='../css/site.css' /><link rel='stylesheet' href='../roam/css/code.css' /><link rel='stylesheet' href='css/site.css' /><link rel='stylesheet' href='css/code.css' />
</head>
<body>
<div id="preamble" class="status">
<div><div class="header"><div class="container"><div class="row"><div class="col-sm-12 col-md-12"><nav class="navbar navbar-light"/></div></div></div></div></div>
</div>
<div id="content">
<h1 class="title">Git</h1>
<div id="outline-container-org31b3b88" class="outline-2">
<h2 id="org31b3b88"><a href="#org31b3b88">概要</a></h2>
<div class="outline-text-2" id="text-org31b3b88">
<p>
Gitはバージョン管理システムである。
</p>
</div>
</div>
<div id="outline-container-org24592e5" class="outline-2">
<h2 id="org24592e5"><a href="#org24592e5">Memo</a></h2>
<div class="outline-text-2" id="text-org24592e5">
</div>
<div id="outline-container-orgc5c65d7" class="outline-3">
<h3 id="orgc5c65d7"><a href="#orgc5c65d7">デフォルトブランチをmaster → mainに変えたときの対応</a></h3>
<div class="outline-text-3" id="text-orgc5c65d7">
<p>
デフォルトブランチをmaster → mainに変えたとき、ローカルで実行して対応する。
</p>

<div class="org-src-container">
<pre class="src src-shell">git branch -m master main
git fetch origin
git branch -u origin/main main
git remote set-head origin -a
</pre>
</div>
</div>
</div>

<div id="outline-container-org2e2f795" class="outline-3">
<h3 id="org2e2f795"><a href="#org2e2f795">warning: refname &rsquo;xxx&rsquo; is ambiguous</a></h3>
<div class="outline-text-3" id="text-org2e2f795">
<p>
pullやpushしたとき、↑が出てうまくいかなくなることがある。これは、ブランチ名とタグ名がかぶっていることが原因。どちらかを削除するとうまくいくようになる。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>どちらか</label><pre class="src src-shell">$ git branch -d xxx
$ git tag -d xxx
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdf4a0b7" class="outline-3">
<h3 id="orgdf4a0b7"><a href="#orgdf4a0b7">ゴミファイルを削除する</a></h3>
<div class="outline-text-3" id="text-orgdf4a0b7">
<p>
gitignoreしたディレクトリで、いつの間にかゴミファイルがたまりがち。
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>削除されるファイルを確認してから、削除する</label><pre class="src src-shell">git clean -xdn <span class="org-comment-delimiter"># </span><span class="org-comment">dry run</span>
git clean -xdf <span class="org-comment-delimiter"># </span><span class="org-comment">&#23455;&#34892;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9ccaf6a" class="outline-3">
<h3 id="org9ccaf6a"><a href="#org9ccaf6a">revertしたブランチを再開するとき</a></h3>
<div class="outline-text-3" id="text-org9ccaf6a">
<p>
revertしたブランチの途中から再開すると、revertコミットのために差分が出ない。
なので、revertコミットをさらにrevertして、その上で作業を再開する。
</p>

<div class="org-src-container">
<pre class="src src-shell">git revert -m 1 {revert&#12375;&#12383;&#12467;&#12511;&#12483;&#12488;&#12495;&#12483;&#12471;&#12517;}
</pre>
</div>

<p>
<a href="https://stackoverflow.com/questions/2389361/undo-a-git-merge-that-hasnt-been-pushed-yet/6217372#6217372">https://stackoverflow.com/questions/2389361/undo-a-git-merge-that-hasnt-been-pushed-yet/6217372#6217372</a>
</p>
</div>
</div>
<div id="outline-container-org2cebb45" class="outline-3">
<h3 id="org2cebb45"><a href="#org2cebb45">コミットハッシュ取得</a></h3>
<div class="outline-text-3" id="text-org2cebb45">
<p>
タグをつけるときに便利。
</p>

<div class="org-src-container">
<pre class="src src-shell"><span class="org-variable-name">LC</span>=$(git rev-parse --short HEAD)
<span class="org-builtin">echo</span> ${<span class="org-variable-name">LC</span>}
</pre>
</div>

<pre class="example">
0f777f9
</pre>


<p>
↓みたいな感じで。
</p>
<div class="org-src-container">
<pre class="src src-shell">docker build -t ghcr.io/kijimad/webapp:${<span class="org-variable-name">LC</span>} .
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc9d9ddf" class="outline-3">
<h3 id="orgc9d9ddf"><a href="#orgc9d9ddf">certエラーが出るとき</a></h3>
<div class="outline-text-3" id="text-orgc9d9ddf">
<p>
依存パッケージインストール時、httpsでcloneできないことがある。証明書がないエラー。
</p>
<div class="org-src-container">
<pre class="src src-shell">git config --global http.sslVerify false
</pre>
</div>

<p>
<a href="https://stackoverflow.com/questions/19045556/git-clone-https-ssl-error">git clone https/ssl error - Stack Overflow</a>
</p>
</div>
</div>
<div id="outline-container-orgd5ab4b1" class="outline-3">
<h3 id="orgd5ab4b1"><a href="#orgd5ab4b1">バイナリファイルの差分</a></h3>
<div class="outline-text-3" id="text-orgd5ab4b1">
<p>
ファイルによって戦略を変えることができる。
特定のバイナリファイル…Wordファイルだったらこうやって変換してから差分を取る、など。
テキストに変換して、比較できる。
</p>

<ul class="org-ul">
<li><a href="http://git-scm.com/book/ja/v2/Git-%E3%81%AE%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%82%A4%E3%82%BA-Git-%E3%81%AE%E5%B1%9E%E6%80%A7">Git - Git の属性</a></li>
</ul>
</div>
</div>
<div id="outline-container-org2ac57d0" class="outline-3">
<h3 id="org2ac57d0"><a href="#org2ac57d0">Git軽量化</a></h3>
<div class="outline-text-3" id="text-org2ac57d0">
<p>
しばらく使っていると不要なブランチが溜まってきて重くなるので、定期的に不要なものを削除する。
</p>
<div class="org-src-container">
<pre class="src src-shell">git gc &amp;&amp; git fetch --prune
</pre>
</div>
</div>
</div>
<div id="outline-container-org895051f" class="outline-3">
<h3 id="org895051f"><a href="#org895051f">Gitクライアント</a></h3>
<div class="outline-text-3" id="text-org895051f">
<p>
直にGitコマンドを打つほかに、クライアントを使って操作する方法がある。
プログラミングと密接に関係しているので、エディタに付属したものを使うと、同じインターフェイスで扱えて便利。
例えば<a href="20210508234743-emacs.html#ID-1ad8c3d5-97ba-4905-be11-e6f2626127ad">Emacs</a>では<a href="https://github.com/magit/magit">Magit</a>パッケージが人気。
</p>
</div>
</div>
</div>
<div id="outline-container-orge17dc69" class="outline-2">
<h2 id="orge17dc69"><a href="#orge17dc69">Tasks</a></h2>
<div class="outline-text-2" id="text-orge17dc69">
</div>
<div id="outline-container-orgccc8872" class="outline-3">
<h3 id="orgccc8872"><a href="#orgccc8872"><span class="todo TODO">TODO</span> <a href="https://zenn.dev/chanmoro/scraps/06c972692f98df">git diff がある場合もしくは untracked なファイルがある場合にエラーの終了コードを返すコマンド</a></a></h3>
<div class="outline-text-3" id="text-orgccc8872">
<p>
差分があるとエラーにする。
</p>

<div class="org-src-container">
<pre class="src src-shell">$ test -z <span class="org-string">"$(git status -s)"</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org475b174" class="outline-3">
<h3 id="org475b174"><a href="#org475b174"><span class="todo TODO">TODO</span> <a href="https://koseki.hatenablog.com/entry/2014/04/22/inside-git-1">Git の仕組み (1) - こせきの技術日記</a></a></h3>
<div class="outline-text-3" id="text-org475b174">
<p>
Gitの仕組み。
</p>
</div>
</div>
<div id="outline-container-org088d9a8" class="outline-3">
<h3 id="org088d9a8"><a href="#org088d9a8"><span class="todo TODO">TODO</span> <a href="https://qiita.com/_ha1f/items/2dca1047c57d4f0bd465">難しいGitコマンドは、仕組みから理解してみよう - Qiita</a></a></h3>
<div class="outline-text-3" id="text-org088d9a8">
<p>
Gitの仕組みの解説。
</p>
</div>
</div>
<div id="outline-container-orgea1f936" class="outline-3">
<h3 id="orgea1f936"><a href="#orgea1f936"><span class="todo TODO">TODO</span> Gitの仕組みを大まかに理解する&#xa0;&#xa0;&#xa0;<span class="tag"><span class="DontKnow">DontKnow</span></span></a></h3>
<div class="outline-text-3" id="text-orgea1f936">
</div>
</div>
<div id="outline-container-org565a1e6" class="outline-3">
<h3 id="org565a1e6"><a href="#org565a1e6"><span class="todo TODO">TODO</span> <a href="http://git-scm.com/book/ja/v2">Git - Book</a></a></h3>
<div class="outline-text-3" id="text-org565a1e6">
<p>
日本語で無料公開されている本。
Gitの仕組みの章がとても面白い。
実際のGitが内部で行っていることを、原始的なコマンドを使ってやってみるというもの。
</p>
</div>
</div>
<div id="outline-container-orgb5f744d" class="outline-3">
<h3 id="orgb5f744d"><a href="#orgb5f744d"><span class="todo TODO">TODO</span> <a href="https://github.blog/jp/2021-01-06-commits-are-snapshots-not-diffs/">コミットはスナップショットであり差分ではない - GitHubブログ</a></a></h3>
<div class="outline-text-3" id="text-orgb5f744d">
<p>
仕組みからの解説。
</p>
</div>
</div>
</div>
<div id="outline-container-org61b1c58" class="outline-2">
<h2 id="org61b1c58"><a href="#org61b1c58">Reference</a></h2>
<div class="outline-text-2" id="text-org61b1c58">
</div>
<div id="outline-container-org8840c21" class="outline-3">
<h3 id="org8840c21"><a href="#org8840c21"><a href="https://evanli.github.io/Github-Ranking/Top100/Go.html">Github Ranking | Github-Ranking</a></a></h3>
<div class="outline-text-3" id="text-org8840c21">
<p>
スター数のランキング。
</p>
</div>
</div>
<div id="outline-container-org423d067" class="outline-3">
<h3 id="org423d067"><a href="#org423d067"><a href="https://gource.io/">Gource - a software version control visualization tool</a></a></h3>
<div class="outline-text-3" id="text-org423d067">
<p>
Gitの美しい可視化ツール。
</p>
</div>
</div>
<div id="outline-container-orge8f5e69" class="outline-3">
<h3 id="orge8f5e69"><a href="#orge8f5e69"><a href="https://qiita.com/koara-local/items/e36bc172a3c36eb67b4f">[Git] remoteのtagとbranchの名前が同じ場合の消し方 - Qiita</a></a></h3>
<div class="outline-text-3" id="text-orge8f5e69">
<p>
<a href="20220427215330-github_actions.html#ID-2d35ac9e-554a-4142-bba7-3c614cbfe4c4">GitHub Actions</a>で間違えたときになる。調べないとわからない。
</p>
</div>
</div>
<div id="outline-container-orged36eca" class="outline-3">
<h3 id="orged36eca"><a href="#orged36eca"><a href="http://git-scm.com/book/ja/v2/Git%E3%81%AE%E5%86%85%E5%81%B4-%E9%85%8D%E7%AE%A1%EF%BC%88Plumbing%EF%BC%89%E3%81%A8%E7%A3%81%E5%99%A8%EF%BC%88Porcelain%EF%BC%89">Git - 配管（Plumbing）と磁器（Porcelain）</a></a></h3>
<div class="outline-text-3" id="text-orged36eca">
<p>
基本的なGitの仕組みの解説。
</p>
</div>
</div>
<div id="outline-container-org21a7ce3" class="outline-3">
<h3 id="org21a7ce3"><a href="#org21a7ce3"><a href="https://www.youtube.com/watch?v=W71BTkUbdqE">Why Google Stores Billions of Lines of Code in a Single Repository - YouTube</a></a></h3>
<div class="outline-text-3" id="text-org21a7ce3">
<p>
なぜGoogleはモノレポで管理しているか。
</p>
</div>
</div>
<div id="outline-container-orgd34c540" class="outline-3">
<h3 id="orgd34c540"><a href="#orgd34c540"><a href="https://codeinthehole.com/tips/a-useful-template-for-commit-messages/">A useful template for commit messages — David Winterbottom</a></a></h3>
<div class="outline-text-3" id="text-orgd34c540">
<p>
Git commitテンプレート。
</p>
</div>
</div>
<div id="outline-container-orga7c83bb" class="outline-3">
<h3 id="orga7c83bb"><a href="#orga7c83bb"><a href="https://chris.beams.io/posts/git-commit/">How to Write a Git Commit Message</a></a></h3>
<div class="outline-text-3" id="text-orga7c83bb">
<p>
わかりやすいメッセージの書き方。
</p>
</div>
</div>
</div>
<div id="outline-container-org2e77b7e" class="outline-2">
<h2 id="org2e77b7e"><a href="#org2e77b7e">Archive</a></h2>
<div class="outline-text-2" id="text-org2e77b7e">
</div>
<div id="outline-container-orgbc0de05" class="outline-3">
<h3 id="orgbc0de05"><a href="#orgbc0de05"><span class="done DONE">DONE</span> Rebase on Magit</a></h3>
<div class="outline-text-3" id="text-orgbc0de05">
<p>
わかりやすく解説している。
</p>
<ul class="org-ul">
<li><a href="https://www.youtube.com/watch?v=zM7K1y4h6UQ&amp;list=PLEoMzSkcN8oMc34dTjyFmTUWbXTKrNfZA&amp;index=3">Fix Your Git Commits Like a Rebase Expert with Magit - YouTube</a></li>
</ul>

<p>
今までコミットの修正したことなかったな。
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<footer class="footer py-3"><div class="container"><div class="row "><div class="col-md-4"></div><div class="col-sm col-md"><nav class="navbar"><a class="nav-link text-secondary small px-0" href="./index.html">Insomnia</a><a class="nav-link text-secondary small px-0" href="./sitemap.html">Sitemap</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD/roam">Repository</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD">@kijimaD</a></nav></div><div class="col-md-4"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"/>
</div>
</body>
</html>
