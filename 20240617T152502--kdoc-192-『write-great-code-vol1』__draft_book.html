<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2025-09-11T19:04:56Z -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>KDOC 192: 『Write Great Code Vol.1』</title>
<meta name="author" content="kijimaD" />
<meta name="generator" content="Org Mode" />
<link rel='shortcut icon' type='image/x-icon' href='https://kijimad.github.io/roam/favicon.ico' /><link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' media='print' onload='this.media="all"' /><link rel='stylesheet' href='https://kijimad.github.io/roam/css/site.css' /><link rel='stylesheet' href='https://kijimad.github.io/roam/css/code.css' /><link rel='preconnect' href='https://fonts.googleapis.com'><link rel='preconnect' href='https://fonts.gstatic.com' crossorigin><link href='https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+JP&display=swap' rel='stylesheet'>
</head>
<body>
<div id="preamble" class="status">
<div><div class="header"><div class="container"><div class="row"><div class="col-sm-12 col-md-12"><nav class="navbar navbar-light"/></div></div></div></div></div>
</div>
<div id="content" class="content">
<h1 class="title">KDOC 192: 『Write Great Code Vol.1』</h1>
<div id="outline-container-org003947d" class="outline-2">
<h2 id="org003947d"><a href="#org003947d">この文書のステータス</a></h2>
<div class="outline-text-2" id="text-org003947d">
<ul class="org-ul">
<li>作成
<ul class="org-ul">
<li class="off"><input type='checkbox' /> &lt;署名&gt;</li>
</ul></li>
</ul>

<ul class="org-ul">
<li>レビュー
<ul class="org-ul">
<li class="off"><input type='checkbox' /> &lt;署名&gt;</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org5590062" class="outline-2">
<h2 id="org5590062"><a href="#org5590062">概要</a></h2>
<div class="outline-text-2" id="text-org5590062">
<p>
<a href="https://tatsu-zine.com/books/write-great-code01">Write Great Code〈Vol.1〉</a>は、低レイヤからよいコードを書く方法についての本。
</p>
</div>
</div>
<div id="outline-container-org7725a11" class="outline-2">
<h2 id="org7725a11"><a href="#org7725a11">メモ</a></h2>
<div class="outline-text-2" id="text-org7725a11">
<ul class="org-ul">
<li>BCD(Binary-Coded Decimal)は、10進数の値を2進表現でコード化したものである。BCDはデータをそれほど効率的に格納できない。重要な計算が、しばしば10進ベースの演算を使って実行されていた。特定の計算では正確な結果が得られるが、2進表現のほうがより正確に計算できることがほとんどである。このため最近のコンピュータプログラムで、すべての値(10進値を含めて)を2進形式で表現している、という(p32)</li>
<li>数値、文字列の変換にはコストがかかる、という(p20)</li>
<li>高水準言語の中には、パックされたデータのサポートが標準で組み込まれているものがある。たとえば、<a href="20210911104632-c_language.html#ID-656a0aa4-e5d3-416f-82d5-f909558d0639">C言語</a>では次のような構造体を定義できる(p59)</li>
</ul>

<div class="org-src-container">
<pre class="src src-C"><span class="org-keyword">struct</span> {
  <span class="org-type">unsigned</span> <span class="org-variable-name">bits0_3</span> :4;
  <span class="org-type">unsigned</span> <span class="org-variable-name">bits4_11</span> :8;
  <span class="org-type">unsigned</span> <span class="org-variable-name">bits12_15</span> :4;
  <span class="org-type">unsigned</span> <span class="org-variable-name">bits16_23</span> :8;
  <span class="org-type">unsigned</span> <span class="org-variable-name">bits24_31</span> :8;
} <span class="org-variable-name">packedData</span>;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-nil">
</pre>
</div>

<ul class="org-ul">
<li>浮動小数点計算の正確性を高めるには、計算時に追加の桁を使う必要がある。この追加の桁をガード桁という(p67)</li>
<li>浮動小数点同士の比較は危険。2進数の浮動小数点形式では、数学的に同じ結果を返す2つの計算の最下位ビットが異なる場合がある。代数的には等しくても、等式としてそのまま比較すると等しくならないことがある(p69)</li>
<li>浮動小数点形式も、当然2進表現で保存されている。どのような形式で保存するかによって、計算コストや容量コストが変わってくる</li>
<li>Microsoft Windowsは内部的にUnicodeを使っている。そのためシステムコールにはASCII文字列を渡すよりもUnicode文字列を渡したほうが実行スピードが早くなる(p105)</li>
<li>ゼロ終端文字列、長さ接頭辞付き文字列のメリットデメリット(p107)</li>
<li>長さ接頭辞付き文字列では、長さを示す接頭辞が文字列内の0の位置にある。文字列の最初の文字が文字列の配列表現においてインデックス1ではじまる。これは、実世界での数え方と同じである(p108)</li>
<li>説明用に新しい文字セットを定義していく。同じ文字の範囲だとしても、並べ方によってソートや比較の速度、人の扱いやすさに影響が出る</li>
<li>6章 メモリの構成とアクセス</li>
<li>アドレスの信号線が1本ある場合、プロセッサがアクセスできる一意のアドレスは0と1の2つ。n本ある場合、プロセッサは2のn乗の一意のアドレスにアクセスできる(p130)</li>
<li>システムはコントロールバスで読み出しと書き込みの2本の信号線を使ってデータフローの方向(CPU→メモリ、メモリ→CPU)を判断している(p131)</li>
<li>多くのプロセッサでは、オブジェクトサイズの偶数倍のアドレスにあるオブジェクトにアクセスしないと例外が発生する(p138)</li>
<li>データをUSB経由で伝達するとき、標準形式はリトルエンディアンになる(p140)</li>
<li>共用体内のすべてのフィールドが同じメモリ位置で重なり合っている
<ul class="org-ul">
<li>共用体の性質を利用して、32ビットオブジェクトの個別のバイトにアクセスできるので、順番を並び替えられる</li>
</ul></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>共用体。iフィールドに値を書き込むと、uフィールドの値と、rフィールドの2バイトも上書きすることになる</label><pre class="src src-C"><span class="org-keyword">union</span>{
  <span class="org-type">short</span> <span class="org-type">unsigned</span> <span class="org-variable-name">i</span>;
  <span class="org-type">short</span> <span class="org-type">unsigned</span> <span class="org-variable-name">u</span>;
  <span class="org-type">long</span>  <span class="org-type">unsigned</span> <span class="org-variable-name">r</span>;
} <span class="org-variable-name">UNIONvar</span>;
</pre>
</div>

<ul class="org-ul">
<li>システムクロック
<ul class="org-ul">
<li>動作周波数</li>
<li>システムはどうやって文を正しい順序で実行しているか</li>
</ul></li>
<li>クロックエッジ
<ul class="org-ul">
<li>クロック信号がLからHに遷移する部分</li>
</ul></li>
<li>ゼロウェイトステート
<ul class="org-ul">
<li>CPUは早い。メモリは比較して遅い。したがってCPUがメモリの処理を待って処理を停止する</li>
</ul></li>
<li>CPUは複数のレベルからなるキャッシュを持っている。レベル1キャッシュはオンチップにありとても高速だが高い(p151)</li>
<li>CPUがサポートするもっとも一般的なメモリアドレス指定モードは、直接モード、間接モード、そしてインデックス付きモードである(p151)</li>
<li>適切なアドレス指定モードを選択することで同じ結果を少ない命令と少ないメモリアクセスで計算できるためパフォーマンスが向上する(p152)</li>
<li>ポインタに整数のオフセットを加える場合に高級言語でもっとも一般的な対処法は、ポインタが参照するオブジェクトのサイズをそのオフセットに掛けること(p162)</li>
<li>配列の添字に浮動小数点や順序型の値を入れられるプログラミング言語もある(p167)</li>
<li>添字の開始番号を指定できるプログラミング言語がある</li>
</ul>
</div>
</div>
<div id="outline-container-org03c0b38" class="outline-2">
<h2 id="org03c0b38"><a href="#org03c0b38">関連</a></h2>
<div class="outline-text-2" id="text-org03c0b38">
</div>
</div>
<div id="outline-container-org6f27823" class="outline-2">
<h2 id="org6f27823"><a href="#org6f27823">Backlinks</a></h2>
<div class="outline-text-2" id="text-org6f27823">
<ul class="org-ul">
<li><a href="./20240921T003646--kdoc-245-パックしたデータ型がどのように保存されているか見る__wiki.html">KDOC 245: パックしたデータ型がどのように保存されているか見る</a></li>
<li><a href="./20240921T111620--kdoc-246-浮動小数点の誤差を体感する__wiki.html">KDOC 246: 浮動小数点の誤差を体感する</a></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<footer class="footer py-3"><div class="container"><div class="row "><div class="col-md-4"></div><div class="col-sm col-md"><nav class="navbar"><a class="nav-link text-secondary small px-0" href="./index.html">Insomnia</a><a class="nav-link text-secondary small px-0" href="./sitemap.html">Sitemap</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD/roam">Repository</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD">@kijimaD</a></nav></div><div class="col-md-4"></div></div></div></footer>
</div>
</body>
</html>
