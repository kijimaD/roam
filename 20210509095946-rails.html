<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2025-11-27T23:18:49Z -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Rails</title>
<meta name="author" content="kijimaD" />
<meta name="generator" content="Org Mode" />
<link rel='shortcut icon' type='image/x-icon' href='https://kijimad.github.io/roam/favicon.ico' /><link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' media='print' onload='this.media="all"' /><link rel='stylesheet' href='https://kijimad.github.io/roam/css/site.css' /><link rel='stylesheet' href='https://kijimad.github.io/roam/css/code.css' /><link rel='preconnect' href='https://fonts.googleapis.com'><link rel='preconnect' href='https://fonts.gstatic.com' crossorigin><link href='https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+JP&display=swap' rel='stylesheet'>
</head>
<body>
<div id="preamble" class="status">
<div><div class="header"><div class="container"><div class="row"><div class="col-sm-12 col-md-12"><nav class="navbar navbar-light"/></div></div></div></div></div>
</div>
<div id="content" class="content">
<h1 class="title">Rails</h1>
<div id="outline-container-orgd24a127" class="outline-2">
<h2 id="orgd24a127"><a href="#orgd24a127">æ¦‚è¦</a></h2>
<div class="outline-text-2" id="text-orgd24a127">
<p>
Railsã¯<a href="20210509095513-ruby.html#ID-cfd092c4-1bb2-43d3-88b1-9f647809e546">Ruby</a>ã§WEBã‚µã‚¤ãƒˆã‚’ä½œã‚‹ãŸã‚ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‚
</p>
</div>
</div>
<div id="outline-container-org84670c0" class="outline-2">
<h2 id="org84670c0"><a href="#org84670c0">Memo</a></h2>
<div class="outline-text-2" id="text-org84670c0">
</div>
<div id="outline-container-org8900c06" class="outline-3">
<h3 id="org8900c06"><a href="#org8900c06">é›†è¨ˆæ™‚ã®N+1å›é¿</a></h3>
<div class="outline-text-3" id="text-org8900c06">
<p>
ç•°ãªã‚‹æ¡ä»¶ã®è¤‡æ•°ã®ä»¶æ•°ã‚’è¡¨ç¤ºã—ãŸã„ã¨ãã€‚ãŸã¨ãˆã°â†“ãƒ¬ã‚³ãƒ¼ãƒ‰ã§ã€Receiptsã«è¼‰ã£ã¦ã„ã‚‹productã®æ•°ã”ã¨ã«é›†è¨ˆã—ãŸã„ã€‚
</p>

<ul class="org-ul">
<li>æœ€çµ‚å‹</li>
</ul>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">products.name</td>
<td class="org-right">count</td>
</tr>

<tr>
<td class="org-left">ãŠã«ãã‚Š</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">ãŠèŒ¶</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>



<ul class="org-ul">
<li>Receipts</li>
</ul>
<table>


<colgroup>
<col  class="org-right">

<col  class="org-right">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-right">id</td>
<td class="org-right">product_id</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">2</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>Products</li>
</ul>
<table>


<colgroup>
<col  class="org-right">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-right">id</td>
<td class="org-left">name</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">ãŠã«ãã‚Š</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">ãŠèŒ¶</td>
</tr>
</tbody>
</table>

<p>
ã“ã†ã‚„ã£ã¦æ›¸ãã¨æ˜ã‚‰ã‹ã«SQLã®groupé–¢æ•°ã‚’ä½¿ãŠã†ã€ã¨ãªã‚‹ã€‚ãŒã€å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ã§ã¯æ°—ã¥ã‹ãšã«æ¡ä»¶ã‚’å¤‰ãˆã¦eachã§ç¹°ã‚Šè¿”ã™â€¦ã¨ã—ã¦N+1ã«ã—ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹ã€‚ã“ã†ã™ã‚‹ã€‚
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span class="org-type">Receipt</span>.group(<span class="org-type">Product</span>.arel_table[<span class="org-constant">:id</span>]).count
</pre>
</div>

<p>
ã“ã®ã‚ˆã†ãªãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿”ã™ã€‚
</p>

<div class="org-src-container">
<pre class="src src-json">// product_id =&gt; count
{
  1=&gt;2,
  2=&gt;1
}
</pre>
</div>

<p>
product_idãŒã‚ã‹ã£ã¦ã„ã‚‹ã®ã§ã€ã‚ã¨ã¯Productã‚’findã—ã¦åå‰ã‚’å¼•ã‘ã°ã„ã„ã€‚
</p>
</div>
</div>
<div id="outline-container-org23e6ced" class="outline-3">
<h3 id="org23e6ced"><a href="#org23e6ced">ã‚¨ãƒ©ãƒ¼è¡¨ç¤º</a></h3>
<div class="outline-text-3" id="text-org23e6ced">
<p>
ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã¯ã€configã§è¨­å®šã§ãã‚‹ã€‚
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®production, sandbox, stagingã§ã¯falseã«ãªã£ã¦ã„ã¦ã€ã‚¨ãƒ©ãƒ¼ã¯è¡¨ç¤ºã•ã‚Œãªã„ã€‚
ã“ã‚Œã‚‰ã®ç’°å¢ƒã§è¡¨ç¤ºã™ã‚‹ã«ã¯ã€â†“ã‚’åŠ ãˆã‚‹ã€‚
</p>
<div class="org-src-container">
<pre class="src src-shell">config.consider_all_requests_local = true
</pre>
</div>
</div>
</div>
<div id="outline-container-orga44dbaf" class="outline-3">
<h3 id="orga44dbaf"><a href="#orga44dbaf">viewã§controllerã‚¯ãƒ©ã‚¹ã®æƒ…å ±ã‚’å¾—ã‚‹</a></h3>
<div class="outline-text-3" id="text-orga44dbaf">
<p>
ãŸã¾ã«å¿…è¦ãªã“ã¨ãŒã‚ã‚‹ã€‚
controllerã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæŸ”è»Ÿãªæ„Ÿã˜ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>viewãƒ•ã‚¡ã‚¤ãƒ«</label><pre class="src src-ruby">controller.class <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; #&lt;Admin::UserController&gt;
</span>controller_name <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; users
</span>controller_path <span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; admin/users</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>controllerãŒç‰¹å®šã®moduleã‚’includeã—ã¦ã„ã‚‹ã‹åˆ¤å®š</label><pre class="src src-ruby">controller.class.included_modules.include?(<span class="org-type">User</span>::concern)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf6d2863" class="outline-3">
<h3 id="orgf6d2863"><a href="#orgf6d2863">å®šç¾©ã‚¸ãƒ£ãƒ³ãƒ—</a></h3>
<div class="outline-text-3" id="text-orgf6d2863">
<p>
<a href="20210508234743-emacs.html#ID-1ad8c3d5-97ba-4905-be11-e6f2626127ad">Emacs</a>ã‹ã‚‰å®šç¾©ã‚¸ãƒ£ãƒ³ãƒ—ã—ãŸã„ã€‚
ã»ã‹ã®è¨€èªã‚„ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã ã¨<a href="20220305121848-lsp.html#ID-eb807577-cd69-478c-8f82-264243c67354">LSP</a>ã ã®ã‚’ä½¿ãˆã°ã„ã„ãŒã€Railsã§ã¯ã©ã†ã™ã‚‹ã®ã‹ã‚ˆãã‚ã‹ã‚‰ãªã„ã€‚
TAGSãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¦ä½¿ã†ã€‚
</p>

<div class="org-src-container">
<pre class="src src-shell">gem install ripper-tags
ripper-tags -e -R -f TAGS
</pre>
</div>

<p>
ã‚ã¨ã¯ã€C-. ã§ç”Ÿæˆã—ãŸã‚¿ã‚°ã‚’æŒ‡å®šã™ã‚Œã°OKã€‚
</p>

<p>
gemã‚‚å®šç¾©ã‚¸ãƒ£ãƒ³ãƒ—å¯¾è±¡ã«ã—ãŸã„å ´åˆã€ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«gemã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ç½®ã‘ã°ã‚ˆã„ã€‚
</p>
<div class="org-src-container">
<pre class="src src-shell">bundle install --path vendor/bundle
</pre>
</div>

<p>
<a href="https://qiita.com/arakaji/items/0cdfa843a0e0233df153">Railsã‚¢ãƒ—ãƒªå†…ã‚’Emacsã§è‡ªç”±ã«ã‚¿ã‚°ã‚¸ãƒ£ãƒ³ãƒ—! - Qiita</a>
</p>
</div>
</div>
<div id="outline-container-orgeec08b9" class="outline-3">
<h3 id="orgeec08b9"><a href="#orgeec08b9">mailerã¯ã‚­ãƒ¥ãƒ¼ã«ãŸã‚ã‚‰ã‚Œã‚‹ã®ã§ã€Serializationã§ããªã„å€¤ã¯æ¸¡ã™ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹</a></h3>
<div class="outline-text-3" id="text-orgeec08b9">
<p>
SerializationErrorã«ãªã‚‹ã€‚
ãƒ¡ãƒ¼ãƒ©ãƒ¼ã«å¯¾ã—ã¦ã€ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã§ããªã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯æ¸¡ã™ã“ã¨ãŒã§ããªã„ã€‚
Railsã‹ã‚‰<a href="20220420225811-redis.html#ID-48b99bce-05ce-49af-921d-1e321e5a4f8b">Redis</a>ã«æ¸¡ã•ã‚Œã‚‹ãŒã€<a href="20220420225811-redis.html#ID-48b99bce-05ce-49af-921d-1e321e5a4f8b">Redis</a>ã¯key-value storeã®å½¢ã§ãªã„ã¨ä¿å­˜ã§ããªã„ã‹ã‚‰ã€‚
<a href="https://github.com/rails/rails/issues/18519">Mail and deliver_later doesn&rsquo;t work with date argument Â· Issue #18519 Â· rails/rails</a>
</p>
</div>
</div>
<div id="outline-container-org76ecca9" class="outline-3">
<h3 id="org76ecca9"><a href="#org76ecca9">joinå…ˆã®ãƒ†ãƒ¼ãƒ–ãƒ«ã§where</a></h3>
<div class="outline-text-3" id="text-org76ecca9">
<p>
A -&lt; B -&lt; C -&lt; D ã¿ãŸã„ãªé–¢ä¿‚ã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>mergeã§é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«å…ˆã§æ¡ä»¶ã‚’çµã‚Œã‚‹</label><pre class="src src-ruby">a = <span class="org-type">A</span>.joins(<span class="org-constant">b:</span> [<span class="org-constant">c:</span> <span class="org-constant">:d</span>])
      .where(<span class="org-constant">a:</span> { <span class="org-constant">flag_a:</span> <span class="org-constant">true</span> })
      .merge(<span class="org-type">D</span>.where(<span class="org-constant">flag_d:</span> <span class="org-constant">true</span>))
</pre>
</div>

<p>
åŒã˜æ„å‘³ã®ãƒ€ã‚µã„æ›¸ãæ–¹ã€‚
</p>
<div class="org-src-container">
<pre class="src src-ruby">a = a.joins(<span class="org-constant">b:</span> [<span class="org-constant">c:</span> <span class="org-constant">:d</span>])
      .where(<span class="org-constant">a:</span> { <span class="org-constant">flag_a:</span> <span class="org-constant">true</span> })
      .where(<span class="org-constant">d:</span> { <span class="org-constant">flag_d:</span> <span class="org-constant">true</span> })
</pre>
</div>
</div>
</div>
<div id="outline-container-org531e94a" class="outline-3">
<h3 id="org531e94a"><a href="#org531e94a"><a href="20210805005543-docker.html#ID-1658782a-d331-464b-9fd7-1f8233b8b7f8">Docker</a>ã‚µãƒ³ãƒ—ãƒ«</a></h3>
<div class="outline-text-3" id="text-org531e94a">
<p>
é–‹ç™ºç”¨ç’°å¢ƒã®ã‚µãƒ³ãƒ—ãƒ«ã€‚ã‚µã‚¯ã£ã¨èµ·å‹•ã—ãŸã„ç”¨ã€‚
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚ã¡ã“ã¡ã§ä½¿ã£ã¦ã‚‹ã®ã§ã€ã©ã“ã‹ã«ã¾ã¨ã‚ãŸã»ã†ãŒã‚ˆã•ãã†ã ãªã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 4: </span>Dockerfile</label><pre class="src src-nil">FROM phusion/passenger-ruby27:latest

WORKDIR /tmp

ADD Gemfile /tmp/
ADD Gemfile.lock /tmp/
RUN gem update --system
RUN bundle install

COPY . /home/app/webapp
RUN usermod -u 1000 app
RUN chown -R app:app /home/app/webapp
WORKDIR /home/app/webapp

RUN apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*
</pre>
</div>

<p>
ã‹ã¶ã‚Šé˜²æ­¢ã®ãŸã‚3001ç•ªãƒãƒ¼ãƒˆã®æ–¹ã‚’å¤‰ãˆã¦ãƒ–ãƒ©ã‚¦ã‚¶ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 5: </span>docker-compose.yml</label><pre class="src src-yaml">version: '3'

services:
  rails:
    container_name: rails
    build: .
    command: bash -c 'rm -f tmp/pids/server.pid &amp;&amp; bundle exec rails s -b 0.0.0.0'
    volumes:
      - .:/home/app/webapp
    ports:
      - "3001:3000"
</pre>
</div>
</div>
</div>
<div id="outline-container-org4c183ca" class="outline-3">
<h3 id="org4c183ca"><a href="#org4c183ca">ä¾å­˜é–¢ä¿‚ä¸€åˆ‡ãªãrails newã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org4c183ca">
<p>
å…¬å¼ã®railsã‚³ãƒ³ãƒ†ãƒŠå†…ã§rails newã™ã‚Œã°ã‚ˆã„ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 6: </span>ä¾å­˜ãŒãªã„ä½œæˆæ–¹æ³•ã€‚userå‘¨ã‚Šã¯æ¨©é™å•é¡Œã®ãŸã‚âš ä¸€è¡Œ</label><pre class="src src-shell">docker run -it --rm --user <span class="org-string">"$(id -u):$(id -g)"</span> -v <span class="org-string">"$PWD"</span>:/usr/src/app -w /usr/src/app rails rails new --skip-bundle --api --database postgresql .
</pre>
</div>

<p>
ä¾å­˜ãŒãªã„bundle installã€‚
ruby:2.7.5ã‚¤ãƒ¡ãƒ¼ã‚¸ã§èµ°ã‚‰ã›ã‚‹ã€‚
</p>
<div class="org-src-container">
<pre class="src src-shell">docker run --rm -v <span class="org-string">"$PWD"</span>:/usr/src/app -w /usr/src/app ruby:2.7.5 bundle install
</pre>
</div>
</div>
</div>
<div id="outline-container-org2a49873" class="outline-3">
<h3 id="org2a49873"><a href="#org2a49873">factoryãŒãªã„ãƒ¢ãƒ‡ãƒ«ã‚’æ¤œçŸ¥ã™ã‚‹ã‚¿ã‚¹ã‚¯</a></h3>
<div class="outline-text-3" id="text-org2a49873">
<p>
factoryã¯ãƒ†ã‚¹ãƒˆã§ä½¿ã†ã®ã§ã€fixtureã»ã©å¿˜ã‚Œã‚‹ã“ã¨ã¯ãªã„ã€‚ä½œã‚Šå¿˜ã‚ŒãŸã‚Šã€éå»ã‚‚ã®ã§æ¼ã‚Œã¦ã„ã‚‹ã‚‚ã®ãŒãŸã¾ã«ã‚ã‚‹ã®ã§æ¤œçŸ¥ã™ã‚‹ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 7: </span>rakeã‚¿ã‚¹ã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦</label><pre class="src src-ruby"><span class="org-builtin">require</span> <span class="org-string">"factory_bot_rails"</span>
<span class="org-builtin">include</span> <span class="org-type">FactoryBot</span>::<span class="org-type">Syntax</span>::<span class="org-type">Methods</span>
<span class="org-builtin">include</span> <span class="org-type">ActionDispatch</span>::<span class="org-type">TestProcess</span> <span class="org-comment-delimiter">#  </span><span class="org-comment"># fixture_file_upload&#12513;&#12477;&#12483;&#12489;&#12391;&#12456;&#12521;&#12540;&#12395;&#12394;&#12427;&#12383;&#12417;&#24517;&#35201;&#12290;
</span>
task <span class="org-constant">factory:</span> <span class="org-constant">:environment</span> <span class="org-keyword">do</span>
    msg = []
    errors = []

    <span class="org-type">Rails</span>.application.eager_load!
    <span class="org-type">ApplicationRecord</span>.subclasses.each <span class="org-keyword">do</span> |model|
      <span class="org-keyword">begin</span>
        create(model.name.underscore.gsub(<span class="org-string">%r{/}</span>, <span class="org-string">'_'</span>)) <span class="org-comment-delimiter"># </span><span class="org-comment">factory&#12398;&#12513;&#12477;&#12483;&#12489;
</span>        <span class="org-comment-delimiter"># </span><span class="org-comment">UserPayment -&gt; user_payment
</span>        <span class="org-comment-delimiter"># </span><span class="org-comment">admin/user_payment -&gt; admin_user_payment
</span>      <span class="org-keyword">rescue</span> =&gt; e
        errors &lt;&lt; e <span class="org-keyword">if</span> e.class == <span class="org-type">KeyError</span>
      <span class="org-keyword">end</span>
    <span class="org-keyword">end</span>

    <span class="org-builtin">puts</span> errors

    <span class="org-builtin">raise</span> <span class="org-string">'&#30331;&#37682;&#12373;&#12428;&#12390;&#12394;&#12356;factory&#12364;&#12354;&#12426;&#12414;&#12377;'</span> <span class="org-keyword">if</span> errors
  <span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org42cb747" class="outline-3">
<h3 id="org42cb747"><a href="#org42cb747">ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒãªã„ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ¤œçŸ¥ã™ã‚‹ã‚¿ã‚¹ã‚¯</a></h3>
<div class="outline-text-3" id="text-org42cb747">
<p>
fixtureã®ä½œã‚Šå¿˜ã‚Œãªã©ã‚ˆãã‚ã‚‹ã®ã§ã€seedã‚’å®Ÿè¡Œã—ãŸã‚ã¨ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚¿ã‚¹ã‚¯ã‚’èµ°ã‚‰ã›ã‚‹ã¨ã‚ˆã„ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 8: </span>rakeã‚¿ã‚¹ã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦</label><pre class="src src-ruby">task <span class="org-constant">lint:</span> <span class="org-constant">:environment</span> <span class="org-keyword">do</span>
  msg = []
  invalid = <span class="org-constant">false</span>

  <span class="org-type">Rails</span>.application.eager_load!
  <span class="org-type">ApplicationRecord</span>.subclasses.each <span class="org-keyword">do</span> |model|
    msg &lt;&lt; <span class="org-string">"</span><span class="org-variable-name">#{model.name}</span><span class="org-string"> =&gt; </span><span class="org-variable-name">#{model.count}</span><span class="org-string">"</span>
    invalid = <span class="org-constant">true</span> <span class="org-keyword">if</span> model.count.zero?
  <span class="org-keyword">end</span>

  <span class="org-builtin">puts</span> msg

  <span class="org-builtin">raise</span> <span class="org-string">'&#12524;&#12467;&#12540;&#12489;&#12364;&#12394;&#12356;&#12486;&#12540;&#12502;&#12523;&#12364;&#12354;&#12426;&#12414;&#12377;'</span> <span class="org-keyword">if</span> invalid
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org402dc64" class="outline-3">
<h3 id="org402dc64"><a href="#org402dc64">seed_fuå†…ã§factory botã‚’ä½¿ã†</a></h3>
<div class="outline-text-3" id="text-org402dc64">
<p>
SeedFu.seedã‚’å®Ÿè¡Œã™ã‚‹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§require, includeã—ã¦ãŠã‘ã°ãƒ¡ã‚½ãƒƒãƒ‰ãŒä½¿ãˆã‚‹ã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 9: </span>rakeã‚¿ã‚¹ã‚¯ãƒ•ã‚¡ã‚¤ãƒ«</label><pre class="src src-ruby"><span class="org-builtin">require</span> <span class="org-string">"factory_bot_rails"</span>
<span class="org-builtin">include</span> <span class="org-type">FactoryBot</span>::<span class="org-type">Syntax</span>::<span class="org-type">Methods</span>
<span class="org-builtin">include</span> <span class="org-type">ActionDispatch</span>::<span class="org-type">TestProcess</span>
<span class="org-type">SeedFu</span>.quiet = <span class="org-constant">true</span>

task <span class="org-constant">lint:</span> <span class="org-constant">:environment</span> <span class="org-keyword">do</span>
  <span class="org-type">SeedFu</span>.seed(<span class="org-string">"db/fixtures/</span><span class="org-variable-name">#{env}</span><span class="org-string">"</span>)
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc2d25fd" class="outline-3">
<h3 id="orgc2d25fd"><a href="#orgc2d25fd">rakeã‚¿ã‚¹ã‚¯</a></h3>
<div class="outline-text-3" id="text-orgc2d25fd">
<p>
rakeã‚¿ã‚¹ã‚¯ã¯ã€æ™®é€šã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰å®Ÿè¡Œã™ã‚‹ãŒã€ã»ã‹ã‹ã‚‰å®Ÿè¡Œã—ãŸã„ã¨ããŒã‚ã‚‹(ãƒ†ã‚¹ãƒˆã¨ã‹)ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 10: </span>rails_helper.rbã«ã¦</label><pre class="src src-ruby">config.before(<span class="org-constant">:each</span>) <span class="org-keyword">do</span>
  <span class="org-type">Rake</span>.application.tasks.each(&amp;<span class="org-constant">:reenable</span>)
<span class="org-keyword">end</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 11: </span>ãƒ†ã‚¹ãƒˆä¸Šã«ã¦å®Ÿè¡Œã™ã‚‹</label><pre class="src src-ruby"><span class="org-type">Rake</span>.application[<span class="org-string">'namespace:command'</span>].invoke
</pre>
</div>

<p>
ã®ã‚ˆã†ã«ã—ã¦ã€å®Ÿè¡Œã§ãã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-orgcd9ff62" class="outline-3">
<h3 id="orgcd9ff62"><a href="#orgcd9ff62">éåŒæœŸå‡¦ç†</a></h3>
<div class="outline-text-3" id="text-orgcd9ff62">
<p>
Webã«ãŠã‘ã‚‹éåŒæœŸå‡¦ç†ã¯ãƒ¡ãƒ¼ãƒ«ã¨ã‹ã€å¤–éƒ¨ã¨ã®APIé€£æºã¨ã‹ã€æ¯”è¼ƒçš„æ™‚é–“ã®ã‹ã‹ã‚‹å‡¦ç†ã§ç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ã€‚
ã¨ã‚Šã‚ãˆãšç”»é¢ã‚’è¿”ã—ã€å¾…ãŸã›ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚
</p>

<p>
sidekiqã¯éåŒæœŸã‚¿ã‚¹ã‚¯ãƒ¯ãƒ¼ã‚«ãƒ¼ã€‚
<a href="20220420225811-redis.html#ID-48b99bce-05ce-49af-921d-1e321e5a4f8b">Redis</a>ã¯ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€‚
</p>

<p>
ãŸã¨ãˆã°Railsä¸Šã§ãƒ¡ãƒ¼ãƒ«ã‚’é€ã‚‹å‡¦ç†ãŒèµ°ã‚‹ã¨ãã€railsã¯ãã®ã‚¿ã‚¹ã‚¯ã‚’redisã«é€ã‚Šã€ä¿æŒã™ã‚‹(ã‚­ãƒ¥ãƒ¼ã™ã‚‹)ã€‚sidekiqã¯ã€ã‚­ãƒ¥ãƒ¼ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’é †æ¬¡å‡¦ç†ã—ã¦ã„ãã€‚
ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã®<a href="20220420225811-redis.html#ID-48b99bce-05ce-49af-921d-1e321e5a4f8b">Redis</a>ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ãƒ€ã‚¦ãƒ³ã—ã¦ã‚‚æœªå‡¦ç†ã®ã‚¸ãƒ§ãƒ–ã‚’å¤±ã‚ãªã„ã€‚
</p>
</div>
</div>
<div id="outline-container-org398b69d" class="outline-3">
<h3 id="org398b69d"><a href="#org398b69d">preload, eager_load, includes</a></h3>
<div class="outline-text-3" id="text-org398b69d">
<p>
ã‚„ã‚„ã“ã—ã„ãŒãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è€ƒãˆã‚‹ã†ãˆã§å¿…è¦ãªã®ã§ç†è§£ã—ã¦ãŠãã€‚
</p>

<ul class="org-ul">
<li><a href="https://tech.stmn.co.jp/entry/2020/11/30/145159">preloadã€eager_loadã€includesã®æŒ™å‹•ã‚’ç†è§£ã—ã¦ä½¿ã„åˆ†ã‘ã‚‹ - stmn tech blog</a></li>
</ul>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th scope="col" class="org-left">ã‚­ãƒ£ãƒƒã‚·ãƒ¥</th>
<th scope="col" class="org-left">ã‚¯ã‚¨ãƒª</th>
<th scope="col" class="org-left">ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">joins</td>
<td class="org-left">ã—ãªã„</td>
<td class="org-left">å˜æ•°</td>
<td class="org-left">çµã‚Šè¾¼ã¿</td>
</tr>

<tr>
<td class="org-left">eager_load</td>
<td class="org-left">ã™ã‚‹</td>
<td class="org-left">å˜æ•°</td>
<td class="org-left">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨çµã‚Šè¾¼ã¿</td>
</tr>

<tr>
<td class="org-left">preload</td>
<td class="org-left">ã™ã‚‹</td>
<td class="org-left">è¤‡æ•°</td>
<td class="org-left">ã‚­ãƒ£ãƒƒã‚·ãƒ¥</td>
</tr>

<tr>
<td class="org-left">includes</td>
<td class="org-left">ã™ã‚‹</td>
<td class="org-left">å ´åˆã«ã‚ˆã‚‹</td>
<td class="org-left">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€å¿…è¦ãªã‚‰çµã‚Šè¾¼ã¿</td>
</tr>
</tbody>
</table>

<blockquote>
<p>
ãã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã®JOINã‚’ç¦æ­¢ã—ãŸã„ã‚±ãƒ¼ã‚¹ã§ã¯preloadã‚’æŒ‡å®šã—ã€JOINã—ã¦ã‚‚å•é¡Œãªãã¦ã¨ã‚Šã‚ãˆãšeager loadingã—ãŸã„å ´åˆã¯includesã‚’ä½¿ã„ã€å¿…ãšJOINã—ãŸã„å ´åˆã¯eager_loadã‚’ä½¿ã„ã¾ã—ã‚‡ã†ã€‚
</p>
</blockquote>

<ul class="org-ul">
<li><a href="https://qiita.com/ryosuketter/items/097556841ec8e1b2940f">ActiveRecordã®includesã¯ä½¿ã‚ãšã«preloadã¨eager_loadã‚’ä½¿ã„åˆ†ã‘ã‚‹ç†ç”± - Qiita</a></li>
</ul>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th scope="col" class="org-left">SQL(ã‚¯ã‚¨ãƒª)</th>
<th scope="col" class="org-left">ã‚­ãƒ£ãƒƒã‚·ãƒ¥</th>
<th scope="col" class="org-left">ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³å…ˆã®ãƒ‡ãƒ¼ã‚¿å‚ç…§</th>
<th scope="col" class="org-left">ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">joins</td>
<td class="org-left">INNER JOIN</td>
<td class="org-left">ã—ãªã„</td>
<td class="org-left">ã§ãã‚‹</td>
<td class="org-left">N+1å•é¡Œ</td>
</tr>

<tr>
<td class="org-left">preload</td>
<td class="org-left">JOINã›ãšãã‚Œãã‚ŒSELECT</td>
<td class="org-left">ã™ã‚‹</td>
<td class="org-left">ã§ããªã„</td>
<td class="org-left">INå¥å¤§ãããªã‚ŠãŒã¡</td>
</tr>

<tr>
<td class="org-left">eager_load</td>
<td class="org-left">LEFT JOIN</td>
<td class="org-left">ã™ã‚‹</td>
<td class="org-left">ã§ãã‚‹</td>
<td class="org-left">LEFT JOINãªã®ã§ã€ç›¸æ‰‹ãŒå­˜åœ¨ã—ãªãã¦ã‚‚å…¨éƒ¨ãƒ­ãƒ¼ãƒ‰ã—ã¦ã—ã¾ã†</td>
</tr>

<tr>
<td class="org-left">includes</td>
<td class="org-left">å ´åˆã«ã‚ˆã‚‹</td>
<td class="org-left">ã™ã‚‹</td>
<td class="org-left">ã§ãã‚‹</td>
<td class="org-left">ãŸã ã—ãç†è§£ã—ã¦ãªã„ã¨æŒ™å‹•ãŒã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã§ããªã„</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>preload
<ul class="org-ul">
<li>å¤šå¯¾å¤šã®ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã®å ´åˆ
<ul class="org-ul">
<li><a href="20210725100835-sql.html#ID-8b69b8d4-1612-4dc5-8412-96b431fdd101">SQL</a>ã‚’åˆ†å‰²ã—ã¦å–å¾—ã™ã‚‹ãŸã‚ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ãŒæ—©ããªã‚‹ãŸã‚</li>
</ul></li>
<li>ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³å…ˆã®ãƒ‡ãƒ¼ã‚¿å‚ç…§ãŒã§ããªã„</li>
<li>ãƒ‡ãƒ¼ã‚¿é‡ãŒå¤§ãã„ã¨ã€ãƒ¡ãƒ¢ãƒªã‚’åœ§è¿«ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹</li>
</ul></li>

<li>eager_load
<ul class="org-ul">
<li>1å¯¾1ã‚ã‚‹ã„ã¯Nå¯¾1ã®ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’JOINã™ã‚‹å ´åˆ</li>
<li>JOINå…ˆã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‚ç…§ã—ãŸã„å ´åˆ</li>
</ul></li>

<li>joins
<ul class="org-ul">
<li>ãƒ¡ãƒ¢ãƒªã®ä½¿ç”¨é‡ã‚’å¿…è¦æœ€ä½é™ã«æŠ‘ãˆãŸã„å ´åˆ</li>
<li>JOINã—ãŸå…ˆã®ãƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§ã›ãšã€çµã‚Šè¾¼ã¿çµæœã ã‘ãŒå¿…è¦ãªå ´åˆ</li>
</ul></li>

<li>includes
<ul class="org-ul">
<li>ãªã‚‹ã¹ãä½¿ã‚ãªã„ã»ã†ãŒã„ã„</li>
<li>æ¡ä»¶ã«ã‚ˆã£ã¦preloadã¨eager_loadã‚’æŒ¯ã‚Šåˆ†ã‘ã‚‹</li>
</ul></li>

<li><a href="https://qiita.com/k0kubun/items/80c5a5494f53bb88dc58">ActiveRecordã®joinsã¨preloadã¨includesã¨eager_loadã®é•ã„ - Qiita</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgc6ece73" class="outline-3">
<h3 id="orgc6ece73"><a href="#orgc6ece73">Railsã®<a href="20210926150327-oss.html#ID-bb71747d-8599-4aee-b747-13cb44c05773">OSS</a></a></h3>
<div class="outline-text-3" id="text-orgc6ece73">
<p>
Railsã‚’ã©ã†æ›¸ãã‹ã®å‚è€ƒã«ãªã‚Šãã†ãªãƒªãƒã‚¸ãƒˆãƒªã€‚
</p>

<ul class="org-ul">
<li><a href="https://github.com/gitlabhq/gitlabhq">gitlabhq/gitlabhq: GitLab CE Mirror | Please open new issues in our issue tracker on GitLab.com</a></li>
<li><a href="https://github.com/rubygems/rubygems.org">rubygems/rubygems.org: The Ruby community&rsquo;s gem hosting service.</a></li>
<li><a href="https://github.com/discourse/discourse">discourse/discourse: A platform for community discussion. Free, open, simple.</a></li>
<li><a href="https://github.com/mastodon/mastodon">mastodon/mastodon: Your self-hosted, globally interconnected microblogging community</a></li>
<li><a href="https://github.com/diaspora/diaspora">diaspora/diaspora: A privacy-aware, distributed, open source social network.</a></li>
<li><a href="https://github.com/forem/forem">forem/forem: For empowering community ğŸŒ±</a></li>
</ul>
</div>
</div>
<div id="outline-container-org0b5fe27" class="outline-3">
<h3 id="org0b5fe27"><a href="#org0b5fe27">ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨åå‰ç©ºé–“ã‚’åˆ‡ã‚Šå‡ºã™</a></h3>
<div class="outline-text-3" id="text-org0b5fe27">
<p>
<a href="https://qiita.com/sibakenY/items/973fbe635a7f91ae105c">Railsã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’drawã‚’ä½¿ã£ã¦ã¾ã¨ã‚ã‚‹ - Qiita</a>
</p>

<p>
ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã§ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®DSLã‚’è©•ä¾¡ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œã‚‹ã€‚
ã“ã‚Œã«ã‚ˆã£ã¦ã€ãƒ•ã‚¡ã‚¤ãƒ«ã§åå‰ç©ºé–“ã‚’åˆ†å‰²ã§ãã‚‹ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 12: </span>config/initializers/draw_routes.rb</label><pre class="src src-ruby"><span class="org-keyword">module</span> <span class="org-type">DrawRoute</span>
  <span class="org-type">RoutesNotFound</span> = <span class="org-type">Class</span>.new(<span class="org-type">StandardError</span>)

  <span class="org-keyword">def</span> <span class="org-function-name">draw</span>(routes_name)
    drawn_any = draw_route(routes_name)

    drawn_any || <span class="org-builtin">raise</span>(<span class="org-type">RoutesNotFound</span>, <span class="org-string">"Cannot find </span><span class="org-variable-name">#{routes_name}</span><span class="org-string">"</span>)
  <span class="org-keyword">end</span>

  <span class="org-keyword">def</span> <span class="org-function-name">route_path</span>(routes_name)
    <span class="org-type">Rails</span>.root.join(routes_name)
  <span class="org-keyword">end</span>

  <span class="org-keyword">def</span> <span class="org-function-name">draw_route</span>(routes_name)
    path = route_path(<span class="org-string">"config/routes/</span><span class="org-variable-name">#{routes_name}</span><span class="org-string">.rb"</span>)
    <span class="org-keyword">if</span> <span class="org-type">File</span>.exist?(path)
      instance_eval(<span class="org-type">File</span>.read(path))
      <span class="org-constant">true</span>
    <span class="org-keyword">else</span>
      <span class="org-constant">false</span>
    <span class="org-keyword">end</span>
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>

<span class="org-type">ActionDispatch</span>::<span class="org-type">Routing</span>::<span class="org-type">Mapper</span>.prepend <span class="org-type">DrawRoute</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 13: </span>config/routes/admin.rb</label><pre class="src src-ruby">namespace <span class="org-constant">:admin</span> <span class="org-keyword">do</span>
  resources <span class="org-constant">:users</span>
<span class="org-keyword">end</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 14: </span>routes.rb</label><pre class="src src-ruby"><span class="org-type">Rails</span>.application.routes.draw <span class="org-keyword">do</span>
  draw <span class="org-constant">:admin</span>
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcfa102f" class="outline-3">
<h3 id="orgcfa102f"><a href="#orgcfa102f">æ™‚é–“é–¢ä¿‚</a></h3>
<div class="outline-text-3" id="text-orgcfa102f">
<p>
<a href="https://qiita.com/jnchito/items/cae89ee43c30f5d6fa2c">Rubyã¨Railsã«ãŠã‘ã‚‹Time, Date, DateTime, TimeWithZoneã®é•ã„ - Qiita</a>
</p>
</div>
</div>
<div id="outline-container-org303eed8" class="outline-3">
<h3 id="org303eed8"><a href="#org303eed8">ãƒã‚¹ãƒˆã—ãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³</a></h3>
<div class="outline-text-3" id="text-org303eed8">
<p>
ãƒã‚¹ãƒˆã—ãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯å†…å´ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒã€ç„¡è¦–ã•ã‚Œã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ã€‚
ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’å†åˆ©ç”¨ã™ã‚‹ãŸã‚ã€‚
ãªã®ã§ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’å†åˆ©ç”¨ã—ãªã„ã‚ˆã†ã«æ˜ç¤ºã™ã‚Œã°ã‚ˆã„ã€‚
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span class="org-type">ActiveRecord</span>::<span class="org-type">Base</span>.transaction(<span class="org-constant">joinable:</span> <span class="org-constant">false</span>, <span class="org-constant">requires_new:</span> <span class="org-constant">true</span>) <span class="org-keyword">do</span>
  <span class="org-comment-delimiter"># </span><span class="org-comment">inner code
</span><span class="org-keyword">end</span>
</pre>
</div>

<p>
<a href="https://qiita.com/jnchito/items/930575c18679a5dbe1a0">ã€ç¿»è¨³ã€‘ActiveRecordã«ãŠã‘ã‚‹ã€ãƒã‚¹ãƒˆã—ãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®è½ã¨ã—ç©´ - Qiita</a>
<a href="https://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html">ActiveRecord::Transactions::ClassMethods</a>
</p>
</div>
</div>
<div id="outline-container-org61be74d" class="outline-3">
<h3 id="org61be74d"><a href="#org61be74d">Fakerã§booleanç”Ÿæˆ</a></h3>
<div class="outline-text-3" id="text-org61be74d">
<p>
â†“ä»¥ä¸‹2ã¤ã¯åŒã˜æ„å‘³ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 15: </span>fakerã§</label><pre class="src src-rb">Faker::Boolean.boolean
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 16: </span>sampleã§</label><pre class="src src-ruby">[<span class="org-constant">true</span>, <span class="org-constant">false</span>].sample
</pre>
</div>
</div>
</div>
<div id="outline-container-org81ae1a1" class="outline-3">
<h3 id="org81ae1a1"><a href="#org81ae1a1">ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚«ãƒ©ãƒ ã®å‹ã‚’å¤‰ãˆã‚‹</a></h3>
<div class="outline-text-3" id="text-org81ae1a1">
<p>
usersã®deleted_atã‚«ãƒ©ãƒ ã‚’integerå‹ ã‹ã‚‰ datetimeå‹ã«å¤‰ãˆã‚‹ä¾‹ã€‚
</p>

<ol class="org-ol">
<li>ä¸€æ™‚ã‚«ãƒ©ãƒ ã‚’ä½œã£ã¦ãã“ã§å€¤ã‚’ä½œæˆã™ã‚‹</li>
<li>æ—§ã‚«ãƒ©ãƒ ã‚’å‰Šé™¤ã™ã‚‹</li>
<li>ä¸€æ™‚ã‚«ãƒ©ãƒ ã®åå‰ã‚’å¤‰ãˆã¦æ–°ã‚«ãƒ©ãƒ ã«ã™ã‚‹</li>
</ol>

<p>
<code>ActiveRecord::Base.connection.execute(sql)</code> ã‚’ä½¿ã†ã¨ç”Ÿã®<a href="20210725100835-sql.html#ID-8b69b8d4-1612-4dc5-8412-96b431fdd101">SQL</a>ã‚’å®Ÿè¡Œã§ãã‚‹ã€‚
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span class="org-keyword">def</span> <span class="org-function-name">up</span>
  connection.execute <span class="org-string">'ALTER TABLE users ADD deleted_at_tmp datetime'</span>
  connection.execute <span class="org-string">'UPDATE users SET deleted_at_tmp = FROM_UNIXTIME(deleted_at)'</span>
  connection.execute <span class="org-string">'ALTER TABLE users DROP COLUMN deleted_at'</span>
  connection.execute <span class="org-string">'ALTER TABLE users CHANGE deleted_at_tmp deleted_at datetime'</span>
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org624be56" class="outline-3">
<h3 id="org624be56"><a href="#org624be56">ä¾¿åˆ©ãªãƒ‡ãƒãƒƒã‚¬web-console</a></h3>
<div class="outline-text-3" id="text-org624be56">
<p>
viewå†…ã§ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’è¨­å®šã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç«‹ã¡ä¸Šã’ã‚‹ã“ã¨ãŒã§ãã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚
Railsã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å…¥ã£ã¦ã„ã‚‹ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 18: </span>ä»»æ„ã®view, controllerã«è¿½åŠ ã™ã‚‹</label><pre class="src src-html">&lt;% console %&gt;
</pre>
</div>

<p>
ã‚ã¨ã¯è©²å½“ç®‡æ‰€ã«ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãŒç«‹ã¡ä¸ŠãŒã‚‹ã€‚
å†å®Ÿè¡Œæ€§ãŒãªã„ã®ã§ã€ãƒ†ã‚¹ãƒˆã§ã‚„ã‚‹ã®ãŒä¸€ç•ªã ã¨ã¯æ„Ÿã˜ã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-orga36bb6b" class="outline-3">
<h3 id="orga36bb6b"><a href="#orga36bb6b">update_atã‚’æ›´æ–°ã—ãªã„</a></h3>
<div class="outline-text-3" id="text-orga36bb6b">
<p>
ãƒãƒƒãƒå‡¦ç†ã§ã„ã˜ã£ãŸå ´åˆã¯æ›´æ–°ã™ã‚‹ã¨ã‚ˆããªã„ã“ã¨ãŒã‚ã‚‹ã€‚
</p>

<ul class="org-ul">
<li><a href="https://ohbarye.hatenablog.jp/entry/2016/08/02/213444">æ›´æ–°æ™‚ã« updated_at, created_at ã‚’æ›´æ–°ã—ãªã„ - valid,invalid</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-ruby"><span class="org-comment-delimiter"># </span><span class="org-comment">Active Record &#12524;&#12505;&#12523;
</span><span class="org-type">ActiveRecord</span>::<span class="org-type">Base</span>.record_timestamps = <span class="org-constant">false</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">&#12514;&#12487;&#12523;&#12398;&#12415;
</span><span class="org-type">User</span>.record_timestamps = <span class="org-constant">false</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">&#12452;&#12531;&#12473;&#12479;&#12531;&#12473;&#12398;&#12415;
</span>user.record_timestamps = <span class="org-constant">false</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc69a594" class="outline-3">
<h3 id="orgc69a594"><a href="#orgc69a594">save(validate: false)</a></h3>
<div class="outline-text-3" id="text-orgc69a594">
<p>
ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒä¸è¦ãªã¨ãã€ <code>user.save!(validate: false)</code> ã¨ã™ã‚‹ã¨ç„¡åŠ¹åŒ–ã§ãã‚‹ã€‚
ãƒ‡ãƒ¼ã‚¿ã‚’ä¸æ•´åˆã‚’ç›´ã—ãŸã„ã‘ã©ã»ã‹ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‹ã‹ã‚‹ã€ã‚ˆã†ãªã¨ãã«ä½¿ã†ã€‚
</p>

<p>
ã‚ã‚‹ã„ã¯ <code>assign_attribute</code> ã§ã‚‚ã‚ˆã„ã€‚
</p>
</div>
</div>
<div id="outline-container-org7ab3271" class="outline-3">
<h3 id="org7ab3271"><a href="#org7ab3271">presence: trueãªã®ã«nilãŒã‚ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ¤œçŸ¥ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org7ab3271">
<p>
ãƒ¢ãƒ‡ãƒ«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‹ã‹ã£ã¦ã„ã¦ã‚‚ã€æ—¢å­˜ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯nilã‚’å«ã‚€å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚
ãƒ¢ãƒ‡ãƒ«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯å…¥å‡ºåŠ›ã®ã¿ç›£è¦–ã™ã‚‹ã€‚ã ã‹ã‚‰æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã«æ®‹ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚
ã“ã®å ´åˆã€ç·¨é›†ã§ããªãã¦ä¸ä¾¿ã€‚æ¤œçŸ¥ã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚‚åˆ¶ç´„ã‚’ã‹ã‘ã‚‹ã¨å®‰å…¨ã«ãªã‚‹ã€‚DBãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã«ã‚‚å…¥ã£ã¦ãªã„ã“ã¨ã‚’ä¿è¨¼ã§ãã‚‹ã€‚
</p>

<p>
ç›´ã«ãƒ†ãƒ¼ãƒ–ãƒ«ã®åˆ¶ç´„ã‚’è¾¿ã‚‹æ–¹æ³•ãŒã‚ã‹ã‚‰ãªã„ã®ã§ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ¢ç´¢ã™ã‚‹æ„Ÿã˜ã«ãªã£ãŸã€‚ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒãŸãã•ã‚“ã‚ã‚‹ç’°å¢ƒã§å®Ÿè¡Œã™ã‚‹ã¨æ¤œçŸ¥ã§ãã‚‹ã€‚å…¨éƒ¨è¾¿ã‚‹ã®ã§ã‚¯ã‚½é‡ã„ã€‚
</p>
<div class="org-src-container">
<pre class="src src-ruby">msgs = {}

<span class="org-type">Rails</span>.application.eager_load!
<span class="org-type">ApplicationRecord</span>.subclasses.each <span class="org-keyword">do</span> |model|
  presence_validates = model.validators.select { |v| v.class.to_s.include?(<span class="org-string">'ActiveRecord::Validations::PresenceValidator'</span>) }
  presence_validates.each <span class="org-keyword">do</span> |presence_validate|
    model.all.find_each <span class="org-keyword">do</span> |record|
      msgs[<span class="org-string">"</span><span class="org-variable-name">#{record.class}</span><span class="org-string"> </span><span class="org-variable-name">#{presence_validate.attributes.first}</span><span class="org-string">"</span>] = <span class="org-string">'&#10060; presence: true&#12354;&#12427;&#12398;&#12395;nil&#12524;&#12467;&#12540;&#12489;&#12364;&#12354;&#12427;&gt;&lt;'</span> <span class="org-keyword">unless</span> record.send(presence_validate.attributes.first)
    <span class="org-keyword">end</span>
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>

pp msgs.sort <span class="org-comment-delimiter">#  </span><span class="org-comment">[["User name", "&#10060; presence: true&#12354;&#12427;&#12398;&#12395;nil&#12524;&#12467;&#12540;&#12489;&#12364;&#12354;&#12427;&gt;&lt;"]]</span>
</pre>
</div>

<p>
ã¾ãšnilã‚’ãªãã™ã€‚ãã‚Œã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-orgb6b1de7" class="outline-3">
<h3 id="orgb6b1de7"><a href="#orgb6b1de7">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã„ã†ã¨ãã®æ­£ç¢ºãªã‚¹ã‚³ãƒ¼ãƒ—</a></h3>
<div class="outline-text-3" id="text-orgb6b1de7">
<p>
APIã‚µãƒ¼ãƒã¨ã—ã¦ã®åˆ©ç”¨ã€ãƒãƒƒã‚¯ã¨ãƒ•ãƒ­ãƒ³ãƒˆã®åˆ†å‰²ãŒä¸»æµã«ãªã£ã¦ã„ã‚‹ã€‚
æ¡ç”¨è€…ãŒRailsã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºè€…ã‚’æ¢ã—ã¦ã„ã‚‹ã€ã¨ã„ã†ã¨ãã¯APIé–‹ç™ºçµŒé¨“ãŒã‚ã‚‹äººæã‚’æ¢ã—ã¦ã„ã‚‹ã¨ã„ãˆã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-orgffd7bf3" class="outline-3">
<h3 id="orgffd7bf3"><a href="#orgffd7bf3">ãƒ†ã‚¹ãƒˆã«ã‚ˆã‚‹ã‚¹ãƒãƒ¼ãƒˆãªç”»åƒç¢ºèª</a></h3>
<div class="outline-text-3" id="text-orgffd7bf3">
<p>
system specã§ã‚¹ã‚¯ã‚·ãƒ§ã‚’ã¨ã£ã¦ç¢ºèªã™ã‚‹ã€‚
ã‚ã–ã‚ã–ç”¨æ„ã—ã¦ç¢ºèªã—ãªã„ã€‚
</p>

<p>
TDDã‚’å¾¹åº•ã—ã€ä¸€åˆ‡ãƒ–ãƒ©ã‚¦ã‚¶ç¢ºèªã›ãšã«ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‚’é–‹ç™ºã—ãŸã€ã¨ã„ã†å‰äººã‚‚ã„ã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-org374e1b2" class="outline-3">
<h3 id="org374e1b2"><a href="#org374e1b2">ã‚ªãƒ¼ãƒˆãƒ­ãƒ¼ãƒ‰ã™ã‚‹gem: zeitwerk</a></h3>
<div class="outline-text-3" id="text-org374e1b2">
<p>
zeitwerkã¯ã‚ªãƒ¼ãƒˆãƒ­ãƒ¼ãƒ‰ã™ã‚‹gemã€‚Rails 6ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹ã€‚
Railsã§requireã—ãªãã¦ã„ã„ã®ã¯ã“ã‚Œã‚’ä½¿ã£ã¦ã„ã‚‹ã‹ã‚‰ã€‚
<a href="https://github.com/fxn/zeitwerk">fxn/zeitwerk: Efficient and thread-safe code loader for Ruby</a>
</p>
</div>
</div>
<div id="outline-container-org0f365d2" class="outline-3">
<h3 id="org0f365d2"><a href="#org0f365d2">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¹ã‚³ãƒ¼ãƒ—ã‚’ç„¡è¦–ã§ãã‚‹reorder</a></h3>
<div class="outline-text-3" id="text-org0f365d2">
<p>
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¹ã‚³ãƒ¼ãƒ—ã‚’ç„¡è¦–ã§ãã‚‹ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 19: </span>updated_atã‚’ã‚½ãƒ¼ãƒˆã«ä½¿ã†</label><pre class="src src-ruby"><span class="org-type">User</span>.order(<span class="org-constant">:id</span>).reorder(<span class="org-constant">:updated_at</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc4082e7" class="outline-3">
<h3 id="orgc4082e7"><a href="#orgc4082e7">é–‹ç™ºç”¨ãƒ‡ãƒ¼ã‚¿ã®ç”¨æ„</a></h3>
<div class="outline-text-3" id="text-orgc4082e7">
<p>
é–‹ç™ºç”¨ãƒ‡ãƒ¼ã‚¿ã«ã¯ã„ãã¤ã‹ã®æ–¹æ³•ãŒã‚ã‚‹ã€‚
</p>

<ul class="org-ul">
<li>seedãƒ‡ãƒ¼ã‚¿ã§ç”¨æ„ã™ã‚‹ã€‚æ¯å›å¿…è¦ãªã¨ãã«resetã—ã¦é–‹ç™ºã™ã‚‹
<ul class="org-ul">
<li>ã‚¯ãƒªãƒ¼ãƒ³ãªç’°å¢ƒã§å†ç¾æ€§ãŒé«˜ã„é–‹ç™ºã‚’è¡Œãˆã‚‹ã€‚</li>
<li>æ—©ã„</li>
</ul></li>

<li>æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã«è¿‘ã„ãƒ‡ãƒ¼ã‚¿ã§è¡Œã†
<ul class="org-ul">
<li>ãƒ‡ã‚¶ã‚¤ãƒ³ã‚„æ€§èƒ½ã®å•é¡Œã«æ°—ã¥ãã‚„ã™ã„</li>
<li>ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãŒã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã‚„ã™ã„</li>
<li>ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ãŒæ¥½</li>
<li>æ•´åˆæ€§ã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒå¿…è¦</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org004775e" class="outline-3">
<h3 id="org004775e"><a href="#org004775e">ALTER TABLEã¯é‡ã„</a></h3>
<div class="outline-text-3" id="text-org004775e">
<p>
ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚³ãƒ”ãƒ¼ã‚’ä½œã‚‹ã®ã§é‡ã„ã€‚
bulk: trueã‚’ã¤ã‘ã‚‹ã¨ALTER TABLEã‚’ã¾ã¨ã‚ã‚‹ã®ã§é«˜é€Ÿã«ãªã‚‹ã€‚
</p>
<div class="org-src-container">
<pre class="src src-ruby"><span class="org-keyword">def</span> <span class="org-function-name">up</span>
  change_table <span class="org-constant">:legal_engine_forms</span>, <span class="org-constant">bulk:</span> <span class="org-constant">true</span> <span class="org-keyword">do</span> |t|
    ...
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9895c39" class="outline-3">
<h3 id="org9895c39"><a href="#org9895c39">ãƒ†ãƒ¼ãƒ–ãƒ«åã«ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ã‚’è¨­å®šã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org9895c39">
<p>
ç‰¹å®šã®æ©Ÿèƒ½ã«å¯¾ã—ã¦ã€é–¢ä¿‚ã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¤‡æ•°ã¤ãã‚‹ã¨ãã€ãƒ—ãƒ¬ãƒ•ã‚£ã‚¯ã‚¹ã®ã‚ˆã†ãªå½¢ã§ãƒ¢ãƒ‡ãƒ«åã‚„ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’æ±ºã‚ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚
admin_userã€admin_pageã€admin_permissionã¨ã‹ã€‚
ã“ã†ã™ã‚‹ã“ã¨ã®å•é¡Œç‚¹: è¡çªã‚’é¿ã‘ã‚‹ãŸã‚ã«modelåã¨ãƒ†ãƒ¼ãƒ–ãƒ«åãŒé•·ããªã‚‹ã€‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚‚è¦‹ã«ãããªã‚‹ã€‚ä¸€èªã ã¨ã¾ã ã„ã„ã®ã ãŒã€è¤‡æ•°åã«ãªã‚‹ã¨ã¤ã‚‰ããªã‚‹ã€‚
</p>

<p>
è§£æ±ºã®ãŸã‚ã«ã¯ã€moduleã‚’å®šç¾©ã—ã€å†…éƒ¨ã§table_name_prefixã‚’è¨­å®šã™ã‚‹ã¨ã„ã„ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 20: </span>modelã«ã¦</label><pre class="src src-ruby"><span class="org-keyword">module</span> <span class="org-type">Admin</span>
  <span class="org-keyword">def</span> <span class="org-keyword">self</span>.<span class="org-function-name">table_name_prefix</span>
    <span class="org-string">'admin_'</span>
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>

<span class="org-keyword">module</span> <span class="org-type">Admin</span>
  <span class="org-keyword">class</span> <span class="org-type">User</span> &lt; <span class="org-type">ApplicationRecord</span>
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>
</pre>
</div>

<p>
ã“ã†ã™ã‚‹ã¨ãƒ¢ãƒ‡ãƒ«åã¯Admin::Userã§ã€ãƒ†ãƒ¼ãƒ–ãƒ«åã¯admin_usersã«ãªã‚Šã‚ã‹ã‚Šã‚„ã™ã„ã€‚
</p>
</div>
</div>
<div id="outline-container-org71dd81b" class="outline-3">
<h3 id="org71dd81b"><a href="#org71dd81b">Railsç’°å¢ƒã§ãƒãƒƒãƒå‡¦ç†ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org71dd81b">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 21: </span>Railsç’°å¢ƒã§ã®ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè¡Œã§ãã‚‹</label><pre class="src src-ruby">rails runner <span class="org-string">"User.first"</span>
rails r <span class="org-string">"User.first"</span>
</pre>
</div>

<p>
ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹åŒ–ã—ãŸã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ãã«ä½¿ãˆã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-orgccac34d" class="outline-3">
<h3 id="orgccac34d"><a href="#orgccac34d">routesã®åˆ¶ç´„</a></h3>
<div class="outline-text-3" id="text-orgccac34d">
<div class="org-src-container">
<pre class="src src-ruby">constraints(-&gt; (req) { req.env[<span class="org-string">"HTTP_USER_AGENT"</span>] =~ <span class="org-string">/iPhone/</span> }) <span class="org-keyword">do</span>
  resources <span class="org-constant">:iphones</span>
<span class="org-keyword">end</span>
</pre>
</div>

<p>
<a href="https://api.rubyonrails.org/v6.0.2/classes/ActionDispatch/Routing/Mapper/Scoping.html#method-i-constraints-label-Dynamic+request+matching">ActionDispatch::Routing::Mapper::Scoping</a>
</p>
</div>
</div>
<div id="outline-container-orga5a5453" class="outline-3">
<h3 id="orga5a5453"><a href="#orga5a5453">å¤§é‡ã®routeså¤‰æ›´ã‚’æ¥½ã«ç¢ºèªã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-orga5a5453">
<p>
redirectè¨­å®šã‚„ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã§routesã‚’å¤§é‡ã«å¤‰æ›´ã—ã¦ã€æŒ™å‹•ã®å¤‰æ›´ã‚’è¿½ã„ãŸã„å ´åˆã€‚
rails routesã®çµæœã®diffã‚’å–ã‚Œã°ã€æ¥½ã«ç¢ºèªã§ãã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-org431d08d" class="outline-3">
<h3 id="org431d08d"><a href="#org431d08d">create_or_find_by</a></h3>
<div class="outline-text-3" id="text-org431d08d">
<p>
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ã‚’ä½¿ã£ã¦ä½œæˆã€ã§ããªã‘ã‚Œã°åˆã‚ã®1ä»¶ã‚’å–å¾—ã™ã‚‹ã€‚
find_or_create_byã§ã¯ä½œæˆã•ã‚Œã‚‹ã¾ã§ã«åˆ¥ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚ˆã£ã¦ä½œæˆã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã£ãŸã®ã§ã€ãã®å•é¡Œã‚’è§£æ±ºã—ãŸå‡¦ç†ã€‚
<code>create_or_find_by!</code> ã¯ã‚¨ãƒ©ãƒ¼ã®æ™‚ã«ä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 22: </span>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„ã‚’ä½¿ã£ã¦ä½œæˆã€ã§ããªã‘ã‚Œã°åˆã‚ã®1ä»¶ã‚’å–å¾—</label><pre class="src src-ruby"><span class="org-type">User</span>.create_or_find_by(<span class="org-constant">name:</span> <span class="org-string">'aaa'</span>)
</pre>
</div>

<p>
<a href="https://railsdoc.com/page/create_or_find_by">create_or_find_by | Railsãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>
</p>
</div>
</div>
<div id="outline-container-org6acbe63" class="outline-3">
<h3 id="org6acbe63"><a href="#org6acbe63">ä½¿ã‚ã‚Œã¦ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org6acbe63">
<p>
assetsã¯ç›¸å¯¾ãƒ‘ã‚¹ãŒåˆ©ç”¨ã•ã‚Œãªã„ã®ã§çµ¶å¯¾ãƒ‘ã‚¹ã§æ¤œç´¢ã—ã¦ãƒ’ãƒƒãƒˆã—ãªã‘ã‚Œã°æœªä½¿ç”¨ã¨åˆ¤æ–­ã§ãã‚‹ã€ã¨ã®ã“ã¨ã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 23: </span>æ¤œæŸ»ã‚¿ã‚¹ã‚¯ã®ä¾‹</label><pre class="src src-ruby">namespace <span class="org-constant">:assets</span> <span class="org-keyword">do</span>
  desc <span class="org-string">'prune needless image file'</span>
  task <span class="org-string">'prune:images'</span> =&gt; <span class="org-constant">:environment</span> <span class="org-keyword">do</span>
    base = <span class="org-type">Rails</span>.root.join(<span class="org-string">'app/assets/images/'</span>)

    <span class="org-type">Dir</span>[<span class="org-type">Rails</span>.root.join(<span class="org-string">'app/assets/images/**/*.{jpg,jpeg,gif,png,svg}'</span>)].each <span class="org-keyword">do</span> |path|
      target_path = path.to_s.gsub(<span class="org-string">/</span><span class="org-variable-name">#{base}</span><span class="org-string">/</span>, <span class="org-string">''</span>)
      <span class="org-builtin">puts</span> <span class="org-string">"execute: git grep '</span><span class="org-variable-name">#{target_path}</span><span class="org-string">'"</span>
      res = <span class="org-string">`git grep '</span><span class="org-variable-name">#{target_path}</span><span class="org-string">'`</span>

      <span class="org-keyword">if</span> res.empty?
        <span class="org-builtin">puts</span> <span class="org-string">"execute: rm </span><span class="org-variable-name">#{path}</span><span class="org-string">"</span>
        <span class="org-type">FileUtils</span>.rm path
        <span class="org-builtin">puts</span> <span class="org-string">'=&gt; removed'</span>
      <span class="org-keyword">else</span>
        <span class="org-builtin">puts</span> <span class="org-string">'=&gt; used somewhere'</span>
      <span class="org-keyword">end</span>

      <span class="org-builtin">puts</span>
    <span class="org-keyword">end</span>
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org18d014b" class="outline-3">
<h3 id="org18d014b"><a href="#org18d014b"><a href="20210509095513-ruby.html#ID-cfd092c4-1bb2-43d3-88b1-9f647809e546">Ruby</a>ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ</a></h3>
<div class="outline-text-3" id="text-org18d014b">
<p>
è¶…å¼·ã„äººãŒè¨€ã£ã¦ã„ãŸãƒ¡ãƒ¢ã€‚
ã‚³ãƒãƒ³ãƒ‰ã‚’çµ„ã¿åˆã‚ã›ã¦ä¸€æ°—ã«ç½®æ›ã—ã¦æ¤œè¨ã—ã¦ã„ãã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 24: </span>2.6.5 -&gt; 2.7.1ã«å…¨ä½“ã‚’ç½®æ›ã™ã‚‹</label><pre class="src src-shell">git grep -l <span class="org-string">'2\.6\.5'</span> | xargs sed -i <span class="org-string">'s/2\.6\.5/2.7.1/g'</span>
</pre>
</div>
<p>
vendor/bundle ã‚’å‰Šé™¤ã—ã¦ã€bundle installã€‚
ãƒã‚¤ãƒŠãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å¤‰æ›´ã—ãŸå ´åˆã¯ .rubocop.yml ã® RUBY_VERSION ã‚’ä¿®æ­£(parser gemã®æŒ‡å®š)ã€‚
</p>
</div>
</div>
<div id="outline-container-org8042446" class="outline-3">
<h3 id="org8042446"><a href="#org8042446">æ–°è¦ä½œæˆæ™‚ã¯formè¡¨ç¤ºã—ãªã„</a></h3>
<div class="outline-text-3" id="text-org8042446">
<p>
formã‚’å…±é€šåŒ–ã—ã¦ã„ã‚‹ã‚ˆã†ãªã¨ãã€‚
ã“ã®ã‚«ãƒ©ãƒ ã¯editæ™‚ã®ã¿å‡ºã—ãŸã„ã€ã¨ã„ã†ã‚ˆã†ãªã“ã¨ãŒã‚ã‚‹ã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 25: </span>newæ™‚persistã•ã‚Œã¦ãªã„ã®ã§è¡¨ç¤ºã•ã‚Œãªã„</label><pre class="src src-ruby">form_for <span class="org-keyword">do</span> |f|
  f.number_field <span class="org-constant">:position</span> <span class="org-keyword">if</span> <span class="org-variable-name">@content_category</span>.persisted?
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7b40d9b" class="outline-3">
<h3 id="org7b40d9b"><a href="#org7b40d9b">ä¸€éƒ¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã ã‘validation</a></h3>
<div class="outline-text-3" id="text-org7b40d9b">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 26: </span>onã§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã§ãã‚‹ã€‚</label><pre class="src src-ruby">validates <span class="org-constant">:user_id</span>, <span class="org-constant">presence:</span> <span class="org-constant">true</span>, <span class="org-constant">:on</span> =&gt; <span class="org-constant">:create</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org03c2c93" class="outline-3">
<h3 id="org03c2c93"><a href="#org03c2c93">ä¾¿åˆ©ãªæ—¥ä»˜æ“ä½œ</a></h3>
<div class="outline-text-3" id="text-org03c2c93">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 27: </span>Time.zone</label><pre class="src src-ruby"><span class="org-type">Time</span>.zone.yesterday
<span class="org-type">Time</span>.zone.today.ago(7.days)
</pre>
</div>

<p>
<a href="https://qiita.com/mmmm/items/efda48f1ac0267c95c29">Railsã§ã®æ—¥ä»˜æ“ä½œã§ã‚ˆãä½¿ã†ã‚‚ã®ã¾ã¨ã‚ - Qiita</a>
</p>
</div>
</div>
<div id="outline-container-orgb748a5b" class="outline-3">
<h3 id="orgb748a5b"><a href="#orgb748a5b">å®‰å…¨ã«é–¢é€£ã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-orgb748a5b">
<p>
Blogã«user_idã‚’å¾Œã‹ã‚‰è¿½åŠ ã—ãŸã„ã€ã¿ãŸã„ãªã¨ãã€‚User -&lt; Blogã€‚
æœ€åˆã«nullableã§å¤–éƒ¨ã‚­ãƒ¼ã‚’ä½œæˆã™ã‚‹ã€‚
</p>

<p>
æ¬¡ã«ã€æ–°è¦ä½œæˆæ™‚ã«modelã§validationã‚’ã‹ã‘ã‚‹ã€‚
ã™ã‚‹ã¨æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å¤–éƒ¨ã‚­ãƒ¼ã¯nullã€æ–°ã—ãã§ãã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯å¤–éƒ¨ã‚­ãƒ¼ã‚ã‚Šã¨ã„ã†çŠ¶æ…‹ã«ãªã‚‹ã€‚
å¤–éƒ¨ã‚­ãƒ¼ãªã—ãŒå¢—ãˆã‚‹ã“ã¨ã¯ãªã„ã€‚ç§»è¡Œã‚’ã™ã‚‹ã€‚
nullã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒã‚¼ãƒ­ã«ãªã£ã¦ã‹ã‚‰å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚’ã¤ã‘ã¦é–¢é€£ã‚«ãƒ©ãƒ è¿½åŠ å®Œäº†ã€‚
</p>
</div>
</div>
<div id="outline-container-org811ca1e" class="outline-3">
<h3 id="org811ca1e"><a href="#org811ca1e">é–¢é€£ã‚«ãƒ©ãƒ ã‚’å®‰å…¨ã«å¤‰æ›´ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org811ca1e">
<p>
ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒã™ã§ã«å…¥ã£ã¦ã„ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã®é–¢é€£ã‚’å¤‰æ›´ã™ã‚‹å ´åˆã€‚
ãŸã¨ãˆã°ã€blogs &gt;- somethings &gt;- users ã‚’ blogs &gt;- users ã¨ã„ã†ã‚ˆã†ãªã€‚somethingsãƒ†ãƒ¼ãƒ–ãƒ«ã¯ä½•ã‚‚ã—ã¦ãªã„ã®ã§å‰Šé™¤ã—ãŸã„ã€ã¨ã™ã‚‹ã€‚
ä½•ã‚‚è€ƒãˆãšã«ã‚„ã‚‹ã¨ã€ä¸€æ°—ã«ã™ã¹ã¦ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ã«ãªã‚ŠãŒã¡ã€‚
</p>

<p>
æ‚ªã„ä¾‹ã‚’ç¤ºã™ã€‚
</p>
<ol class="org-ol">
<li><p>
æœ€åˆã«é–¢é€£ã‚«ãƒ©ãƒ ã‚’å¤‰æ›´ã™ã‚‹ã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 28: </span>modelãƒ•ã‚¡ã‚¤ãƒ«ã§é–¢é€£å¤‰æ›´</label><pre class="src src-ruby">belongs_to <span class="org-constant">:user</span> <span class="org-comment-delimiter"># </span><span class="org-comment">&#26087; belongs_to :something</span>
</pre>
</div></li>
<li>æ—§é–¢é€£ã‚’ä½¿ã£ã¦ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã‚’ã™ã¹ã¦å¤‰æ›´ã™ã‚‹ã€‚MVCã™ã¹ã¦ã€‚</li>
<li>æ–°ã—ã„é–¢é€£ã‚«ãƒ©ãƒ ã¯ç©ºã§ã€æ—§ãƒ‡ãƒ¼ã‚¿ã‚’ç§»è¡Œã—ãªã„ã¨ã„ã‘ãªã„ã€‚ç§»è¡Œã¯â†‘ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¨åŒæ™‚ã«ã—ãªã„ã¨ä¸æ•´åˆã«ãªã‚‹ã€‚ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ç§»è¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆã®é–“ã®å¤‰æ›´ã¯ç„¡è¦–ã•ã‚Œã‚‹ã‹ã‚‰ã€‚</li>
<li>1~3ã‚’ã¾ã¨ã‚ã¦ä¸€æ°—ã«ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹</li>
</ol>

<p>
ã¨ã„ã†ã“ã¨ã§ã€å¤§é‡ãªè¤‡æ•°å±¤ã®å¤‰æ›´ã‚’ã¶ã£ã¤ã‘æœ¬ç•ªã§ã—ãªã„ã¨ã„ã‘ãªããªã‚‹ã€‚é€”ä¸­ã§å«Œã«ãªã‚‹ã ã‚ã†ã—ã€é‹ãŒæ‚ªã‘ã‚Œã°ãƒŸã‚¹ã£ã¦å¤§å¤‰ãªã“ã¨ã«ãªã‚‹ã€‚
</p>

<p>
ã§ã¯ã©ã†ã™ã‚‹ã‹ã€‚æ ¹æœ¬çš„ãªã‚¢ã‚¤ãƒ‡ã‚¢ã¯ã€2ã¤ã®é–¢é€£ã‚’åŒæ™‚ã«ä¿æŒã—ã¦ãŠãã“ã¨ã ã€‚
åŒæ™‚ã«æŒã£ã¦ãŠã‘ã°ã€å¤§ä¸ˆå¤«ãªã“ã¨ã‚’ç¢ºèªã—ã¦ã‹ã‚‰é–¢é€£ã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§ã„ã„ã€‚ãã†ã‚„ã£ã¦é…å»¶ã•ã›ã‚‹ã“ã¨ã§ã€ä¸€æ°—ã«ã„ã‚ã„ã‚ãªå¤‰æ›´ã‚’ã—ãªãã¦ã‚ˆããªã‚‹ã€‚
</p>

<p>
å…·ä½“çš„ã«ã©ã†ã‚„ã‚‹ã‹ã€‚è‰¯ã„ä¾‹ã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 29: </span>modelã®before_saveã§ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã‚³ãƒ”ãƒ¼</label><pre class="src src-ruby"><span class="org-keyword">class</span> <span class="org-type">Blog</span> &lt; <span class="org-type">ApplicationRecord</span>
  before_save <span class="org-keyword">do</span>
    <span class="org-keyword">self</span>.user_id ||= something.user_id
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>
</pre>
</div>

<p>
ã¨ã—ã¦ãŠãã¨ã€ä¿å­˜æ™‚ã«blog.user_idã¨blog.something.user_idã®ä¸¡æ–¹ã«é–¢é€£ãŒã‚³ãƒ”ãƒ¼ã•ã‚Œã‚‹ã€‚somethingsã‚’çµŒç”±ã—ãªã„ã§ã‚ˆããªã‚‹ã€‚
</p>

<p>
æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦ã‚‚å‡¦ç†ã‚’è¿½åŠ ã—ã¦ãŠãã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 30: </span>modelã«ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œã£ã¦ãŠã</label><pre class="src src-ruby"><span class="org-keyword">class</span> <span class="org-type">User</span> &lt; <span class="org-type">ApplicationRecord</span>
  <span class="org-keyword">def</span> <span class="org-function-name">migrate</span>
    <span class="org-keyword">self</span>.user_id ||= something.user_id
    save!
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>
</pre>
</div>
<p>
ãã—ã¦ã€å…¨Userã§migrateã‚’å®Ÿè¡Œã™ã‚Œã°æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã«ã‚‚æ–°ã—ã„ã‚«ãƒ©ãƒ ãŒå…¥ã‚‹ã€‚
</p>

<p>
æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¨æ–°ã—ãä½œæˆã•ã‚Œã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ãŠã•ãˆãŸã®ã§ã€æ–°æ—§2ã¤ã®é–¢é€£ã‚«ãƒ©ãƒ ã¯å®Œå…¨ã«åŒç­‰ã«ãªã‚‹ã€‚
ã“ã“ã¾ã§ã§ãƒãƒ¼ã‚¸ã€ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã€‚
å•é¡Œãªã„ã“ã¨ã‚’ç¢ºèªã—ãŸã‚ã¨ã§ã€æ–°æ—§ã‚«ãƒ©ãƒ ãŒä½¿ãˆã‚‹çŠ¶æ…‹ã‚’æ´»ã‹ã—ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã®å¤‰æ›´â€¦å®Ÿéš›ã®é–¢é€£ã®å¤‰æ›´ã‚’ã‚„ã‚‹(ä¸€ç•ªã®ç›®çš„ã®ç®‡æ‰€)ã€‚
ã“ã“ã¾ã§ã§ãƒãƒ¼ã‚¸ã€ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã€‚
</p>

<p>
ãã®å¾Œã€ç§»è¡Œå‡¦ç†ã¨ã‚«ãƒ©ãƒ ã‚’å‰Šé™¤ã—ã¦ç‰‡ä»˜ã‘ã‚Œã°å®Œäº†ã€‚(ã‚ã‚‹ã„ã¯ç§»è¡Œå‡¦ç†ã¯å‰ã®æ™‚ç‚¹ã§æ¶ˆã™)
é–¢é€£ã‚«ãƒ©ãƒ ã ã‘ã§ãªãã€ä½•ã‹ã‚«ãƒ©ãƒ ã‚’ç§»ã™ã¨ãã«ã¯ã™ã¹ã¦åŒæ§˜ã«ã§ãã‚‹ã€‚
</p>

<p>
å®Ÿéš›ã®ã‚¿ã‚¹ã‚¯ã§ã¯ã€migrationå‡¦ç†ã‚’ã™ã‚‹ç®‡æ‰€ã¯è¤‡æ•°ã«ãªã‚‹ã®ã§å‰ã‚‚ã£ã¦èª¿æŸ»ãŒå¿…è¦ã€‚
</p>
</div>
</div>
<div id="outline-container-orgcf5f324" class="outline-3">
<h3 id="orgcf5f324"><a href="#orgcf5f324">ã‚«ãƒ©ãƒ åã‚’å®‰å…¨ã«å¤‰æ›´ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-orgcf5f324">
<p>
ã‚«ãƒ©ãƒ åå¤‰æ›´ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã®å¤‰æ›´ã‚’åˆ†ã‘ã€å¤‰æ›´ç¯„å›²ã‚’ç‹­ã‚ã‚‹ã€‚
alias_attributeã‚’è¿½åŠ ã™ã‚‹ã€‚ã™ã‚‹ã¨ã€æ–°ã—ã„ã‚«ãƒ©ãƒ åã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚
ä¾å­˜ã—ã¦ã„ã‚‹ã»ã‹ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å¤‰æ›´ã‚’ã™ã‚‹(new_user_idã«æ›¸ãæ›ãˆã‚‹)ã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 31: </span>modelãƒ•ã‚¡ã‚¤ãƒ«ã«ã¦ã€è¿½åŠ </label><pre class="src src-ruby">alias_attribute <span class="org-constant">:new_user_id</span>, <span class="org-constant">:typo_user_id</span>
</pre>
</div>

<p>
ãã‚Œã‚‰ã‚’æ›¸ãæ›ãˆãŸã‚‰ãƒãƒ¼ã‚¸ã€ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã€‚
ãã®å¾Œã€ã‚«ãƒ©ãƒ åã‚’æ›¸ãæ›ãˆã‚‹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ã€‚ä½¿ã£ã¦ã„ã‚‹ç®‡æ‰€ã¯ãªã„ã®ã§å®‰å…¨ã«å¤‰æ›´ã§ãã‚‹ã€‚
ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã€alias_attributeã‚’å‰Šé™¤ã™ã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-org8a51545" class="outline-3">
<h3 id="org8a51545"><a href="#org8a51545">ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å®‰å…¨ã«å¤‰æ›´ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org8a51545">
<p>
æœ€åˆã«model ã‚¯ãƒ©ã‚¹åã‚’å¤‰æ›´ã—ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®å‚ç…§å…ˆã«å¤‰æ›´å‰ã®ã‚‚ã®ã‚’è¨­å®šã™ã‚‹ã€‚
</p>
<div class="org-src-container">
<pre class="src src-ruby"><span class="org-keyword">class</span> <span class="org-type">Blog_After</span> &lt; <span class="org-type">ApplicationRecord</span>
  <span class="org-keyword">self</span>.table_name = <span class="org-constant">:blog_before</span>
<span class="org-keyword">end</span>
</pre>
</div>
<p>
ã™ã‚‹ã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã ã‘ã®å¤‰æ›´ã§ã€DBã®å¤‰æ›´ã¯ãªã„çŠ¶æ…‹ã§å‹•ä½œä¸Šã®å¤‰æ›´ã¯ãªããªã‚‹ã€‚
æ¬¡ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã€ã»ã‹ã®ä¾å­˜ã—ã¦ã„ã‚‹ç®‡æ‰€ã‚’ä¿®æ­£ã™ã‚‹ã€‚
ã“ã“ã¾ã§1ã¤ã®PRã«ã™ã‚‹ã€‚
</p>

<p>
ãƒ†ã‚¹ãƒˆãŒé€šã£ãŸã‚Šãƒªãƒªãƒ¼ã‚¹ã§ããŸã‚‰ã€ãƒ†ãƒ¼ãƒ–ãƒ«åå¤‰æ›´ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã€modelã§ã®table_nameè¨­å®šã‚’å‰Šé™¤ã™ã‚‹PRã‚’ã¤ãã‚‹ã€‚
å®‰å…¨ã«å¤‰æ›´ãŒå®Œäº†ã™ã‚‹ã€‚
ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¤‰æ›´ã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å¤‰æ›´ã‚’åŒæ™‚ã«ã‚„ã‚‰ãªã„ã¨å®‰å…¨ã ã—åˆ†å‰²ã§ãã¦ã™ã£ãã‚Šã™ã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-org503d0db" class="outline-3">
<h3 id="org503d0db"><a href="#org503d0db">modelã®ãƒ­ã‚°ã‚’ä¿æŒã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org503d0db">
<p>
<a href="https://github.com/paper-trail-gem/paper_trail">paper-trail-gem/paper_trail: Track changes to your rails models</a>
å¤‰æ›´ã‚„å·®åˆ†ã€å¤‰æ›´æ™‚ã®ä½•ã‚‰ã‹ã®æƒ…å ±(ã¤ã¾ã‚Šã€ä½œæ¥­è€…ã¨ã‹)ã‚’ä¿å­˜ã€é–²è¦§ã§ãã‚‹ã€‚
</p>

<p>
<a href="https://github.com/ankit1910/paper_trail-globalid">ankit1910/paper_trail-globalid: An extension to paper_trail, using this you can fetch actual object who was responsible for this change</a>
paper_trailã®æ‹¡å¼µã€‚å¤‰æ›´ã—ãŸã‹å–å¾—ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-orgcae80e3" class="outline-3">
<h3 id="orgcae80e3"><a href="#orgcae80e3">ã‚µãƒ­ã‚²ãƒ¼ãƒˆã‚­ãƒ¼</a></h3>
<div class="outline-text-3" id="text-orgcae80e3">
<p>
Railsã§ã„ã†ã¨ã“ã‚ã® <code>id</code> ã®ã“ã¨ã€‚Rails5 ã‹ã‚‰ã¯bigintã§è¨­å®šã•ã‚Œã¦ã„ã‚‹ã€‚
ä¸»ã‚­ãƒ¼ã¨ã—ã¦ä½¿ã†äººå·¥çš„ãªå€¤ã€ã¨ã„ã†ã®ãŒãƒã‚¤ãƒ³ãƒˆã€‚
</p>

<p>
<a href="https://e-words.jp/w/%E3%82%B5%E3%83%AD%E3%82%B2%E3%83%BC%E3%83%88%E3%82%AD%E3%83%BC.html">ã‚µãƒ­ã‚²ãƒ¼ãƒˆã‚­ãƒ¼ï¼ˆsurrogate keyï¼‰ã¨ã¯ - ITç”¨èªè¾å…¸ e-Words</a>
</p>
<blockquote>
<p>
ã‚µãƒ­ã‚²ãƒ¼ãƒˆã‚­ãƒ¼ã¨ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸»ã‚­ãƒ¼ã¨ã—ã¦ã€è‡ªå‹•å‰²ã‚Šå½“ã¦ã®é€£ç¶šã—ãŸé€šã—ç•ªå·ã®ã‚ˆã†ã«ã€åˆ©ç”¨è€…ã‚„è¨˜éŒ²ã™ã‚‹å¯¾è±¡ã¨ã¯ç›´æ¥é–¢ä¿‚ã®ãªã„äººå·¥çš„ãªå€¤ã‚’ç”¨ã„ã‚‹ã“ã¨ã€‚ã¾ãŸã€ãã®ãŸã‚ã«è¨­ã‘ã‚‰ã‚ŒãŸã‚«ãƒ©ãƒ ã®ã“ã¨ã€‚
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org6016d14" class="outline-3">
<h3 id="org6016d14"><a href="#org6016d14">ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ããªã„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚ã‚‹ã“ã¨ã‚’æ˜ç¤ºã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org6016d14">
<p>
ãŸã„ã¦ã„ã®å ´åˆã¯ã‚³ãƒ¡ãƒ³ãƒˆã§ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ããªã„ãªã©ã¨æ›¸ã‘ã°ã‚ˆã„ãŒã€rollbackãŒç ´å£Šçš„ãªå‹•ä½œã«ãªã‚‹å ´åˆãŒã‚ã‚‹ã®ã§downã«æ›¸ãã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 32: </span>ActiveRecord::IrreversibleMigration</label><pre class="src src-ruby"><span class="org-keyword">def</span> <span class="org-function-name">down</span>
  <span class="org-builtin">raise</span> <span class="org-type">ActiveRecord</span>::<span class="org-type">IrreversibleMigration</span>
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org708b840" class="outline-3">
<h3 id="org708b840"><a href="#org708b840">nullåˆ¶ç´„ã‚’è¿½åŠ ã—ã¤ã¤defaultè¨­å®š</a></h3>
<div class="outline-text-3" id="text-org708b840">
<p>
<a href="https://qiita.com/akinov/items/852fe789fe98a44350a9">Railsã®migrationã§å¾Œã‹ã‚‰NULLåˆ¶ç´„ã‚’è¨­å®šã™ã‚‹ - Qiita</a>
</p>

<p>
nullåˆ¶ç´„è¿½åŠ ã«ã¯ã€ <code>change_column_null</code> ã‚’ä½¿ã†ã€‚
nullåˆ¶ç´„ã ã‘è¿½åŠ ã™ã‚‹ã¨å¤‰æ›´å‰ã«nullã ã£ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã§ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã—ã¾ã†ã®ã§ã€åŒæ™‚ã«defaultã‚’è¨­å®šã™ã‚‹ã¨ã‚ˆã„ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 33: </span>nullåˆ¶ç´„ + defaultè¨­å®š</label><pre class="src src-ruby"><span class="org-keyword">class</span> <span class="org-type">ChangePointColumnOnPost</span> &lt; <span class="org-type">ActiveRecord</span>::<span class="org-type">Migration</span>[5.2]
  <span class="org-keyword">def</span> <span class="org-function-name">change</span>
    change_column_null <span class="org-constant">:posts</span>, <span class="org-constant">:point</span>, <span class="org-constant">false</span>, 0
    change_column_default <span class="org-constant">:posts</span>, <span class="org-constant">:point</span>, <span class="org-constant">from:</span> <span class="org-constant">nil</span>, <span class="org-constant">to:</span> 0
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 34: </span>â†‘falseã¯nullã‚ªãƒ—ã‚·ãƒ§ãƒ³</label><pre class="src src-ruby">change_column_null(table_name, column_name, null, default = <span class="org-constant">nil</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org176feb8" class="outline-3">
<h3 id="org176feb8"><a href="#org176feb8">migrationãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ˆã‚‹ä¸æ•´åˆè§£æ¶ˆã‚¿ã‚¹ã‚¯</a></h3>
<div class="outline-text-3" id="text-org176feb8">
<p>
migrationãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¸€éƒ¨DSLãŒæ‰±ã‚ã‚Œã‚‹ã ã‘ã§æ™®é€šã®rubyãƒ•ã‚¡ã‚¤ãƒ«ã¨å¤‰ã‚ã‚‰ãªã„ã€‚
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä¸æ•´åˆã‚’è§£æ¶ˆã™ã‚‹ã“ã¨ã«ã‚‚ä½¿ãˆã‚‹ã€‚
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span class="org-keyword">def</span> <span class="org-function-name">up</span>
  <span class="org-type">Blog</span>.unscoped.where(<span class="org-constant">user_id:</span> <span class="org-constant">nil</span>).delete_all
<span class="org-keyword">end</span>
</pre>
</div>
<p>
ã¨ã„ã†ã‚ˆã†ã«ã€‚
ç’°å¢ƒåˆ¥ã«consoleã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒãªã„ã®ã§ä¾¿åˆ©ã€‚
</p>
</div>
</div>
<div id="outline-container-org9efc48b" class="outline-3">
<h3 id="org9efc48b"><a href="#org9efc48b">unscopedã§default_scopeã‚’ç„¡åŠ¹åŒ–</a></h3>
<div class="outline-text-3" id="text-org9efc48b">
<p>
<code>unscoped</code> ã¯default_scopeã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚
<a href="https://apidock.com/rails/ActiveRecord/Base/unscoped/class">unscoped (ActiveRecord::Base) - APIdock</a>
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 36: </span>è‡ªå‹•ã§publishedã®æ¡ä»¶ãŒç™ºè¡Œã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹</label><pre class="src src-ruby"><span class="org-keyword">class</span> <span class="org-type">Post</span> &lt; <span class="org-type">ActiveRecord</span>::<span class="org-type">Base</span>
  <span class="org-keyword">def</span> <span class="org-keyword">self</span>.<span class="org-function-name">default_scope</span>
    where <span class="org-constant">:published</span> =&gt; <span class="org-constant">true</span>
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>

<span class="org-type">Post</span>.all          <span class="org-comment-delimiter"># </span><span class="org-comment">Fires "SELECT * FROM posts WHERE published = true"
</span><span class="org-type">Post</span>.unscoped.all <span class="org-comment-delimiter"># </span><span class="org-comment">Fires "SELECT * FROM posts"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 37: </span>default_scopeã®æ¡ä»¶ãŒãªããªã‚‹</label><pre class="src src-ruby"><span class="org-type">Post</span>.unscoped {
  <span class="org-type">Post</span>.limit(10) <span class="org-comment-delimiter"># </span><span class="org-comment">Fires "SELECT * FROM posts LIMIT 10"
</span>}
</pre>
</div>
</div>
</div>
<div id="outline-container-org5bd735f" class="outline-3">
<h3 id="org5bd735f"><a href="#org5bd735f">inverse_ofã§åŒæ–¹å‘ã®ä¸æ•´åˆã‚’é˜²ã</a></h3>
<div class="outline-text-3" id="text-org5bd735f">
<p>
<a href="https://qiita.com/itp926/items/9cac175d3b35945b8f7e">inverse_of ã«ã¤ã„ã¦ - Qiita</a>
</p>

<p>
åŒæ–¹å‘ã®é–¢é€£ä»˜ã‘ã®ä¸æ•´åˆã‚’é˜²ãé–¢é€£ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€‚belongs_to, has_manyç­‰ã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚ªãƒ³ã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ã€‚
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span class="org-keyword">class</span> <span class="org-type">Category</span>
  has_many <span class="org-constant">:blog</span>
<span class="org-keyword">end</span>

<span class="org-keyword">class</span> <span class="org-type">Order</span>
  belongs_to <span class="org-constant">:category</span>
<span class="org-keyword">end</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 39: </span>ä¸æ•´åˆ</label><pre class="src src-ruby">c = <span class="org-type">Category</span>.first
b = c.orders.first

c.title = <span class="org-string">"change"</span>
c.title == b.category.title <span class="org-comment-delimiter">#</span><span class="org-comment">=&gt; false &#20516;&#12399;&#30064;&#12394;&#12427;
</span>c.equal? b.category <span class="org-comment-delimiter">#</span><span class="org-comment">=&gt; false &#21516;&#12376;&#12458;&#12502;&#12472;&#12455;&#12463;&#12488;&#12391;&#12394;&#12356;</span>
</pre>
</div>
<p>
inverse_ofã‚’ä½¿ã†ã¨åŒã˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ã†ã‚ˆã†ã«ãªã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-org9c42f4b" class="outline-3">
<h3 id="org9c42f4b"><a href="#org9c42f4b">ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸æ•´åˆã‚’æ¤œçŸ¥ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org9c42f4b">
<p>
ã‚ˆãã‚ã‹ã‚‰ãªã„ã€‚
å…¨éƒ¨è¾¿ã‚‹æ–¹æ³•ã¯è‰²ã€…å¿œç”¨ãŒåŠ¹ããã†ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 40: </span>ä¸æ•´åˆæ¤œçŸ¥ã‚¿ã‚¹ã‚¯</label><pre class="src src-ruby">desc <span class="org-string">'&#22806;&#37096;&#12461;&#12540;&#12398;&#25972;&#21512;&#24615;&#12434;&#26908;&#35388;&#12377;&#12427;'</span>
task <span class="org-constant">extract_mismatch_records:</span> <span class="org-constant">:environment</span> <span class="org-keyword">do</span>
  <span class="org-type">Rails</span>.application.eager_load!

  <span class="org-type">ApplicationRecord</span>.subclasses.each <span class="org-keyword">do</span> |model|
    model.reflections.select { |_, reflection| reflection.is_a?(<span class="org-type">ActiveRecord</span>::<span class="org-type">Reflection</span>::<span class="org-type">BelongsToReflection</span>) }.each <span class="org-keyword">do</span> |name, reflection|
      model_name = model.model_name.human
      foreign_key = reflection.options[<span class="org-constant">:foreign_key</span>] || <span class="org-string">"</span><span class="org-variable-name">#{name}</span><span class="org-string">_id"</span>

      <span class="org-keyword">unless</span> model.columns.any? { |column| column.name == foreign_key.to_s }
        <span class="org-builtin">puts</span> <span class="org-string">"&#128162; </span><span class="org-variable-name">#{model_name}</span><span class="org-string"> &#12395;&#12399; </span><span class="org-variable-name">#{foreign_key}</span><span class="org-string"> &#12501;&#12451;&#12540;&#12523;&#12489;&#12364;&#12354;&#12426;&#12414;&#12379;&#12435;"</span>
        <span class="org-keyword">next</span>
      <span class="org-keyword">end</span>

      parent_model_class_name = reflection.options[<span class="org-constant">:class_name</span>] || reflection.name.to_s.classify
      parent_model = parent_model_class_name.safe_constantize

      <span class="org-keyword">unless</span> parent_model
        <span class="org-builtin">puts</span> <span class="org-string">"&#128162; </span><span class="org-variable-name">#{model_name}</span><span class="org-string"> &#12364;&#20381;&#23384;&#12375;&#12390;&#12356;&#12427; </span><span class="org-variable-name">#{parent_model_class_name}</span><span class="org-string"> &#12399;&#21442;&#29031;&#12391;&#12365;&#12414;&#12379;&#12435;"</span>
        <span class="org-keyword">next</span>
      <span class="org-keyword">end</span>

      parent_model_name = parent_model.model_name.human

      <span class="org-keyword">begin</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">NOTE: &#35242;&#12486;&#12540;&#12502;&#12523;&#12398;ID&#12392;&#12375;&#12390;&#23384;&#22312;&#12375;&#12394;&#12356;&#22806;&#37096;&#12461;&#12540;&#12398;&#25968;&#12434;&#29031;&#20250;
</span>        relation = model.unscoped.where.not(foreign_key =&gt; parent_model.unscoped.select(<span class="org-constant">:id</span>)).where.not(foreign_key =&gt; <span class="org-constant">nil</span>)
        sql = relation.to_sql
        count = relation.count

        <span class="org-keyword">if</span> count.zero?
          <span class="org-builtin">puts</span> <span class="org-string">"&#128161; </span><span class="org-variable-name">#{model_name}</span><span class="org-string"> &#12398; </span><span class="org-variable-name">#{parent_model_name}</span><span class="org-string"> &#12398;&#22806;&#37096;&#12461;&#12540;&#12399;&#25972;&#21512;&#24615;&#12364;&#20445;&#35388;&#12373;&#12428;&#12390;&#12356;&#12414;&#12377;"</span> <span class="org-keyword">unless</span> <span class="org-type">ENV</span>[<span class="org-string">'ONLY_FAILURE'</span>]
        <span class="org-keyword">else</span>
          <span class="org-builtin">puts</span> <span class="org-string">"&#128163; </span><span class="org-variable-name">#{model_name}</span><span class="org-string"> &#12398; </span><span class="org-variable-name">#{parent_model_name}</span><span class="org-string"> &#12398;&#22806;&#37096;&#12461;&#12540;&#12391;&#19981;&#27491;&#12394;&#12461;&#12540;&#12364; </span><span class="org-variable-name">#{count}</span><span class="org-string"> &#20214; &#35373;&#23450;&#12373;&#12428;&#12390;&#12356;&#12414;&#12377;"</span>
        <span class="org-keyword">end</span>

        <span class="org-keyword">if</span> <span class="org-type">ENV</span>[<span class="org-string">'DEBUG'</span>]
          <span class="org-builtin">puts</span> <span class="org-string">"=&gt; </span><span class="org-variable-name">#{sql}</span><span class="org-string">\n"</span>
          <span class="org-builtin">puts</span>
        <span class="org-keyword">end</span>
      <span class="org-keyword">rescue</span> <span class="org-type">StandardError</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">NOTE: &#12510;&#12473;&#12479;&#12487;&#12540;&#12479;&#12398;&#22580;&#21512;&#12399;&#12473;&#12461;&#12483;&#12503;
</span>        <span class="org-builtin">puts</span> <span class="org-string">"&#127539; </span><span class="org-variable-name">#{model_name}</span><span class="org-string"> &#12398; </span><span class="org-variable-name">#{parent_model_name}</span><span class="org-string"> &#12398;&#25972;&#21512;&#24615;&#12398;&#26908;&#35388;&#12434;&#12473;&#12461;&#12483;&#12503;&#12375;&#12414;&#12375;&#12383;"</span> <span class="org-keyword">unless</span> <span class="org-type">ENV</span>[<span class="org-string">'ONLY_FAILURE'</span>]
      <span class="org-keyword">end</span>
    <span class="org-keyword">end</span>
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>
</pre>
</div>

<p>
Reflectionã‚¯ãƒ©ã‚¹ã¯ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³é–¢ä¿‚ã®moduleã®ã‚ˆã†ã€‚
<a href="https://github.com/kd-collective/rails/blob/f132be462b957ea4cd8b72bf9e7be77a184a887b/activerecord/lib/active_record/reflection.rb#L49">https://github.com/kd-collective/rails/blob/f132be462b957ea4cd8b72bf9e7be77a184a887b/activerecord/lib/active_record/reflection.rb#L49</a>
</p>

<blockquote>
<p>
Reflection enables the ability to examine the associations and aggregations of Active Record classes and objects. This information, for example, can be used in a form builder that takes an Active Record object and creates input fields for all of the attributes depending on their type and displays the associations to other objects.
</p>

<p>
Reflectionã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€Active Recordã®ã‚¯ãƒ©ã‚¹ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é–¢é€£ä»˜ã‘ã‚„é›†è¨ˆã‚’èª¿ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®æƒ…å ±ã¯ã€ä¾‹ãˆã°ã€Active Recordã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å—ã‘å–ã‚Šã€ãã®å‹ã«å¿œã˜ã¦ã™ã¹ã¦ã®å±æ€§ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä½œæˆã—ã¾ã™ã€‚ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã®é–¢é€£ã‚’è¡¨ç¤ºã™ã‚‹ãƒ•ã‚©ãƒ¼ãƒ ãƒ“ãƒ«ãƒ€ãƒ¼ã§ä½¿ç”¨ã§ãã¾ã™ã€‚
</p>
</blockquote>

<p>
Reflectionã«é–¢ã™ã‚‹è¨˜äº‹ã€‚
<a href="https://qiita.com/kkyouhei/items/067d5bb8d79c71f1646b">Railsã®ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚€ ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ - Qiita</a>
</p>
</div>
</div>
<div id="outline-container-org6306486" class="outline-3">
<h3 id="org6306486"><a href="#org6306486">ã‚¯ã‚¨ãƒªé«˜é€ŸåŒ–</a></h3>
<div class="outline-text-3" id="text-org6306486">
<p>
ãƒã‚¹ãƒˆã—ã¦ã‚¯ã‚¨ãƒªã‚’ç™ºè¡Œã—ã¦ã‚‹ã¨ãã¯ä½•ã‹ãŒãŠã‹ã—ã„ã€‚
</p>

<ul class="org-ul">
<li>parent_category -&gt; category -&gt; blog ã®ã‚ˆã†ãªæ§‹é€ </li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 41: </span>ã²ã©ã„ã‚¯ã‚¨ãƒªãƒ¡ã‚½ãƒƒãƒ‰</label><pre class="src src-ruby">parent_categories.each <span class="org-keyword">do</span> |parent_category|
  parent_category.categories.each <span class="org-keyword">do</span> |category|
    category.blogs.each <span class="org-keyword">do</span> |blog|
      <span class="org-variable-name">@content</span> &lt;&lt; blog.content
    <span class="org-keyword">end</span>
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>
</pre>
</div>

<ul class="org-ul">
<li>parent_category -&gt; category -&gt; blog</li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 42: </span>joins</label><pre class="src src-ruby"><span class="org-type">Blog</span>.joins(<span class="org-constant">categories:</span> category)
  .merge(<span class="org-type">Category</span>.where(<span class="org-constant">parent_category:</span> parent_large_categories))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd4c1870" class="outline-3">
<h3 id="orgd4c1870"><a href="#orgd4c1870">Migrationãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã¾ã¨ã‚ã¦é«˜é€ŸåŒ–ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-orgd4c1870">
<p>
Migrationãƒ•ã‚¡ã‚¤ãƒ«ã¯å¤‰æ›´ã—ãªã„ã®ãŒåŸºæœ¬ã ãŒã€æ•°ãŒå¤šã„å ´åˆã€ <code>rails migrate:reset</code> ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã€‚
</p>

<p>
db/schema.rbã®å†…å®¹ã‚’ã€æœ€æ–°ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹ã€‚
</p>

<ul class="org-ul">
<li>ã¤ã¾ã‚Šç¾åœ¨ã®DBçŠ¶æ³ãŒã€ãã®ã¾ã¾1ã¤ã®migrationã¨ãªã‚‹ã€‚DSLãŒåŒã˜ãªã®ã§å•é¡Œãªã„ã€‚</li>
<li>migrationã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã¯ã™ã§ã«å®Ÿè¡Œæ¸ˆã¿ã®ãŸã‚ã€å‹•ä½œã«å½±éŸ¿ã—ãªã„ã€‚</li>
</ul>
</div>
</div>
<div id="outline-container-orga30507a" class="outline-3">
<h3 id="orga30507a"><a href="#orga30507a">Gemfileã§ç’°å¢ƒæŒ‡å®šã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-orga30507a">
<p>
Gemfileã®groupã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ã€æŒ‡å®šç’°å¢ƒã§ã—ã‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãªã„ã“ã¨ã‚’ç¤ºã™ã€‚
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 43: </span>developmentã§ã—ã‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œãªã„</label><pre class="src src-ruby">group <span class="org-constant">:development</span> <span class="org-keyword">do</span>
  gem <span class="org-string">'annotate'</span>, <span class="org-builtin">require</span>: <span class="org-constant">false</span>
<span class="org-keyword">end</span>
</pre>
</div>

<p>
ãªã®ã§ç’°å¢ƒã‚’æŒ‡å®šã›ãšã«ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ãŸã¨ãã€gem not foundãŒå‡ºã‚‹ã€‚å®Ÿè¡Œã•ã‚ŒãŸã®ãŒdevelopmentç’°å¢ƒã§ã€ãƒ†ã‚¹ãƒˆã®gemãŒèª­ã¿è¾¼ã¾ã‚Œã¦ãªã„ã‹ã‚‰ã€‚ <code>RAILS_ENV=test</code> ãŒã¤ã„ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-orgc8d2d45" class="outline-3">
<h3 id="orgc8d2d45"><a href="#orgc8d2d45">è«–ç†å‰Šé™¤ã¨ç‰©ç†å‰Šé™¤</a></h3>
<div class="outline-text-3" id="text-orgc8d2d45">
<p>
è«–ç†å‰Šé™¤ã¯å‰Šé™¤ã—ãŸã¨ããƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã™ã‚‹ã®ã§ã¯ãªãã€ãƒ•ãƒ©ã‚°ã‚’ãƒˆã‚°ãƒ«ã™ã‚‹ã‚‚ã®ã€‚
é€†ã«ç‰©ç†å‰Šé™¤ã¯ãƒ¬ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å‰Šé™¤ã™ã‚‹ã“ã¨ã€‚
</p>

<p>
è«–ç†å‰Šé™¤ã®ãƒ¡ãƒªãƒƒãƒˆã¯ã€ãƒ‡ãƒ¼ã‚¿ãŒæˆ»ã›ã‚‹ã“ã¨ã€‚
</p>

<p>
ãŒã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®é‹ç”¨çš„ã«ã€å¾Œã‹ã‚‰å•é¡Œã¨ãªã‚‹ã“ã¨ã®æ–¹ãŒå¤šã„ã€‚
</p>

<ul class="org-ul">
<li>å‰Šé™¤ãƒ•ãƒ©ã‚°ã‚’ä»˜ã‘å¿˜ã‚Œã‚‹ã¨äº‹æ•…ã«ãªã‚‹ã€‚å‰Šé™¤ã—ãŸã¯ãšãªã®ã«è¡¨ç¤ºã—ãŸã‚Šã€è¨ˆç®—ã«å…¥ã‚ŒãŸã‚Šã—ã¦ã—ã¾ã†</li>
<li>ãƒ‡ãƒ¼ã‚¿ãŒå¤šããªã‚‹ãŸã‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæ‚ªããªã‚‹</li>
</ul>

<p>
Railsã§ã¯gem act_as_paranoidã‚’ä½¿ã£ã¦ç°¡å˜ã«è«–ç†å‰Šé™¤å‡¦ç†ã‚’è¿½åŠ ã§ãã‚‹ã€‚deleted_atã‚«ãƒ©ãƒ ã‚’è«–ç†å‰Šé™¤ã‚’ç®¡ç†ã™ã‚‹ãƒ•ãƒ©ã‚°ã¨ã—ã¦ç”¨ã„ã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-org58e2273" class="outline-3">
<h3 id="org58e2273"><a href="#org58e2273">findã€find_byã€whereã®é•ã„</a></h3>
<div class="outline-text-3" id="text-org58e2273">
<p>
<a href="https://qiita.com/tsuchinoko_run/items/f3926caaec461cfa1ca3">findã€find_byã€whereã®é•ã„ - Qiita</a>
</p>

<dl class="org-dl">
<dt>find</dt><dd>å„ãƒ¢ãƒ‡ãƒ«ã®idã‚’æ¤œç´¢ã‚­ãƒ¼ã¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã€‚ãƒ¢ãƒ‡ãƒ«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒè¿”ã‚‹</dd>
<dt>find_by</dt><dd>idä»¥å¤–ã‚’ã‚­ãƒ¼ã¨ã—ã¦æ¤œç´¢ã€‚è¤‡æ•°ã‚ã£ãŸå ´åˆã¯æœ€åˆã ã‘å–ã‚‹ã€‚ãƒ¢ãƒ‡ãƒ«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒè¿”ã‚‹ã€‚</dd>
<dt>where</dt><dd>idä»¥å¤–ã‚’ã‚­ãƒ¼ã¨ã—ã¦æ¤œç´¢ã€‚ãƒ¢ãƒ‡ãƒ«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å…¥ã£ãŸé…åˆ—ãŒè¿”ã‚‹ã€‚</dd>
</dl>
</div>
</div>
<div id="outline-container-orge62b293" class="outline-3">
<h3 id="orge62b293"><a href="#orge62b293">acts_as_list</a></h3>
<div class="outline-text-3" id="text-orge62b293">
<p>
acts_as_listã¯é †ç•ªã‚’ç®¡ç†ã™ã‚‹gemã€‚
<a href="https://github.com/brendon/acts_as_list">brendon/acts_as_list: An ActiveRecord plugin for managing lists.</a>
</p>

<p>
é †ç•ªã®ç”Ÿæˆã¨ã€æ“ä½œã‚’å¯èƒ½ã«ã™ã‚‹ã€‚
modelã«é †ç•ªã‚«ãƒ©ãƒ ã‚’æŒ‡å®šã™ã‚‹ã¨ã€createæ™‚ã«è‡ªå‹•ã§ç•ªå·ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚
é€†ã«ãƒ•ã‚©ãƒ¼ãƒ ã§ç•ªå·æ ¼ç´ã—ã¦ã„ã‚‹ã¨ãã‚ŒãŒå„ªå…ˆã—ã¦å…¥ã‚‹ãŸã‚è‡ªå‹•æ¡ç•ªã•ã‚Œãªã„ã€‚
newæ™‚ã«ã¯ç•ªå·ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡¨ç¤ºã—ãªã„ãªã©ãŒå¿…è¦ã€‚
</p>
</div>
</div>
<div id="outline-container-org0fc5df7" class="outline-3">
<h3 id="org0fc5df7"><a href="#org0fc5df7">ãƒ†ãƒ¼ãƒ–ãƒ«åã¨åå‰ç©ºé–“</a></h3>
</div>
<div id="outline-container-org0b75b8b" class="outline-3">
<h3 id="org0b75b8b"><a href="#org0b75b8b">pluck</a></h3>
<div class="outline-text-3" id="text-org0b75b8b">
<p>
<code>pluck</code> ã¯ã€å„ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä¸¸ã”ã¨ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ã¨ã£ã¦ãã‚‹ã®ã§ã¯ãªãã€å¼•æ•°ã§æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã®ã¿ã® <b>é…åˆ—</b> ã§è¿”ã™ãƒ¡ã‚½ãƒƒãƒ‰ã€‚
<a href="https://railsdoc.com/page/model_pluck">pluck | Railsãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>
</p>

<p>
<code>select</code> ã¯ã‚«ãƒ©ãƒ æŒ‡å®šã¨ã„ã†ã¨ã“ã‚ã¯åŒã˜ã ãŒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™ã€‚
</p>
</div>
</div>
<div id="outline-container-orgdcb4768" class="outline-3">
<h3 id="orgdcb4768"><a href="#orgdcb4768">ã¾ã¨ã‚ã¦å‡¦ç†ã—ã¦é«˜é€ŸåŒ–</a></h3>
<div class="outline-text-3" id="text-orgdcb4768">
<p>
1ã¤1ã¤å‡¦ç†ã™ã‚‹ã®ã§ã¯ãªãã¦ã€åŒæ™‚ã«è¤‡æ•°ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‡¦ç†ã™ã‚‹ã“ã¨ã§é«˜é€ŸåŒ–ã™ã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-orgf9ed209" class="outline-3">
<h3 id="orgf9ed209"><a href="#orgf9ed209">è©²å½“ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ãŒè«å¤§ãªå ´åˆ</a></h3>
<div class="outline-text-3" id="text-orgf9ed209">
<p>
ãƒ¡ãƒ¢ãƒªã«å…¨ä½“ã‚’å±•é–‹ã™ã‚‹ã®ã§ãªãã€ã‚ã‚‹æ•°ãšã¤å±•é–‹ã—ã¦ãƒ¡ãƒ¢ãƒªæ¶ˆè²»ã‚’æŠ‘ãˆã‚‹ã€‚
</p>

<p>
<a href="https://railsdoc.com/page/find_each">find_each | Railsãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a> &#x2026; 1ä»¶ãšã¤å‡¦ç†ã€‚
<a href="https://railsdoc.com/page/find_in_batches">find_in_batches | Railsãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a> &#x2026; é…åˆ—ã§å‡¦ç†ã€‚
</p>
</div>
</div>
<div id="outline-container-orgb3c1027" class="outline-3">
<h3 id="orgb3c1027"><a href="#orgb3c1027">ä¸¦åˆ—å‡¦ç†ã®ä¾‹</a></h3>
<div class="outline-text-3" id="text-orgb3c1027">
<p>
parallel gemã«ã‚ˆã£ã¦ã€‚
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 44: </span>ä¾‹</label><pre class="src src-ruby"><span class="org-builtin">require</span> <span class="org-string">'parallel'</span>
result = <span class="org-type">Parallel</span>.each(1..10) <span class="org-keyword">do</span> |item|
    item ** 2
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5c44788" class="outline-3">
<h3 id="org5c44788"><a href="#org5c44788">é–‹ç™ºã«ä¾¿åˆ©ãªãƒšãƒ¼ã‚¸</a></h3>
<div class="outline-text-3" id="text-org5c44788">
<ul class="org-ul">
<li>/rails/info/routes
routesä¸€è¦§ã€‚</li>
<li>/letter_opener(è‡ªåˆ†ã§è¨­å®šã™ã‚‹)
é€ä¿¡ã—ãŸãƒ¡ãƒ¼ãƒ«ä¸€è¦§ã‚’è¦‹ã‚‰ã‚Œã‚‹ã€‚
gemãŒå…¥ã£ã¦ã‚‹å ´åˆã€‚
<a href="https://github.com/ryanb/letter_opener">ryanb/letter_opener: Preview mail in the browser instead of sending.</a></li>
<li>rails/mailers/
Action Mailerã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¦‹ã‚‰ã‚Œã‚‹ã€‚
previewã‚’æº–å‚™ã—ã¦ãŠãã¨ã„ã¡ã„ã¡é€ä¿¡ã›ãšã¨ã‚‚ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ€ãƒŸãƒ¼ãŒå…¥ã£ãŸæ–‡é¢ã‚’ç¢ºèªã§ãã‚‹ã€‚</li>
</ul>
</div>
</div>
<div id="outline-container-org1e76204" class="outline-3">
<h3 id="org1e76204"><a href="#org1e76204">é–‹ç™ºç’°å¢ƒã§ã—ã‹ä½¿ãˆãªã„ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org1e76204">
<p>
<code>class_name</code> ã¯é–‹ç™ºç’°å¢ƒã§ã—ã‹ä½¿ãˆãªã„ã€‚
gemã«ã‚ˆã£ã¦ã¯ãã†ã„ã†ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ä½¿ãˆãªã„ã“ã¨ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãŠãã€‚
</p>

<ul class="org-ul">
<li><a href="https://stackoverflow.com/questions/38776080/method-class-name-undefined-for-class-object-in-rails">https://stackoverflow.com/questions/38776080/method-class-name-undefined-for-class-object-in-rails</a></li>
</ul>
<blockquote>
<p>
class_name method is defined by yard gem. it works only development env.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org2e8fe7e" class="outline-3">
<h3 id="org2e8fe7e"><a href="#org2e8fe7e">rails console -s</a></h3>
<div class="outline-text-3" id="text-org2e8fe7e">
<p>
<code>rails console -s</code> ã¨ã—ã¦consoleèµ·å‹•ã™ã‚‹ã¨ã€sandbox-modeã«ãªã‚Šã‚³ãƒ³ã‚½ãƒ¼ãƒ«å†…ã®DBæ“ä½œãŒçµ‚äº†æ™‚ã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ã€‚
ä¾¿åˆ©ã€‚
</p>
</div>
</div>
<div id="outline-container-org4cdb110" class="outline-3">
<h3 id="org4cdb110"><a href="#org4cdb110">rails cã§ããªã„ã¨ã</a></h3>
<div class="outline-text-3" id="text-org4cdb110">
<p>
springã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä¿å­˜ã—ã¦æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‚’æ—©ãã™ã‚‹gemã€‚
ãƒ†ã‚¹ãƒˆã‚‚é«˜é€ŸåŒ–ã§ãã‚‹ã®ã§ä¾¿åˆ©ã ãŒã€ãŸã¾ã«å£Šã‚Œã¦åæ˜ ã—ãªããªã£ãŸã‚Šã™ã‚‹ã€‚
</p>

<p>
ã¾ãšspringã‚’æ­¢ã‚ã¦ç¢ºèªã™ã‚‹ã€‚
</p>
<div class="org-src-container">
<pre class="src src-shell">bundle exec spring stop
</pre>
</div>
</div>
</div>
<div id="outline-container-org76c2ca0" class="outline-3">
<h3 id="org76c2ca0"><a href="#org76c2ca0">system specã§TCP error ãŒã§ã‚‹ã¨ã</a></h3>
<div class="outline-text-3" id="text-org76c2ca0">
<p>
ãƒ†ã‚¹ãƒˆãŒã‚ã‚‹ç¨‹åº¦ã®é•·ã•ã‚’è¶…ãˆã‚‹ã¨ã€ãƒ¡ãƒ¢ãƒªã®é‡ãŒè¶³ã‚Šãªããªã£ã¦ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã™ã€‚
ç‰¹ã«Macã ã¨èµ·ã“ã‚‹ã‚ˆã†ã€‚
</p>
<div class="org-src-container">
<pre class="src src-shell"><span class="org-builtin">ulimit</span> -n 1024
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfc666d0" class="outline-3">
<h3 id="orgfc666d0"><a href="#orgfc666d0">seed_fuã®lint</a></h3>
<div class="outline-text-3" id="text-orgfc666d0">
<p>
èµ°ã‚‰ã›ã¦ã‚¨ãƒ©ãƒ¼ãŒãªã„ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€‚
</p>
<div class="org-src-container">
<pre class="src src-ruby">namespace <span class="org-constant">:db</span> <span class="org-keyword">do</span>
  namespace <span class="org-constant">:seed_fu</span> <span class="org-keyword">do</span>
    desc <span class="org-string">'Verify that all fixtures are valid'</span>
    task <span class="org-constant">lint:</span> <span class="org-constant">:environment</span> <span class="org-keyword">do</span>
      <span class="org-keyword">if</span> <span class="org-type">Rails</span>.env.test?
        conn = <span class="org-type">ActiveRecord</span>::<span class="org-type">Base</span>.connection

        <span class="org-string">%w[development test production]</span>.each <span class="org-keyword">do</span> |env|
          conn.transaction <span class="org-keyword">do</span>
            <span class="org-type">SeedFu</span>.seed(<span class="org-string">"db/fixtures/</span><span class="org-variable-name">#{env}</span><span class="org-string">"</span>)
            <span class="org-builtin">raise</span> <span class="org-type">ActiveRecord</span>::<span class="org-type">Rollback</span>
          <span class="org-keyword">end</span>
        <span class="org-keyword">end</span>
      <span class="org-keyword">else</span>
        <span class="org-builtin">system</span>(<span class="org-string">"bundle exec rails db:seed_fu:lint RAILS_ENV='test'"</span>)
        <span class="org-builtin">raise</span> <span class="org-keyword">if</span> <span class="org-builtin">$CHILD_STATUS</span>.exitstatus.nonzero?
      <span class="org-keyword">end</span>
    <span class="org-keyword">end</span>
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb269c30" class="outline-3">
<h3 id="orgb269c30"><a href="#orgb269c30">ã©ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‹èª¿ã¹ã‚‹</a></h3>
<div class="outline-text-3" id="text-orgb269c30">
<p>
ã©ã®gemã®ãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚ã‹ã‚‰ãªã„ã¨ãã« <code>source_location</code> ãŒä¾¿åˆ©ã€‚
<a href="https://docs.ruby-lang.org/ja/latest/method/Method/i/source_location.html">https://docs.ruby-lang.org/ja/latest/method/Method/i/source_location.html</a>
</p>
<div class="org-src-container">
<pre class="src src-ruby">character.method(<span class="org-constant">:draw</span>).source_location
</pre>
</div>
</div>
</div>
<div id="outline-container-org85706d7" class="outline-3">
<h3 id="org85706d7"><a href="#org85706d7">DBãƒªã‚»ãƒƒãƒˆ</a></h3>
<div class="outline-text-3" id="text-org85706d7">
<p>
ç’°å¢ƒã‚’æŒ‡å®šã—ã¦ã€ãƒªã‚»ãƒƒãƒˆã‚’è¡Œã†ã€‚
ãƒ‡ãƒ¼ã‚¿ã®åˆæœŸåŒ–ã«seed_fu gemã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚
</p>

<div class="org-src-container">
<pre class="src src-shell">bundle exec rails db:migrate:reset &amp;&amp; rails db:seed_fu
</pre>
</div>
</div>
</div>
<div id="outline-container-org7ad1959" class="outline-3">
<h3 id="org7ad1959"><a href="#org7ad1959">ãƒ‡ã‚¤ãƒªãƒ¼ã§ã‚„ã‚‹ã“ã¨</a></h3>
<div class="outline-text-3" id="text-org7ad1959">
<p>
gemã®updateã‚„ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·ããŸã¨ãã«ã‚„ã‚‹ã€‚
ã©ã“ã‹ã§å®šå‹åŒ–ã—ã¦ä¸€æ°—ã«å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
</p>
<div class="org-src-container">
<pre class="src src-shell">git checkout develop &amp;&amp; bundle install &amp;&amp; bundle exec rails db:migrate
</pre>
</div>
</div>
</div>
<div id="outline-container-org4bf6d78" class="outline-3">
<h3 id="org4bf6d78"><a href="#org4bf6d78">scope</a></h3>
<div class="outline-text-3" id="text-org4bf6d78">
<p>
scopeã¯ã‚¯ãƒ©ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰çš„ãªã‚„ã¤ã€‚
ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã¯ä½¿ãˆãªã„ã€‚ <code>User.scope...</code>
<a href="https://railsguides.jp/active_record_querying.html#%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%97">Active Record ã‚¯ã‚¨ãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ - Railsã‚¬ã‚¤ãƒ‰</a>
</p>

<blockquote>
<p>
ã‚¹ã‚³ãƒ¼ãƒ—ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€é–¢é€£ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„ãƒ¢ãƒ‡ãƒ«ã¸ã®ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ã¨ã—ã¦å‚ç…§ã•ã‚Œã‚‹ã€ã‚ˆãä½¿ç”¨ã•ã‚Œã‚‹ã‚¯ã‚¨ãƒªã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
</p>
</blockquote>
</div>
</div>
<div id="outline-container-orgf763302" class="outline-3">
<h3 id="orgf763302"><a href="#orgf763302">validation</a></h3>
<div class="outline-text-3" id="text-orgf763302">
<p>
<code>valid?</code> ã¯Action Modelã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰ã€‚
<a href="https://devdocs.io/rails~6.1/activemodel/validations#method-i-valid-3F">Ruby on Rails 6.1 / ActiveModel::Validations#valid? â€” DevDocs</a>
å¼•ã£ã‹ã‹ã£ã¦ãŸã‚‰falseã«ãªã‚‹ã€‚
ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã¦ã—ã¾ã„ãã†ã«ãªã‚‹ãƒ¡ã‚½ãƒƒãƒ‰åãªã®ã«æ³¨æ„ã€‚
</p>
</div>
</div>
<div id="outline-container-orgab7b4c5" class="outline-3">
<h3 id="orgab7b4c5"><a href="#orgab7b4c5">ãƒã‚¹ãƒˆã—ãŸvalidateã¯åå¿œã—ãªã„</a></h3>
<div class="outline-text-3" id="text-orgab7b4c5">
<p>
ç‰¹å®šã®æ¡ä»¶ã ã‘ã§ç™ºå‹•ã™ã‚‹validation + æ¡ä»¶ã€‚`with_options: if`å†…ã§`if`ã‚’ä½¿ã†ã¨ã€ä¸­ã®ifæ¡ä»¶ãŒå„ªå…ˆã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€ã“ã†æ›¸ãå¿…è¦ãŒã‚ã‚‹ã€‚
</p>
<div class="org-src-container">
<pre class="src src-ruby">validates <span class="org-constant">:term_date</span>, <span class="org-constant">date:</span> { <span class="org-constant">after:</span> <span class="org-builtin">proc</span> { <span class="org-type">Time</span>.zone.now } }, <span class="org-keyword">if</span>: <span class="org-builtin">proc</span> { |p| p.term_date? &amp;&amp; p.sellable?  }
</pre>
</div>
</div>
</div>
<div id="outline-container-org9cd0871" class="outline-3">
<h3 id="org9cd0871"><a href="#org9cd0871">N+1å•é¡Œ</a></h3>
<div class="outline-text-3" id="text-org9cd0871">
<p>
<a href="20210725100835-sql.html#ID-8b69b8d4-1612-4dc5-8412-96b431fdd101">SQL</a>ãŒãŸãã•ã‚“å®Ÿè¡Œã•ã‚Œã¦é…ããªã‚‹ã“ã¨ã€‚ãƒ«ãƒ¼ãƒ—ã—ã¦ã„ã‚‹ã¨ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ•°ã ã‘SQLãŒç™ºè¡Œã•ã‚Œã€ä¸€æ°—ã«é…ããªã‚‹ã€‚
includesã‚’ä½¿ã†ã¨å°‘ãªã„SQLã«ã¾ã¨ã‚ã‚‰ã‚Œã‚‹ã€‚
<a href="https://qiita.com/hirotakasasaki/items/e0be0b3fd7b0eb350327">https://qiita.com/hirotakasasaki/items/e0be0b3fd7b0eb350327</a>
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 45: </span>includesã§é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã¾ã¨ã‚ã¦å–å¾—ã™ã‚‹</label><pre class="src src-ruby"><span class="org-type">Page</span>.includes(<span class="org-constant">:category</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org288d555" class="outline-3">
<h3 id="org288d555"><a href="#org288d555">å­ã®ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹ã¨ãé–¢é€£å‰Šé™¤ã—ãªã„ã‚ˆã†ã«ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org288d555">
<p>
<code>dependent: destroy</code> ã ã¨å­ã®ãƒ‡ãƒ¼ã‚¿ã‚‚ã™ã¹ã¦ç ´å£Šã—ã¦æ•´åˆæ€§ã‚’ä¿ã¤ã€‚
ãã‚Œã§ã¯å…·åˆãŒæ‚ªã„ã¨ãã‚‚ã‚ã‚‹ã®ã§ã€æ¶ˆã•ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚
</p>
<div class="org-src-container">
<pre class="src src-ruby">has_many <span class="org-constant">:contents</span>, <span class="org-constant">dependent:</span> <span class="org-constant">:restrict_with_error</span>
</pre>
</div>

<p>
ã‚ã‚‹ã„ã¯ã€å¤–éƒ¨ã‚­ãƒ¼ã‚’nullæ›´æ–°ã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚‹(nullableã§ã‚ã‚Œã°)ã€‚
</p>
<div class="org-src-container">
<pre class="src src-ruby">has_many <span class="org-constant">:contents</span>, <span class="org-constant">dependent:</span> <span class="org-constant">:nullify</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org08e4165" class="outline-3">
<h3 id="org08e4165"><a href="#org08e4165">æ–‡å­—åˆ—ã§è¿”ã£ã¦ãã‚‹çœŸå½å€¤ã‚’booleanã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã™ã‚‹</a></h3>
<div class="outline-text-3" id="text-org08e4165">
<p>
æ–‡å­—åˆ—ã§è¿”ã£ã¦ãã‚‹çœŸå½å€¤ã‚’ã€booleanã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦æ‰±ã„ã¨ãã€‚ActiveModelã®moduleã‚’ä½¿ç”¨ã™ã‚‹ã€‚
è¨€ã‚ã‚Œã¦ã¿ã‚‹ã¨DBã§ã¯æ–‡å­—åˆ—ã‹ã‚’ã‚ã¾ã‚Šæ„è­˜ã›ãšã«ä½¿ãˆã‚‹ã€‚
</p>
<div class="org-src-container">
<pre class="src src-ruby"><span class="org-type">ActiveModel</span>::<span class="org-type">Type</span>::<span class="org-type">Boolean</span>.new.cast(value) == <span class="org-constant">true</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb14dd60" class="outline-3">
<h3 id="orgb14dd60"><a href="#orgb14dd60">slimã§æ¡ä»¶åˆ†å²</a></h3>
<div class="outline-text-3" id="text-orgb14dd60">
<p>
<a href="https://qiita.com/mishiwata1015/items/407e924263d698ddeaae">ã€Railsã€‘Slimã§å…¥ã‚Œå­ã«ãªã£ã¦ã„ã‚‹è¦ç´ ã®è¦ªã‚¿ã‚°ã®ã¿ã‚’åˆ†å²ã•ã›ã‚‹ - Qiita</a>
é–‰ã˜ã‚¿ã‚°ãŒãªã„ãŸã‚éšå±¤ã®ä¸Šã ã‘æ¡ä»¶åˆ†å²ã™ã‚‹ãŸã‚ã«ã¯ç‰¹æ®Šãªæ›¸ãæ–¹ãŒå¿…è¦ã«ãªã‚‹ã€‚
</p>
- unless request.variant.present? && request.variant.include?(:phone)
  / PCã§ã®ã¿ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«
  - args = [:section, class: 'sidebar']
- else
  / ã‚¹ãƒãƒ›ã§ã¯ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å…¥ã‚Œã‚‹
  - args = [:section]
= content_tag(*args)
</div>
</div>
<div id="outline-container-org7bc82cf" class="outline-3">
<h3 id="org7bc82cf"><a href="#org7bc82cf">migrationä¾‹</a></h3>
<div class="outline-text-3" id="text-org7bc82cf">
<div class="org-src-container">
<pre class="src src-shell">$ rails g migration ChangeProductPrice
</pre>
</div>

<div class="org-src-container">
<pre class="src src-ruby"><span class="org-keyword">class</span> <span class="org-type">ChangeProductsPrice</span> &lt; <span class="org-type">ActiveRecord</span>::<span class="org-type">Migration</span>[7.0]
  <span class="org-keyword">def</span> <span class="org-function-name">up</span>
    change_table <span class="org-constant">:products</span> <span class="org-keyword">do</span> |t|
      t.change <span class="org-constant">:price</span>, <span class="org-constant">:string</span>
    <span class="org-keyword">end</span>
  <span class="org-keyword">end</span>

  <span class="org-keyword">def</span> <span class="org-function-name">down</span>
    change_table <span class="org-constant">:products</span> <span class="org-keyword">do</span> |t|
      t.change <span class="org-constant">:price</span>, <span class="org-constant">:integer</span>
    <span class="org-keyword">end</span>
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-shell">$ rails g migration AddNotNullOnBooks
</pre>
</div>

<div class="org-src-container">
<pre class="src src-ruby"><span class="org-keyword">class</span> <span class="org-type">AddNotNullOnBooks</span> &lt; <span class="org-type">ActiveRecord</span>::<span class="org-type">Migration</span>[6.0]
  <span class="org-keyword">def</span> <span class="org-function-name">up</span>
    change_column_null <span class="org-constant">:books</span>, <span class="org-constant">:user_id</span>, <span class="org-constant">false</span>
  <span class="org-keyword">end</span>

  <span class="org-keyword">def</span> <span class="org-function-name">down</span>
    change_column_null <span class="org-constant">:books</span>, <span class="org-constant">:user_id</span>, <span class="org-constant">true</span>
  <span class="org-keyword">end</span>
<span class="org-keyword">end</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf298936" class="outline-2">
<h2 id="orgf298936"><a href="#orgf298936">Tasks</a></h2>
<div class="outline-text-2" id="text-orgf298936">
</div>
<div id="outline-container-org58df4cf" class="outline-3">
<h3 id="org58df4cf"><a href="#org58df4cf"><span class="todo TODO">TODO</span> ECRãƒ‡ãƒ—ãƒ­ã‚¤</a></h3>
<div class="outline-text-3" id="text-org58df4cf">
</div>
</div>
<div id="outline-container-org1eb623f" class="outline-3">
<h3 id="org1eb623f"><a href="#org1eb623f"><span class="todo TODO">TODO</span> å®Ÿè¡Œæ™‚ã®waringã‚’ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦æ¤œå‡ºã•ã›ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹</a></h3>
</div>
<div id="outline-container-org8db5fd9" class="outline-3">
<h3 id="org8db5fd9"><a href="#org8db5fd9"><span class="todo TODO">TODO</span> <a href="https://egghead.io/blog/rails-graphql-typescript-react-apollo">Rails + GraphQL + TypeScript + React + Apollo | egghead.io</a></a></h3>
</div>
<div id="outline-container-org3e41704" class="outline-3">
<h3 id="org3e41704"><a href="#org3e41704"><span class="todo TODO">TODO</span> <a href="https://www.amazon.com/Advanced-Rails-Recipes-Mike-Clark/dp/0978739221">Advanced Rails Recipes</a></a></h3>
</div>
<div id="outline-container-orgc3c2b92" class="outline-3">
<h3 id="orgc3c2b92"><a href="#orgc3c2b92"><span class="todo TODO">TODO</span> <a href="https://dxd2021.cto-a.org/program/time-table/b-3">ã‚¯ã‚½ã‚³ãƒ¼ãƒ‰å‹•ç”»ã€ŒUserã‚¯ãƒ©ã‚¹ã€ã§è€ƒãˆã‚‹æŠ€è¡“çš„è² å‚µè§£æ¶ˆã®è¦³ç‚¹/DXD2021</a></a></h3>
<div class="outline-text-3" id="text-orgc3c2b92">
<p>
ã‚¯ã‚½ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å­¦ã¶ã€‚
</p>
</div>
</div>
<div id="outline-container-org5086f60" class="outline-3">
<h3 id="org5086f60"><a href="#org5086f60"><span class="todo TODO">TODO</span> <a href="https://railsguides.jp/">Ruby on Rails ã‚¬ã‚¤ãƒ‰ï¼šä½“ç³»çš„ã« Rails ã‚’å­¦ã¼ã†</a></a></h3>
<div class="outline-text-3" id="text-org5086f60">
<p>
Rails ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€‚
</p>
</div>
</div>
<div id="outline-container-org76eff62" class="outline-3">
<h3 id="org76eff62"><a href="#org76eff62"><span class="todo TODO">TODO</span> <a href="https://www.codewithjason.com/understanding-factory-bot-syntax-coding-factory-bot/">Understanding Factory Bot syntax by coding your own Factory Bot - Code with Jason</a></a></h3>
<div class="outline-text-3" id="text-org76eff62">
<p>
Factory Botã®ä½œã‚Šæ–¹ã€‚
</p>
</div>
</div>
<div id="outline-container-orgb9d216b" class="outline-3">
<h3 id="orgb9d216b"><a href="#orgb9d216b"><span class="todo TODO">TODO</span> Tipsæ–‡æ›¸åŒ–</a></h3>
<div class="outline-text-3" id="text-orgb9d216b">
<ul class="org-ul">
<li>5730</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgd143b19" class="outline-2">
<h2 id="orgd143b19"><a href="#orgd143b19">Archives</a></h2>
<div class="outline-text-2" id="text-orgd143b19">
</div>
<div id="outline-container-org27fdb56" class="outline-3">
<h3 id="org27fdb56"><a href="#org27fdb56"><span class="done DONE">DONE</span> èª¤å­—</a></h3>
<div class="outline-text-3" id="text-org27fdb56">
<p>
<a href="https://github.com/carrierwaveuploader/carrierwave/blob/a3ffc5381e70a4014b61b27b35540aa3b945910d/README.md#retry-option-for-douwload-from-remote-location">https://github.com/carrierwaveuploader/carrierwave/blob/a3ffc5381e70a4014b61b27b35540aa3b945910d/README.md#retry-option-for-douwload-from-remote-location</a>
</p>

<p>
PRé€ä¿¡å®Œäº†ã€‚ä¸€å­—ã ã‘ã€‚
</p>
</div>
</div>
<div id="outline-container-org41d9940" class="outline-3">
<h3 id="org41d9940"><a href="#org41d9940"><span class="done DONE">DONE</span> <a href="https://zenn.dev/prune/books/0d7d6e3c5f0496">Rails+Reactï¼ˆSPAï¼‰TODOã‚¢ãƒ—ãƒªãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã€0ã‹ã‚‰å­¦ã¶ã€‘</a></a></h3>
<div class="outline-text-3" id="text-org41d9940">
<p>
<a href="20210509095946-rails.html#ID-e04aa1a3-509c-45b2-ac64-53d69c961214">Rails</a>  + <a href="20210902220546-react.html#ID-dc50d818-d7d1-48a8-ad76-62ead617c670">React</a>ã®æœ¬ã€‚
</p>

<p>
ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ãŒã§ããªã„ã€‚
</p>
</div>
</div>
<div id="outline-container-org67b3fcf" class="outline-3">
<h3 id="org67b3fcf"><a href="#org67b3fcf"><span class="done CLOSE">CLOSE</span> loggerã‚’è‡ªå‹•ã‚ªãƒ³</a></h3>
<div class="outline-text-3" id="text-org67b3fcf">
<p>
Rails consoleã€‚ENVã§åˆ†å²ã™ã‚Œã°æœ¬ç•ªã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’ä¸Šã’ã‚‹ã€ã¨ã„ã†ã“ã¨ãŒã§ãã‚‹ã¯ãšã€‚
</p>
</div>
</div>
<div id="outline-container-org8bb10ae" class="outline-3">
<h3 id="org8bb10ae"><a href="#org8bb10ae"><span class="done DONE">DONE</span> <a href="https://qiita.com/k-penguin-sato/items/07fef2f26fd6339e0e69">ã€Railsã€‘graphql-rubyã§APIã‚’ä½œæˆ - Qiita</a> -å®Ÿè¡Œ</a></h3>
<div class="outline-text-3" id="text-org8bb10ae">
<p>
<a href="20211030122204-graphql.html#ID-b4f456cf-d250-4877-ac4c-4b03144392f0">GraphQL</a>ã‚’railsã§ã‚„ã‚‹ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã€‚
</p>
</div>
</div>
<div id="outline-container-org8f4a4c5" class="outline-3">
<h3 id="org8f4a4c5"><a href="#org8f4a4c5"><span class="done CLOSE">CLOSE</span> <a href="https://www.amazon.co.jp/dp/B01N0SS6NF/ref=dp-kindle-redirect?_encoding=UTF8&amp;btkr=1">Amazon.co.jp: Deploying Rails with Docker, Kubernetes and ECS (English Edition) eBook : AcuÃ±a, Pablo: Foreign Language Books</a></a></h3>
<div class="outline-text-3" id="text-org8f4a4c5">
<ul class="org-ul">
<li>24, 51</li>
</ul>

<p>
Kubernetesã§Rails deployã¾ã§ã‚„ã‚‹æœ¬ã€‚
AWSãƒ‡ãƒ—ãƒ­ã‚¤ã‚³ãƒãƒ³ãƒ‰ã®æŒ™å‹•ãŒé•ã„ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆã‚ã›ã¦ã‚‚å‹•ã‹ãšã‚ˆãã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã§æ–­å¿µã€‚ã“ã†ã„ã†ã®ã¯æ–°ã—ã„æœ¬ã‚’è²·ã†ã¹ãã ãªã€‚ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒminikubeã§ã®å‹•ä½œã¯ç¢ºèªã§ããŸã€‚
</p>
</div>
</div>
<div id="outline-container-orga60a311" class="outline-3">
<h3 id="orga60a311"><a href="#orga60a311"><span class="done DONE">DONE</span> Railsã¨Pumaã®é–¢ä¿‚æ€§&#xa0;&#xa0;&#xa0;<span class="tag"><span class="DontKnow">DontKnow</span></span></a></h3>
<div class="outline-text-3" id="text-orga60a311">
<p>
2ã¤ã®é•ã„ã¯ä½•ã§ã€å®Ÿéš›ã©ã®ã‚ˆã†ã«ã€ã©ã®å¢ƒç•Œã§å‡¦ç†ã—ã¦ã„ã‚‹ã®ã‹ã€‚
</p>

<ul class="org-ul">
<li>rails: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³(ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰)</li>
<li>puma: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å‹•ã‹ã—ã¦ã„ã‚‹ã‚‚ã®</li>
</ul>

<blockquote>
<p>
ã¾ãšã€webãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯webã‚µãƒ¼ãƒãƒ¼ãŒå—ã‘å–ã‚Šã¾ã™ã€‚ãã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒRailsã§å‡¦ç†ã§ãã‚‹ã‚‚ã®ã§ã‚ã‚Œã°ã€webã‚µãƒ¼ãƒãƒ¼ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ç°¡å˜ãªå‡¦ç†ã‚’åŠ ãˆã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼ã«æ¸¡ã—ã¾ã™ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼ã¯Rackã‚’ä½¿ã£ã¦Railsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è©±ã—ã‹ã‘ã¾ã™ã€‚Railsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‡¦ç†ã‚’çµ‚ãˆã‚‹ã¨ã€Railsã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼ã«è¿”ã—ã¾ã™ã€‚ãã—ã¦ã€webã‚µãƒ¼ãƒãƒ¼ã¯ã‚ãªãŸã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ã£ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã—ã¾ã™ã€‚
</p>
</blockquote>

<ul class="org-ul">
<li><a href="https://qiita.com/jnchito/items/3884f9a2ccc057f8f3a3">Railsé–‹ç™ºã«ãŠã‘ã‚‹webã‚µãƒ¼ãƒãƒ¼ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼ã®é•ã„ï¼ˆç¿»è¨³ï¼‰ - Qiita</a></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org91fda4f" class="outline-2">
<h2 id="org91fda4f"><a href="#org91fda4f">References</a></h2>
<div class="outline-text-2" id="text-org91fda4f">
</div>
<div id="outline-container-org993881b" class="outline-3">
<h3 id="org993881b"><a href="#org993881b"><a href="https://github.com/thoughtbot/ruby-science">thoughtbot/ruby-science: The reference for writing fantastic Rails applications</a></a></h3>
<div class="outline-text-3" id="text-org993881b">
<p>
ruby, railsã®ã‚ˆã‚Šè‰¯ã„æ›¸ãæ–¹ã®ã‚¬ã‚¤ãƒ‰ã€‚
</p>
</div>
</div>
<div id="outline-container-org80db4a6" class="outline-3">
<h3 id="org80db4a6"><a href="#org80db4a6"><a href="https://qiita.com/takahiro1127/items/fcb81753eaf381b4b33c">ãªãœrailsã®æœ¬ç•ªç’°å¢ƒã§ã¯Unicorn,Nginxã‚’ä½¿ã†ã®ã‹? ã€€~ Rack,Unicorn,Nginxã®é€£æºã«ã¤ã„ã¦ ~ã€Ruby On Railsã§webã‚µãƒ¼ãƒ“ã‚¹é‹å–¶ã€‘ - Qiita</a></a></h3>
</div>
<div id="outline-container-orga8db58d" class="outline-3">
<h3 id="orga8db58d"><a href="#orga8db58d"><a href="https://stackoverflow.com/questions/61413196/how-to-run-capybara-tests-using-selenium-chrome-in-a-dockerised-rails-environm">docker - How to run Capybara tests using Selenium &amp; Chrome in a Dockerised Rails environment on a Mac - Stack Overflow</a></a></h3>
<div class="outline-text-3" id="text-orga8db58d">
<p>
dockerã®seleniumã§å‹•ã‹ã™æ–¹æ³•ã€‚
</p>
</div>
</div>
<div id="outline-container-orgd4f46cf" class="outline-3">
<h3 id="orgd4f46cf"><a href="#orgd4f46cf"><a href="https://railsguides.jp/active_model_basics.html">Active Model ã®åŸºç¤ - Railsã‚¬ã‚¤ãƒ‰</a></a></h3>
<div class="outline-text-3" id="text-orgd4f46cf">
<p>
ãƒ¢ãƒ‡ãƒ«ã®èª¬æ˜ã€‚
</p>
</div>
</div>
<div id="outline-container-org2e14b16" class="outline-3">
<h3 id="org2e14b16"><a href="#org2e14b16"><a href="https://qiita.com/jnchito/items/0ee47108972a0e302caf">æ°¸ä¹…ä¿å­˜ç‰ˆï¼ï¼Ÿä¼Šè—¤ã•ã‚“å¼ãƒ»Railsã‚¢ãƒ—ãƒªã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ‰‹é † - Qiita</a></a></h3>
<div class="outline-text-3" id="text-org2e14b16">
<p>
ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã®æµã‚Œã€‚
</p>
</div>
</div>
<div id="outline-container-orgbcc8677" class="outline-3">
<h3 id="orgbcc8677"><a href="#orgbcc8677"><a href="https://tech.kitchhike.com/entry/2017/03/07/190739">DHHæµã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§å¾—ã‚‰ã‚Œã‚‹ãƒ¡ãƒªãƒƒãƒˆã¨ã€å–ã‚Šå…¥ã‚Œã‚‹ä¸Šã§ã®ãƒã‚¤ãƒ³ãƒˆ - KitchHike Tech Blog</a></a></h3>
<div class="outline-text-3" id="text-orgbcc8677">
<p>
ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’ã©ã†ã™ã‚‹ã‹ã®æŒ‡é‡ã€‚
</p>
</div>
</div>
<div id="outline-container-org50757f5" class="outline-3">
<h3 id="org50757f5"><a href="#org50757f5"><a href="https://github.com/ankane/strong_migrations">ankane/strong_migrations: Catch unsafe migrations in development</a></a></h3>
<div class="outline-text-3" id="text-org50757f5">
<p>
READMEã«å®‰å…¨ãªãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®èª¬æ˜ãŒã‚ã‚‹ã€‚
</p>
</div>
</div>
<div id="outline-container-orgb830977" class="outline-3">
<h3 id="orgb830977"><a href="#orgb830977"><a href="https://tech.speee.jp/entry/2020/06/30/110000">reg-suit ã«ã‚ˆã‚‹ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã§ Rails ã‚¢ãƒ—ãƒªã® CSS æ”¹å–„ã‚µã‚¤ã‚¯ãƒ«ãŒå›ã‚Šå§‹ã‚ãŸè©± - Speee DEVELOPER BLOG</a></a></h3>
<div class="outline-text-3" id="text-orgb830977">
<p>
ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã®é‹ç”¨æ–¹æ³•ã€‚
</p>
</div>
</div>
<div id="outline-container-orgb7657d4" class="outline-3">
<h3 id="orgb7657d4"><a href="#orgb7657d4"><a href="https://zenn.dev/yukito0616/articles/d3b7032e9f1e90">Only My Rails Way</a></a></h3>
<div class="outline-text-3" id="text-orgb7657d4">
<p>
Rails Wayã®å®šç¾©ã«ã¤ã„ã¦ã€‚
</p>
</div>
</div>
<div id="outline-container-org2b30247" class="outline-3">
<h3 id="org2b30247"><a href="#org2b30247"><a href="https://discuss.rubyonrails.org/">Ruby on Rails Discussions - Ruby on Rails Discussions</a></a></h3>
<div class="outline-text-3" id="text-org2b30247">
<p>
Railsé–‹ç™ºã®ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã€‚
</p>
</div>
</div>
<div id="outline-container-orgd40bca5" class="outline-3">
<h3 id="orgd40bca5"><a href="#orgd40bca5"><a href="https://www.slideshare.net/ockeghem/ruby-on-rails-security-142250872">Railsã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ãŸã‚ã®ã‚¦ã‚§ãƒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å…¥é–€</a></a></h3>
<div class="outline-text-3" id="text-orgd40bca5">
<p>
ã‚ã‹ã‚Šã‚„ã™ã„ã‚¹ãƒ©ã‚¤ãƒ‰ã€‚
</p>
</div>
</div>
<div id="outline-container-org6dfdc9b" class="outline-3">
<h3 id="org6dfdc9b"><a href="#org6dfdc9b"><a href="https://techracho.bpsinc.jp/hachi8833/2020_05_13/91211">Railsé–‹ç™ºè€…ãŒæ¡ç”¨é¢æ¥ã§èã‹ã‚Œã‚‹æƒ³å®šQ&amp;A 53å•ï¼ˆç¿»è¨³ï¼‰ï½œTechRacho by BPSæ ªå¼ä¼šç¤¾</a></a></h3>
<div class="outline-text-3" id="text-org6dfdc9b">
<p>
ã¡ã‚ƒã‚“ã¨Railsã‚¬ã‚¤ãƒ‰ã‚’èª­ã¾ãªã„ã¨ãã¤ã„ãªã€‚
</p>
</div>
</div>
</div>
<div id="outline-container-org3e5f72d" class="outline-2">
<h2 id="org3e5f72d"><a href="#org3e5f72d">Backlinks</a></h2>
<div class="outline-text-2" id="text-org3e5f72d">
<ul class="org-ul">
<li><a href="./20210508234743-emacs.html">Emacs</a></li>
<li><a href="./20210509095513-ruby.html">Ruby</a></li>
<li><a href="./20210509095946-rails.html">Rails</a></li>
<li><a href="./20210805005543-docker.html">Docker</a></li>
<li><a href="./20210817003906-history.html">History</a></li>
<li><a href="./20210831223434-rspec.html">RSpec</a></li>
<li><a href="./20210911113057-go.html">Go</a></li>
<li><a href="./20211217165855-web_api.html">Web API</a></li>
<li><a href="./20220113160623-network.html">network</a></li>
<li><a href="./20220126105030-deploy.html">deploy</a></li>
<li><a href="./20220414183922-nginx.html">Nginx</a></li>
<li><a href="./20220420223822-memcached.html">memcached</a></li>
<li><a href="./20220420225811-redis.html">Redis</a></li>
<li><a href="./20220521112115-ecs.html">ECS</a></li>
<li><a href="./20221119T014132--kdoc-6-æ•™è‚²ã‚µãƒ¼ãƒ“ã‚¹ä¼šç¤¾ã‚’é€€è·ã—ãŸ__essay.html">KDOC 6: æ•™è‚²ã‚µãƒ¼ãƒ“ã‚¹ä¼šç¤¾ã‚’é€€è·ã—ãŸ</a></li>
<li><a href="./20221119T014335--kdoc-7-ãƒ‰ãƒ­ãƒ¼ãƒ³ãƒ»åœ°å›³é–¢ä¿‚ã®ä¼šç¤¾ã«å…¥ç¤¾ã—ãŸ__essay.html">KDOC 7: ãƒ‰ãƒ­ãƒ¼ãƒ³ãƒ»åœ°å›³é–¢ä¿‚ã®ä¼šç¤¾ã«å…¥ç¤¾ã—ãŸ</a></li>
<li><a href="./20230119001157-openapi.html">OpenAPI</a></li>
<li><a href="./20250501T192423--kdoc-355-ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’ä»•äº‹ã®æ¢ƒå­ã¨ã—ã¦ä½¿ã†ã¨ã‚ˆã„__essay.html">KDOC 355: ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’ä»•äº‹ã®æ¢ƒå­ã¨ã—ã¦ä½¿ã†ã¨ã‚ˆã„</a></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<footer class="footer py-3"><div class="container"><div class="row "><div class="col-md-4"></div><div class="col-sm col-md"><nav class="navbar"><a class="nav-link text-secondary small px-0" href="./index.html">Insomnia</a><a class="nav-link text-secondary small px-0" href="./sitemap.html">Sitemap</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD/roam">Repository</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD">@kijimaD</a></nav></div><div class="col-md-4"></div></div></div></footer>
</div>
</body>
</html>
