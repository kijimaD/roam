:PROPERTIES:
:ID:       b4f456cf-d250-4877-ac4c-4b03144392f0
:header-args+: :wrap
:END:
#+title: GraphQL
* æ¦‚è¦
GraphQLã¯APIå‘ã‘ã«ä½œã‚‰ã‚ŒãŸã‚¯ã‚¨ãƒªè¨€èª([[id:8b69b8d4-1612-4dc5-8412-96b431fdd101][SQL]]ã¨åŒã˜ã‚¸ãƒ£ãƒ³ãƒ«)ã€å®Ÿè¡Œç’°å¢ƒã§ã‚ã‚‹ã€‚

å¾“æ¥ã®RESTã§ã¯äº‹å‰ã«æ±ºã‚ã‚‰ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã‚’URLã‚’æŒ‡å®šã—ã¦å–å¾—ã™ã‚‹ã®ã«å¯¾ã—ã€GraphQLã§ã¯å¿…è¦ãªã‚‚ã®ã‚’æŒ‡å®šã§ãã‚‹ã€‚
è¤‡æ•°ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’å–å¾—ã™ã‚‹ã¨ãã€RESTã§ã¯ãã‚Œãã‚ŒAPIã‚’å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚‹ãŒã€GraphQLã§ã¯1å›ã®APIå‘¼ã³å‡ºã—ã§å®Œäº†ã™ã‚‹ã€‚
[[id:dc50d818-d7d1-48a8-ad76-62ead617c670][React]]ãªã©ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ã•ã‚Œã‚‹ã€‚
* åŸºæœ¬ç”¨èª
** ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã™ã‚‹ã€‚
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã«ä½œæˆã™ã‚‹ã€‚
ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ä½¿ã‚ã‚Œã‚‹å‹•è©ã¨å¯¾å¿œã™ã‚‹ã®ãŒæœ›ã¾ã—ã„ã€‚
ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã—ã¦ã§ãã‚‹ã“ã¨ãŒãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦å®šç¾©ã•ã‚Œã‚‹ã€‚

#+caption: ãƒ«ãƒ¼ãƒˆå‹ã®Mutationã«å¯¾ã—ã¦ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã€å†™çœŸã«ã‚¿ã‚°ã‚’ã¤ã‘ã‚‹
#+begin_src graphql :url
  type Mutation {
    postPhoto(
      name: String!
      description: String
      category: PhotoCategory=PORTRAIT
    ): Photo!
  }

  schema {
    query: Query
    mutation: Mutation
  }
#+end_src

#+caption: ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œã®ä¾‹
#+begin_src graphql :url
  mutation {
    postPhoto(name: "Sending the Palisades") {
      id
      url
      created
      postedBy {
        name
      }
    }
  }
#+end_src
** ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ
ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆã¯è¤‡æ•°ã®å ´æ‰€ã§ä½¿ã„ã¾ã‚ã™ã“ã¨ãŒã§ãã‚‹é¸æŠã‚»ãƒƒãƒˆã€‚

#+caption: ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆã®ä¾‹
#+begin_src graphql
  query {
    allTrails {
      ...trailStatus
      ...trailDetails
    }
  }
#+end_src
** ã‚¯ã‚¨ãƒªå¤‰æ•°
  ã‚¯ã‚¨ãƒªå†…ã®é™çš„ãªå€¤ã‚’ç½®ãæ›ãˆã¦å‹•çš„ãªå€¤ã‚’æ¸¡ã›ã‚‹ã€‚
** ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³
  ã‚µãƒ¼ãƒã‚’æ›´æ–°ã™ã‚‹ãŸã³ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§æƒ…å ±ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«å—ã‘å–ã‚‹ã€‚

#+caption: ã¾ãšã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã™ã‚‹
#+begin_src graphql :url http://snowtooth.moonhighway.com/
  subscription {
    liftStatusChange {
      name
      capacity
      status
    }
  }
#+end_src

#+RESULTS:
#+begin_results
{
  "data": {
    "liftStatusChange": null
  }
}
#+end_results

#+caption: å¤‰æ›´ã™ã‚‹
#+begin_src graphql :url http://snowtooth.moonhighway.com/
  mutation closeLift {
    setLiftStatus(id: "astra-express" status: HOLD) {
      name
      status
    }
  }
#+end_src

#+RESULTS:
#+begin_results
{
  "data": {
    "setLiftStatus": {
      "name": "Astra Express",
      "status": "HOLD"
    }
  }
}
#+end_results

å¤‰æ›´å†…å®¹ãŒã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã—ã¦ã„ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å‘ã‘ã¦ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚Œã‚‹ã€‚
** ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³
APIã‚¹ã‚­ãƒ¼ãƒã®è©³ç´°ã‚’å–å¾—ã§ãã‚‹æ©Ÿèƒ½ã€‚

#+caption: ã‚µãƒ³ãƒ—ãƒ«APIã®APIã‚¹ã‚­ãƒ¼ãƒã‚’å–å¾—ã™ã‚‹
#+begin_src graphql :url http://snowtooth.moonhighway.com/
  query {
    __schema {
      types {
        name
        description
      }
    }
  }
#+end_src

#+RESULTS:
#+begin_results
{
  "data": {
    "__schema": {
      "types": [
        {
          "name": "Lift",
          "description": "A `Lift` is a chairlift, gondola, tram, funicular, pulley, rope tow, or other means of ascending a mountain."
        },
        {
          "name": "ID",
          "description": "The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `\"4\"`) or integer (such as `4`) input value will be accepted as an ID."
        },
        {
          "name": "String",
          "description": "The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text."
        },
        {
          "name": "Int",
          "description": "The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1."
        },
        {
          "name": "Boolean",
          "description": "The `Boolean` scalar type represents `true` or `false`."
        },
        {
          "name": "Trail",
          "description": "A `Trail` is a run at a ski resort"
        },
        {
          "name": "LiftStatus",
          "description": "An enum describing the options for `LiftStatus`: `OPEN`, `CLOSED`, `HOLD`"
        },
        {
          "name": "TrailStatus",
          "description": "An enum describing the options for `TrailStatus`: `OPEN`, `CLOSED`"
        },
        {
          "name": "SearchResult",
          "description": "This union type returns one of two types: a `Lift` or a `Trail`. When we search for a letter, we'll return a list of either `Lift` or `Trail` objects."
        },
        {
          "name": "Query",
          "description": null
        },
        {
          "name": "Mutation",
          "description": null
        },
        {
          "name": "Subscription",
          "description": null
        },
        {
          "name": "CacheControlScope",
          "description": null
        },
        {
          "name": "Upload",
          "description": "The `Upload` scalar type represents a file upload."
        },
        {
          "name": "__Schema",
          "description": "A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations."
        },
        {
          "name": "__Type",
          "description": "The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name, description and optional `specifiedByUrl`, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types."
        },
        {
          "name": "__TypeKind",
          "description": "An enum describing what kind of type a given `__Type` is."
        },
        {
          "name": "__Field",
          "description": "Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type."
        },
        {
          "name": "__InputValue",
          "description": "Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value."
        },
        {
          "name": "__EnumValue",
          "description": "One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string."
        },
        {
          "name": "__Directive",
          "description": "A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document.\n\nIn some cases, you need to provide options to alter GraphQL's execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor."
        },
        {
          "name": "__DirectiveLocation",
          "description": "A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies."
        }
      ]
    }
  }
}
#+end_results

#+caption: ç‰¹å®šã®å‹ã®è©³ç´°ã€‚Liftå‹ã§æŒ‡å®šã§ãã‚‹ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’çŸ¥ã‚‹ã“ã¨ãŒã§ãã‚‹
#+begin_src graphql :url http://snowtooth.moonhighway.com/
  query liftDetails {
    __type(name: "Lift") {
      name
      fields {
        name
        description
        type {
          name
        }
      }
    }
  }
#+end_src

#+RESULTS:
#+begin_results
{
  "data": {
    "__type": {
      "name": "Lift",
      "fields": [
        {
          "name": "id",
          "description": "The unique identifier for a `Lift` (id: \"panorama\")",
          "type": {
            "name": null
          }
        },
        {
          "name": "name",
          "description": "The name of a `Lift`",
          "type": {
            "name": null
          }
        },
        {
          "name": "status",
          "description": "The current status for a `Lift`: `OPEN`, `CLOSED`, `HOLD`",
          "type": {
            "name": "LiftStatus"
          }
        },
        {
          "name": "capacity",
          "description": "The number of people that a `Lift` can hold",
          "type": {
            "name": null
          }
        },
        {
          "name": "night",
          "description": "A boolean describing whether a `Lift` is open for night skiing",
          "type": {
            "name": null
          }
        },
        {
          "name": "elevationGain",
          "description": "The number of feet in elevation that a `Lift` ascends",
          "type": {
            "name": null
          }
        },
        {
          "name": "trailAccess",
          "description": "A list of trails that this `Lift` serves",
          "type": {
            "name": null
          }
        }
      ]
    }
  }
}
#+end_results
** ã‚¹ã‚­ãƒ¼ãƒ
GraphQLã«ã‚ˆã£ã¦ã€APIã¯å‹ã®é›†åˆã¨ã—ã¦ã¨ã‚‰ãˆã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚
ãƒ‡ãƒ¼ã‚¿å‹ã®é›†åˆã‚’ã‚¹ã‚­ãƒ¼ãƒã¨ã„ã†ã€‚
** ãƒ¦ãƒ‹ã‚ªãƒ³å‹ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹
ç•°ãªã‚‹å‹ãŒæ··åœ¨ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¡¨ç¾ã™ã‚‹ã®ã«ä½¿ã†ã€‚
å«ã¾ã‚Œã¦ã„ã‚‹è¤‡æ•°ã®å‹ãŒã¾ã£ãŸãç•°ãªã‚‹ã‚‚ã®ã§ã‚ã‚Œã°ãƒ¦ãƒ‹ã‚ªãƒ³å‹ã‚’ã€å…±é€šã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚‹å ´åˆã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’åˆ©ç”¨ã™ã‚‹ã®ãŒä¸€èˆ¬çš„ã€‚
** ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
#+caption: ãƒˆãƒªãƒ—ãƒ«ã‚¯ã‚ªãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
#+begin_src graphql :url
  """
  æœ€ä½ä¸€åº¦ã¯èªå¯ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶
  """
  type User {

    """
    ãƒ¦ãƒ¼ã‚¶ã®ä¸€æ„ã®GitHubãƒ­ã‚°ã‚¤ãƒ³ID
    """
    githubLogin: ID!

    """
    ãƒ¦ãƒ¼ã‚¶ã®å§“å
    """
    name: String

    """
    ã“ã®ãƒ¦ãƒ¼ã‚¶ãŒæŠ•ç¨¿ã—ãŸå…¨å†™çœŸ
    """
    postedPhotos: [Photo!]!

    """
    ã“ã®ãƒ¦ãƒ¼ã‚¶ãŒå«ã¾ã‚Œã‚‹å…¨å†™çœŸ
    """
    inPhotos: [Photo!]!
  }

  type Mutation {
    """
    GitHubãƒ¦ãƒ¼ã‚¶ã§èªå¯
    """
    githubAuth(
      "ãƒ¦ãƒ¼ã‚¶ã®èªå¯ã®ãŸã‚ã«é€ä¿¡ã•ã‚Œã‚‹GitHubã®ä¸€æ„ã®ã‚³ãƒ¼ãƒ‰"
      code: String!
    ): AuthPayload!
  }
#+end_src
* [[id:1ad8c3d5-97ba-4905-be11-e6f2626127ad][Emacs]]è¨­å®š
[[id:1ad8c3d5-97ba-4905-be11-e6f2626127ad][Emacs]]ã§ã‚³ãƒ¼ãƒ‰ã€ã‚¯ã‚¨ãƒªã‚¢ã‚¯ã‚»ã‚¹ã€çµæœå‡ºåŠ›ã‚’ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§æ®‹ã™è¨­å®šã€‚

graphql-modeã‚’è¿½åŠ ã™ã‚‹ã€‚
[[https://github.com/davazp/graphql-mode][davazp/graphql-mode: An Emacs mode for GraphQL]]

ob-graphqlã‚’è¿½åŠ ã™ã‚‹ã€‚
[[https://github.com/jdormit/ob-graphql][jdormit/ob-graphql: GraphQL execution backend for org-babel]]

#+BEGIN_SRC graphql :url https://countries.trevorblades.com/
  query GetContinents {
      continent(code: "AF") {
          name
      code
      }
  }
#+END_SRC

#+RESULTS:
#+begin_results
{
  "data": {
    "continent": {
      "name": "Africa",
      "code": "AF"
    }
  }
}
#+end_results
* Tasks
** TODO [[https://www.amazon.co.jp/%E5%88%9D%E3%82%81%E3%81%A6%E3%81%AEGraphQL-%E2%80%95Web%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%A6%E5%AD%A6%E3%81%B6%E6%96%B0%E4%B8%96%E4%BB%A3API-Eve-Porcello/dp/487311893X/ref=sr_1_1?__mk_ja_JP=%E3%82%AB%E3%82%BF%E3%82%AB%E3%83%8A&crid=30T3XVSFJABS3&keywords=Graphql&qid=1640733838&sprefix=graphql%2Caps%2C203&sr=8-1][åˆã‚ã¦ã®GraphQL â€•Webã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œã£ã¦å­¦ã¶æ–°ä¸–ä»£API]]
:LOGBOOK:
CLOCK: [2022-01-07 Fri 10:42]--[2022-01-07 Fri 11:01] =>  0:19
CLOCK: [2022-01-06 Thu 23:56]--[2022-01-07 Fri 01:14] =>  1:18
CLOCK: [2022-01-06 Thu 10:40]--[2022-01-06 Thu 11:19] =>  0:39
CLOCK: [2022-01-05 Wed 22:36]--[2022-01-05 Wed 22:53] =>  0:17
CLOCK: [2022-01-05 Wed 10:01]--[2022-01-05 Wed 10:54] =>  0:53
CLOCK: [2022-01-04 Tue 15:22]--[2022-01-04 Tue 16:38] =>  1:16
CLOCK: [2022-01-04 Tue 13:56]--[2022-01-04 Tue 14:44] =>  0:48
:END:

- 86, 100, 124, 147, 185, 190, 197

å®Ÿéš›ã«ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦æ›¸ã„ã¦ã„ãã®ã«ã¯ã‚ã¾ã‚Šè©•åˆ¤ãŒã‚ˆããªã„ã€‚æ¦‚è¦ã‚’çŸ¥ã‚‹ãŸã‚ã«ã¯å½¹ç«‹ã¤ã‚ˆã†ã€‚
ã‚³ãƒ¼ãƒ‰ã‚µãƒ³ãƒ—ãƒ«ã¯[[id:a6980e15-ecee-466e-9ea7-2c0210243c0d][JavaScript]]ãªã®ã§ã€çŸ¥ã‚‰ãªã„ã¨å°‘ã—å³ã—ã„æ„Ÿã˜ã€‚

ã‚°ãƒ©ãƒ•ç†è«–ã€‚ã‚°ãƒ©ãƒ•ã¯æ¦‚å¿µåŒå£«ã®é–¢ä¿‚æ€§ã‚’å›³ç¤ºã™ã‚‹ãŸã‚ã®å„ªã‚ŒãŸè€ƒãˆæ–¹ã€‚
[[id:8b69b8d4-1612-4dc5-8412-96b431fdd101][SQL]]ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãŸã‚ã®å•ã„åˆã‚ã›è¨€èªã§ã€GraphQLã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã®ãŸã‚ã®å•ã„åˆã‚ã›è¨€èªã€‚
** TODO [[https://zenn.dev/slowhand/articles/4fe99377185100][Rails + GraphQLã§APIä½œæˆ]]
[[id:e04aa1a3-509c-45b2-ac64-53d69c961214][Rails]] + GraphQLã§ä¸€é€šã‚Šæ¦‚è¦ã‚’çŸ¥ã‚‹æœ€æ–°ã®ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦ã‚ˆã•ãã†ã€‚
* Reference
** [[https://github.com/graphql/graphql-playground][graphql/graphql-playground: ğŸ® GraphQL IDE for better development workflows (GraphQL Subscriptions, interactive docs & collaboration)]]
graphqlã®ã‚µãƒ³ãƒ—ãƒ«ã€‚
** [[https://github.com/graphql/graphiql][graphql/graphiql: GraphiQL & the GraphQL LSP Reference Ecosystem for building browser & IDE tools.]]
graphqlã®ã‚µãƒ³ãƒ—ãƒ«ã€‚
** [[https://docs.github.com/en/graphql/overview/explorer][Explorer - GitHub Docs]]
GitHubã®GraphQL APIã€‚
** [[https://dev.to/vaidehijoshi/a-gentle-introduction-to-graph-theory][A Gentle Introduction To Graph Theory - DEV Community]]
ãƒãƒ¼ãƒ‰ã¨ã‚¨ãƒƒã‚¸ã«ã¤ã„ã¦ã®ãƒ–ãƒ­ã‚°è¨˜äº‹ã€‚
** [[https://graphql.org/swapi-graphql/][SWAPI GraphQL API]]
ã‚µãƒ³ãƒ—ãƒ«ã§ã©ã‚“ãªæ„Ÿã˜ã‹ãƒ†ã‚¹ãƒˆã§ãã‚‹ã‚µã‚¤ãƒˆã€‚
ã‚¹ã‚¿ãƒ¼ã‚¦ã‚©ãƒ¼ã‚ºã®æƒ…å ±ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚

#+caption: ã‚µãƒ³ãƒ—ãƒ«
#+begin_src graphql :url https://graphql.org/swapi-graphql/
  query {
    person(personID: 5){
      name
      birthYear
      created
      filmConnection {
        films {
          title
        }
      }
    }
  }
#+end_src

#+RESULTS:
#+begin_results
null
#+end_results
** [[https://ja.wikipedia.org/wiki/GraphQL][GraphQL - Wikipedia]]
* Archives
