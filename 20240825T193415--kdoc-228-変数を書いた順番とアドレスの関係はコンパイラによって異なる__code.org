:properties:
:ID: 20240825T193415
:mtime:    20241102180341 20241028101410
:ctime:    20241028101410
:end:
#+title:      KDOC 228: å¤‰æ•°ã‚’æ›¸ã„ãŸé †ç•ªã¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã®é–¢ä¿‚ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã‚ˆã£ã¦ç•°ãªã‚‹
#+date:       [2024-08-25 Sun 19:34]
#+filetags:   :code:
#+identifier: 20240825T193415

* ã“ã®æ–‡æ›¸ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
- ä½œæˆ
  - [X] 2024-08-25 è²´å³¶
- ãƒ¬ãƒ“ãƒ¥ãƒ¼
  - [X] 2024-09-09 è²´å³¶

* æ¦‚è¦
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã‚ˆã£ã¦ã€ã‚³ãƒ¼ãƒ‰ã§å¤‰æ•°ã‚’åˆæœŸåŒ–ã—ãŸé †ç•ªã¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã®é †ç•ªã¯ç•°ãªã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚

æœ€åˆã«ã€gccã€‚

#+caption: å¤‰æ•°ã®ç•ªåœ°ã‚’è¡¨ç¤ºã™ã‚‹
#+begin_src C
  int main() {
    char base = 0;
    char a = 'a';
    char b = 'b';
    char c = 'c';

    printf("%p: base\n", &base);
    printf("%p: a\n", &a);
    printf("%p: b\n", &b);
    printf("%p: c\n", &c);
  }
#+end_src

#+RESULTS:
#+begin_src
0x7fffa55f0a84: base
0x7fffa55f0a85: a
0x7fffa55f0a86: b
0x7fffa55f0a87: c
#+end_src

ã¤ã¾ã‚Šã€ãƒ¡ãƒ¢ãƒªã¯â†“ã“ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã‚‹ã€‚ã‚³ãƒ¼ãƒ‰ã§å¤‰æ•°ã‚’åˆæœŸåŒ–ã—ãŸé †ç•ªã¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã®é †ç•ªãŒä¸€è‡´ã—ã¦ã„ã‚‹ã€‚ã‚¹ã‚¿ãƒƒã‚¯ã ã‹ã‚‰ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ›¸ã„ãŸé€†é †ã«ãªã‚‹ã€ã¨ã„ã†ã‚ã‘ã§ã¯ãªã„ã€‚

#+caption: å…ˆã«æ›¸ã„ãŸå¤‰æ•°(base)ãŒä½ä½ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãªã‚‹
#+begin_src shell
  ^ç•ªåœ°å°(ä½)

  | ...84: base |
  | ...85: a |
  | ...86: b |
  | ...87: c |

  vç•ªåœ°å¤§(é«˜)
#+end_src

ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€(ä½)base, a, b, c(é«˜)é †ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãªã£ã¦ã„ã‚‹ã®ã‚’ç¢ºèªã§ããŸã€‚

#+caption: æ‰‹å…ƒã®gccã§-Sã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã£ã¦å‡ºåŠ›ã—ãŸ
#+begin_src asm
          .file	"main.c"
          .text
          .section	.rodata
  .LC0:
          .string	"%p: base\n"
  .LC1:
          .string	"%p: a\n"
  .LC2:
          .string	"%p: b\n"
  .LC3:
          .string	"%p: c\n"
          .text
          .globl	main
          .type	main, @function
  main:
  .LFB0:
          .cfi_startproc
          endbr64
          pushq	%rbp
          .cfi_def_cfa_offset 16
          .cfi_offset 6, -16
          movq	%rsp, %rbp
          .cfi_def_cfa_register 6
          subq	$16, %rsp
          movq	%fs:40, %rax
          movq	%rax, -8(%rbp)
          xorl	%eax, %eax
          movb	$0, -12(%rbp)  ; ğŸ‘ˆ
          movb	$97, -11(%rbp) ; ğŸ‘ˆ
          movb	$98, -10(%rbp) ; ğŸ‘ˆ
          movb	$99, -9(%rbp)  ; ğŸ‘ˆ
          leaq	-12(%rbp), %rax
          movq	%rax, %rsi
          leaq	.LC0(%rip), %rax
          movq	%rax, %rdi
          movl	$0, %eax
          call	printf@PLT
          leaq	-11(%rbp), %rax
          movq	%rax, %rsi
          leaq	.LC1(%rip), %rax
          movq	%rax, %rdi
          movl	$0, %eax
          call	printf@PLT
          leaq	-10(%rbp), %rax
          movq	%rax, %rsi
          leaq	.LC2(%rip), %rax
          movq	%rax, %rdi
          movl	$0, %eax
          call	printf@PLT
          leaq	-9(%rbp), %rax
          movq	%rax, %rsi
          leaq	.LC3(%rip), %rax
          movq	%rax, %rdi
          movl	$0, %eax
          call	printf@PLT
          movl	$0, %eax
          movq	-8(%rbp), %rdx
          subq	%fs:40, %rdx
          je	.L3
          call	__stack_chk_fail@PLT
  .L3:
          leave
          .cfi_def_cfa 7, 8
          ret
          .cfi_endproc
  .LFE0:
          .size	main, .-main
          .ident	"GCC: (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0"
          .section	.note.GNU-stack,"",@progbits
          .section	.note.gnu.property,"a"
          .align 8
          .long	1f - 0f
          .long	4f - 1f
          .long	5
  0:
          .string	"GNU"
  1:
          .align 8
          .long	0xc0000002
          .long	3f - 2f
  2:
          .long	0x3
  3:
          .align 8
  4:

    --------------------------------
    |-12(%rbp): base |
    |-11(%rbp): a |
    |-10(%rbp): b |
    | -9(%rbp): c |
#+end_src

ã„ã£ã½ã†clangã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ãŸå ´åˆã€å…ˆã«æ›¸ã„ãŸå¤‰æ•°ãŒé«˜ä½ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãªã‚‹ã€‚

#+caption: clangã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦å®Ÿè¡Œã—ãŸçµæœã€‚å…ˆã«æ›¸ã„ãŸå¤‰æ•°ãŒé«˜ä½ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãªã‚‹
#+begin_src shell
  0x7ffe71de7317: base
  0x7ffe71de7316: a
  0x7ffe71de7315: b
  0x7ffe71de7314: c

  --------------------
  ^ç•ªåœ°å°(ä½)

  | ...14: c |
  | ...15: b |
  | ...16: a |
  | ...17: base |

  vç•ªåœ°å¤§(é«˜)
#+end_src

ã¤ã¾ã‚Šã€ã‚³ãƒ¼ãƒ‰ã§å¤‰æ•°ã‚’åˆæœŸåŒ–ã—ãŸé †ç•ªã¨ã€ã‚¢ãƒ‰ãƒ¬ã‚¹ã®é †ç•ªã¯å¿…ãšã—ã‚‚é€†ã«ã¯ãªã‚‰ãªã„ã“ã¨ãŒã‚ã‚‹ã€‚ãªãœãã†ãªã‚‹ã®ã‹ã¯ã€ã„ã¤ã‹èª¿ã¹ã‚‹ã€‚

* é–¢é€£
- [[id:20240824T190333][KDOC 226: ä»»æ„ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«èª­ã¿æ›¸ãã™ã‚‹]]ã€‚èª¿ã¹ã¦ã„ã‚‹é€”ä¸­ã§ç™ºè¦‹ã—ãŸ
