<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2024-11-08 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>KDOC 229: 浮動小数点を手計算する</title>
<meta name="author" content="root" />
<meta name="generator" content="Org Mode" />
<link rel='shortcut icon' type='image/x-icon' href='/roam/favicon.ico' /><link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css' /><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css' /><link rel='stylesheet' href='../css/site.css' /><link rel='stylesheet' href='../roam/css/code.css' /><link rel='stylesheet' href='css/site.css' /><link rel='stylesheet' href='css/code.css' />
</head>
<body>
<div id="preamble" class="status">
<div><div class="header"><div class="container"><div class="row"><div class="col-sm-12 col-md-12"><nav class="navbar navbar-light"/></div></div></div></div></div>
</div>
<div id="content" class="content">
<h1 class="title">KDOC 229: 浮動小数点を手計算する</h1>

<div id="outline-container-org3f74b5a" class="outline-2">
<h2 id="org3f74b5a"><a href="#org3f74b5a">この文書のステータス</a></h2>
<div class="outline-text-2" id="text-org3f74b5a">
<ul class="org-ul">
<li>作成
<ul class="org-ul">
<li class="on"><input type='checkbox' checked='checked' /> 2024-08-27 貴島</li>
</ul></li>
<li>レビュー
<ul class="org-ul">
<li class="on"><input type='checkbox' checked='checked' /> 2024-09-03 貴島</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org73d07e0" class="outline-2">
<h2 id="org73d07e0"><a href="#org73d07e0">概要</a></h2>
<div class="outline-text-2" id="text-org73d07e0">
<p>
浮動小数点がどのように表現されるのが、わかっていなかった。手で計算して、確かめる。
</p>
</div>
</div>

<div id="outline-container-orga69d834" class="outline-2">
<h2 id="orga69d834"><a href="#orga69d834">0d0.5</a></h2>
<div class="outline-text-2" id="text-orga69d834">
<p>
10進数の0.5を浮動小数点で表示する。
</p>

<ul class="org-ul">
<li>0d0.5
<ul class="org-ul">
<li>小数部分</li>
<li>0b0.101</li>
<li>0b1.01 (小数点を右へ1つ動かす -1)</li>
</ul></li>
<li>数値 = - 1.{仮数部} x 2^{指数部+バイアス}</li>
<li>- 1.{0} × 2^{-1+127}</li>
<li>仮数部は常に1.から始まるため、その1は明示的に表示されない</li>
<li>小数点を動かした数は-0b1。オフセットバイナリで、0b0が0d-127を示すようになっている。正の数を示すには、127を足す必要がある。バイアス0d127(0b0111 1111)を足す。指数部は0b0111 1110となる</li>
<li>つまり符号は正、指数部は0b0111 1110、仮数部は0となる。</li>
<li>0 0111 1110 000 0000 0000 0000 0000 0000</li>
<li>0011 1111 0000 0000 0000 0000 0000 0000</li>
<li>3    f    0    0    0    0    0    0</li>
</ul>

<iframe width="800px" height="200px" src="https://godbolt.org/e#g:!((g:!((g:!((h:codeEditor,i:(filename:'1',fontScale:14,fontUsePx:'0',j:1,lang:___c,selection:(endColumn:20,endLineNumber:2,positionColumn:20,positionLineNumber:2,selectionStartColumn:20,selectionStartLineNumber:2,startColumn:20,startLineNumber:2),source:'int+main()+%7B%0A++++float+f1+%3D+0.5%3B%0A%7D'),l:'5',n:'1',o:'C+source+%231',t:'0')),k:50,l:'4',n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:cclang_trunk,filters:(b:'0',binary:'1',binaryObject:'1',commentOnly:'0',debugCalls:'1',demangle:'0',directives:'0',execute:'1',intel:'1',libraryCode:'0',trim:'0',verboseDemangling:'0'),flagsViewOpen:'1',fontScale:14,fontUsePx:'0',j:1,lang:___c,libs:!(),options:'',overrides:!(),selection:(endColumn:1,endLineNumber:1,positionColumn:1,positionLineNumber:1,selectionStartColumn:1,selectionStartLineNumber:1,startColumn:1,startLineNumber:1),source:1),l:'5',n:'0',o:'+x86-64+clang+(trunk)+(Editor+%231)',t:'0')),k:50,l:'4',n:'0',o:'',s:0,t:'0')),l:'2',n:'0',o:'',t:'0')),version:4"></iframe>
</div>
</div>
<div id="outline-container-orgba5bcd6" class="outline-2">
<h2 id="orgba5bcd6"><a href="#orgba5bcd6">0d1</a></h2>
<div class="outline-text-2" id="text-orgba5bcd6">
<p>
10進数の1を浮動小数点で表示する。
</p>

<ul class="org-ul">
<li>0d1</li>
<li>0b1</li>
<li>0 x 1.{0} x 2^{0+127}</li>
<li>符号は正で0</li>
<li>指数部は0 + 0b0111 1111</li>
<li>仮数部は0</li>
<li>0 0111 1111 000 0000 0000 0000 0000 0000</li>
<li>0011 1111 1000 0000 0000 0000 0000 0000</li>
<li>3    f    8    0    0    0    0    0</li>
</ul>
</div>
</div>
<div id="outline-container-orgfa24e37" class="outline-2">
<h2 id="orgfa24e37"><a href="#orgfa24e37">0d2</a></h2>
<div class="outline-text-2" id="text-orgfa24e37">
<p>
10進数の2を浮動小数点で表示する。
</p>

<ul class="org-ul">
<li>0d2</li>
<li>0b10</li>
<li>0b1.0 (小数点を左に1つ動かす +1)</li>
<li>0 x 1.{0} x 2^{1+127}</li>
<li>符号は正で0</li>
<li>指数部は1 + 0b0111 1111 = 0b1000 0000</li>
<li>仮数部は0</li>
<li>0 1000 0000 000 0000 0000 0000 0000 0000</li>
<li>0100 0000 0000 0000 0000 0000 0000 0000</li>
<li>4    0    0    0    0    0    0    0</li>
</ul>
</div>
</div>
<div id="outline-container-org0e98b99" class="outline-2">
<h2 id="org0e98b99"><a href="#org0e98b99">0d3</a></h2>
<div class="outline-text-2" id="text-org0e98b99">
<p>
10進数の3を浮動小数点で表示する。
</p>

<ul class="org-ul">
<li>0d3</li>
<li>0b11</li>
<li>0b1.1 (小数点を左に1つ動かす +1)</li>
<li>0 x 1.{1} x 2^{1+127}</li>
<li>符号は正で0</li>
<li>指数部は1 + 0b0111 1111 = 0b1000 0000</li>
<li>仮数部は1</li>
<li>0 1000 0000 100 0000 0000 0000 0000 0000</li>
<li>0100 0000 0100 0000 0000 0000 0000 0000</li>
<li>4    0    4    0    0    0    0    0</li>
</ul>
</div>
</div>
<div id="outline-container-orgc1e4f92" class="outline-2">
<h2 id="orgc1e4f92"><a href="#orgc1e4f92">0d4</a></h2>
<div class="outline-text-2" id="text-orgc1e4f92">
<p>
10進数の4を浮動小数点で表示する。
</p>

<ul class="org-ul">
<li>0d4</li>
<li>0b100</li>
<li>0b1.00 (小数点を左に2つ動かす +2)</li>
<li>0 x 1.{0} x 2^{2+127}</li>
<li>符号は正で0</li>
<li>指数部は2 + 0b0111 1111 = 0b1000 0001</li>
<li>仮数部は0</li>
<li>0 1000 0001 000 0000 0000 0000 0000 0000</li>
<li>0100 0000 1000 0000 0000 0000 0000 0000</li>
<li>4    0    8    0    0    0    0    0</li>
</ul>
</div>
</div>
<div id="outline-container-org2a83a5e" class="outline-2">
<h2 id="org2a83a5e"><a href="#org2a83a5e">0d5</a></h2>
<div class="outline-text-2" id="text-org2a83a5e">
<p>
10進数の5を浮動小数点で表示する。
</p>

<ul class="org-ul">
<li>0d5</li>
<li>0b101</li>
<li>0b1.01 (小数点を左に2つ動かす +2)</li>
<li>0 x 1.{1} x 2^{2+127}</li>
<li>符号は正で0</li>
<li>指数部は2 + 0b0111 1111 = 0b1000 0001</li>
<li>仮数部は2</li>
<li>0 1000 0001 010 0000 0000 0000 0000 0000</li>
<li>0100 0000 1010 0000 0000 0000 0000 0000</li>
<li>4    0    a    0    0    0    0    0</li>
</ul>
</div>
</div>
<div id="outline-container-org000b98e" class="outline-2">
<h2 id="org000b98e"><a href="#org000b98e">0d0.25</a></h2>
<div class="outline-text-2" id="text-org000b98e">
<p>
10進数の0.25を浮動小数点で表示する。
</p>

<ul class="org-ul">
<li>0d0.25
<ul class="org-ul">
<li>小数部分</li>
<li>0b0.11001</li>
<li>0b1.1001 (小数点を右に1つ動かす -1)</li>
</ul></li>
<li>0 x 1.{0} x 2^{-1+127}</li>
<li>符号は正で0</li>
<li>指数部は-1 + 0b0111 1111 = 0b0111 1101</li>
<li>仮数部は0</li>
<li>0 0111 1101 000 0000 0000 0000 0000 0000</li>
<li>0011 1110 1000 0000 0000 0000 0000 0000</li>
<li>3    e    8    0    0    0    0    0</li>
</ul>
</div>
</div>
<div id="outline-container-orga749548" class="outline-2">
<h2 id="orga749548"><a href="#orga749548">0d1.5</a></h2>
<div class="outline-text-2" id="text-orga749548">
<p>
10進数の1.5を浮動小数点で表示する。
</p>

<ul class="org-ul">
<li>0d1.5
<ul class="org-ul">
<li>整数部分</li>
<li>0b1</li>
<li>小数部分</li>
<li>0b0.101</li>
<li>合計</li>
<li>0b1.101 (小数点を動かさない 0)</li>
</ul></li>
<li>0 x 1.{4} x 2^{0+127}</li>
<li>符号は正で0</li>
<li>指数部は 0 + 0b0111 1111 = 0b0111 1111</li>
<li>仮数部は0d4(0b100)</li>
<li>0 0111 1111 100 0000 0000 0000 0000 0000</li>
<li>0011 1111 1100 0000 0000 0000 0000 0000</li>
<li>3    f    c    0    0    0    0    0</li>
</ul>
</div>
</div>

<div id="outline-container-orga9a2254" class="outline-2">
<h2 id="orga9a2254"><a href="#orga9a2254">参考</a></h2>
<div class="outline-text-2" id="text-orga9a2254">
<ul class="org-ul">
<li><a href="https://tools.m-bsys.com/calculators/ieee754.php">浮動小数点数内部表現シミュレーター - instant tools</a>
<ul class="org-ul">
<li>ビットずつに答え合わせできる。いくつか試してみるとわかりやすい</li>
</ul></li>
<li><a href="https://www.macnica.co.jp/business/semiconductor/articles/design/133320/">ビットで表す数字の世界～符号編～ - 半導体事業 - マクニカ</a>
<ul class="org-ul">
<li>オフセットバイナリの解説</li>
</ul></li>
<li><a href="https://www.macnica.co.jp/en/business/semiconductor/articles/intel/133327/">ビットで表す数字の世界～浮動小数点編～</a>
<ul class="org-ul">
<li>手続きのわかりやすい解説</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org6f10e94" class="outline-2">
<h2 id="org6f10e94"><a href="#org6f10e94">関連</a></h2>
<div class="outline-text-2" id="text-org6f10e94">
<p>
なし。
</p>
</div>
</div>


<div id="outline-container-org23820d5" class="outline-2">
<h2 id="org23820d5"><a href="#org23820d5">Backlinks</a></h2>
<div class="outline-text-2" id="text-org23820d5">
<ul class="org-ul">
<li><a href="./20240921T111620--kdoc-246-浮動小数点の誤差を体感する__wiki.html">KDOC 246: 浮動小数点の誤差を体感する</a></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<footer class="footer py-3"><div class="container"><div class="row "><div class="col-md-4"></div><div class="col-sm col-md"><nav class="navbar"><a class="nav-link text-secondary small px-0" href="./index.html">Insomnia</a><a class="nav-link text-secondary small px-0" href="./sitemap.html">Sitemap</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD/roam">Repository</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD">@kijimaD</a></nav></div><div class="col-md-4"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"/>
</div>
</body>
</html>
