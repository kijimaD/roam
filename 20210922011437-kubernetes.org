:PROPERTIES:
:ID:       81b73757-21b3-438c-ab65-680b5ad88a1b
:header-args+: :wrap :results raw
:END:
#+title: Kubernetes
* æ¦‚è¦
Kubernetesã¯è¤‡æ•°ã®[[id:1658782a-d331-464b-9fd7-1f8233b8b7f8][Docker]]ã‚³ãƒ³ãƒ†ãƒŠã‚’é€£æºã•ã›ã‚‹ãŸã‚ã®ã‚·ã‚¹ãƒ†ãƒ ã€‚
* Memo
** context
kubectlãŒã€ã©ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ã„ã‚‹ã‹ç¢ºèªã§ãã‚‹ã€‚
#+begin_src shell
kubectl config current-context
#+end_src

#+RESULTS:
#+begin_results
minikube
#+end_results

ã“ã‚Œã¯ã€minikubeã€ã¤ã¾ã‚Šãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®contextã«ã„ã¦ã€Kubernetesã¨ã®é€šä¿¡ã®contextã«ã¯ãªã£ã¦ã„ãªã„ã“ã¨ã‚’ç¤ºã™ã€‚
** ã‚³ãƒãƒ³ãƒ‰é¡
#+caption: èµ·å‹•ã—ã¦ã„ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’èª¿ã¹ã‚‹
#+begin_src shell
minikube ip
#+end_src

#+RESULTS:
#+begin_results
172.17.0.2
#+end_results

#+caption: èµ·å‹•çŠ¶æ³ç¢ºèª
#+begin_src shell
minikube dashboard
#+end_src

#+caption: ä½œã£ãŸPod(postgres)ã‚’ç¢ºèª
#+begin_src shell
kubectl describe deployment postgres
#+end_src

#+caption: podsã®æƒ…å ±ç¢ºèª
#+begin_src shell
kubectl get Pods
#+end_src

#+caption: èµ·å‹•ã‚µãƒ¼ãƒ“ã‚¹ã‚’é–‹ãã€‚webappã¯ã‚µãƒ¼ãƒ“ã‚¹å
#+begin_src shell
minikube service webapp
#+end_src

#+caption: è©³ç´°æƒ…å ±
#+begin_src shell
kubectl describe service webapp
#+end_src

#+RESULTS:
#+begin_results
Name:                     webapp
Namespace:                default
Labels:                   app=webapp
Annotations:              <none>
Selector:                 app=webapp,tier=frontend
Type:                     NodePort
IP Family Policy:         SingleStack
IP Families:              IPv4
IP:                       10.109.7.196
IPs:                      10.109.7.196
Port:                     <unset>  80/TCP
TargetPort:               80/TCP
NodePort:                 <unset>  30020/TCP
Endpoints:                172.18.0.6:80,172.18.0.7:80,172.18.0.8:80
Session Affinity:         None
External Traffic Policy:  Cluster
Events:                   <none>
#+end_results

ãƒã‚§ãƒƒã‚¯ã—ãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ã«postã—ã¦ã¿ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å€¤ã‚’ä¿å­˜ãƒ»ç™»éŒ²ã§ãã‚‹ã®ã‚’ç¢ºèªã™ã‚‹ã€‚
** ãƒ­ãƒ¼ã‚«ãƒ«ã§è©¦ã™
Kubernetesã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ã‹ã™ã“ã¨ã¯é›£ã—ã„ã®ã§ã€ä»£æ›¿æ‰‹æ®µãŒå¿…è¦ã€‚
minikubeã«ã‚ˆã£ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã§è©¦ã—ãŸã‚Šã€é–‹ç™ºã«ä½¿ã†ã“ã¨ãŒã§ãã‚‹ã€‚

[[https://github.com/kubernetes/minikube][kubernetes/minikube: Run Kubernetes locally]]

å°å…¥æ‰‹é †ã€‚
[[https://minikube.sigs.k8s.io/docs/start/][minikube start | minikube]]

kubectlã‚‚å‹•ã‹ã™ãŸã‚ã«å¿…è¦ã€‚
[[https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/#install-kubectl-binary-with-curl-on-linux][Install and Set Up kubectl on Linux | Kubernetes]]

#+caption: å®Ÿè¡Œ
#+begin_src shell
minikube start
#+end_src

#+caption: ã“ã‚ŒãŒå‡ºã‚Œã°æˆåŠŸ
#+begin_quote
ğŸ„  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by default
#+end_quote

AWSä¸Šã§å‹•ã‹ã™ãŸã‚ã«ã¯ã¾ãŸåˆ¥ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã€‚
#+begin_src shell
export KUBERNETES_PROVIDER=aws; curl -sS https://get.k8s.io | bash
#+end_src
* Tasks
* Reference
- [[https://ja.wikipedia.org/wiki/Kubernetes][Kubernetes - Wikipedia]]
* Archives
