#+title:      プログラミング言語の内部的な違いをアセンブリから調べる
#+date:       [2023-10-14 Sat 12:59]
#+filetags:   :essay:
#+identifier: 20231014T125935

今まで、プログラミング言語の内部的な違いを調べるのに、ソースコードを読むしかないと考えていた。生成アセンブリから調べる方法があるのを知った。

たとえばC言語で、グローバル変数、ローカル変数は全く別の扱いなことを確かめる方法。

- グローバル変数はメモリ上の固定の位置にある

#+caption: グローバル変数を定義する
#+begin_src C
int x;
int y[20];

int main() {
    return x + y[5];
}
#+end_src

#+caption: データはラベル(メモリ番地に名前をつける)に定義されている
#+begin_src asm
x:
  .zero 4
y:
  .zero 80
main:
  movl y+20(%rip), %edx
  movl x(%rip), %eax
  addl %edx, %eax
  ret
#+end_src

- ローカル変数はスタックの中にある

#+caption: ローカル変数を定義する
#+begin_src C
int main() {
    int a = 1;
    return a;
}
#+end_src

#+caption: データはスタック上にある
#+begin_src asm
main:
  pushq %rbp
  movq %rsp, %rbp
  movl $1, -4(%rbp)
  movl -4(%rbp), %eax
  popq %rbp
  ret
#+end_src


関連。
- [[denote:20231014T191829][『低レイヤを知りたい人のためのCコンパイラ作成入門』を読んだ]]。本に書かれていた
