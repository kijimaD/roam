<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2023-02-10 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Shell</title>
<meta name="generator" content="Org mode">
<meta name="author" content="root">
<link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css' /><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Ultra&display=swap" rel="stylesheet"><link rel='stylesheet' href='../css/site.css' /><link rel='stylesheet' href='../roam/css/code.css' /><link rel='stylesheet' href='css/site.css' /><link rel='stylesheet' href='css/code.css' />
</head>
<body>
<div id="preamble" class="status">
<div><div class="header"><div class="container"><div class="row"><div class="col-sm-12 col-md-12"><nav class="navbar navbar-light"/></div></div></div></div></div>
</div>
<div id="content">
<h1 class="title">Shell</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org621227a">概要</a></li>
<li><a href="#orgcb5bc70">Memo</a>
<ul>
<li><a href="#orgdaa1120">sudoでセットされる環境変数は異なる</a></li>
<li><a href="#org0314ebb">シェルのバックグラウンド実行</a></li>
<li><a href="#org9a7debd">カレントディレクトリのファイルサイズ</a></li>
<li><a href="#orga5dbf06">ファイルサイズのランキング</a></li>
<li><a href="#org9eec247">エラー: 公開鍵を利用できないため、以下の署名は検証できませんでした を解決する</a></li>
<li><a href="#org059c2ec">cinnamonを再起動する</a></li>
<li><a href="#org7e43f41">sourceコマンド</a></li>
<li><a href="#org1610258">sshが切れた時に処理が止まらないようにする</a></li>
<li><a href="#orgd0a01a2">コマンドの実行と出力結果を記録する</a></li>
<li><a href="#org552718d">踏み台を経由したssh</a></li>
<li><a href="#orgef2d0f6">input関係の設定を.bash_profile等でしてはいけない理由</a></li>
<li><a href="#org63bc381">cronで通知する</a></li>
<li><a href="#org3a21203">xargsで一括削除</a></li>
<li><a href="#orgdb6f66e">xargsでリポジトリ内一括置換</a></li>
<li><a href="#orgbc4d85f">一括git clone</a></li>
<li><a href="#org0e61fab">Cinnamonのコントロールパネルを出す</a></li>
<li><a href="#orgfc4b4f7">失敗時例外を出す</a></li>
<li><a href="#org0dd98fc">デバッグメッセージ出力</a></li>
<li><a href="#org4eaf84b">GNOMEの音量調整</a></li>
<li><a href="#org30f0523">カレントディレクトリ行数カウント</a></li>
<li><a href="#orgb01ff10">ディレクトリの全ファイルで実行する</a></li>
<li><a href="#orgbd5cbe4">port検索する</a></li>
<li><a href="#org0e5080a">LinuxでWindowsのブートメディアを作成する</a></li>
<li><a href="#orga9b61e0">aptコマンド</a></li>
<li><a href="#org324f891">suspendする</a></li>
<li><a href="#org37a1805">プロセスを止める</a></li>
</ul>
</li>
<li><a href="#org55ce42c">References</a>
<ul>
<li><a href="#orgeaecd01">stedolan/jq: Command-line JSON processor</a></li>
</ul>
</li>
<li><a href="#orgd626c05">Tasks</a>
<ul>
<li><a href="#org83b3225"><span class="todo TODO">TODO</span> インストール済みUbuntuのクローンを新しいハードディスクに作成する：Linux Hacks（1/2 ページ） - ITmedia エンタープライズ</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org621227a" class="outline-2">
<h2 id="org621227a"><a href="#org621227a">概要</a></h2>
<div class="outline-text-2" id="text-org621227a">
<p>
シェルスクリプトはUnixシェルで使われる<a href="20210509101246-programming_language.html#ID-868ac56a-2d42-48d7-ab7f-7047c85a8f39">Programming Language</a>。
</p>
</div>
</div>
<div id="outline-container-orgcb5bc70" class="outline-2">
<h2 id="orgcb5bc70"><a href="#orgcb5bc70">Memo</a></h2>
<div class="outline-text-2" id="text-orgcb5bc70">
</div>
<div id="outline-container-orgdaa1120" class="outline-3">
<h3 id="orgdaa1120"><a href="#orgdaa1120">sudoでセットされる環境変数は異なる</a></h3>
<div class="outline-text-3" id="text-orgdaa1120">
<p>
普通の実行時とsudo時で、セットされている環境変数は異なる。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>これらは異なる結果になる</label><pre class="src src-shell"><span class="org-builtin">export</span> <span class="org-variable-name">TEST</span>=1
env <span class="org-comment-delimiter"># </span><span class="org-comment">&#12371;&#12428;&#12399;TEST&#12434;&#21547;&#12416;</span>
sudo env <span class="org-comment-delimiter"># </span><span class="org-comment">TEST&#12364;&#12394;&#12356;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0314ebb" class="outline-3">
<h3 id="org0314ebb"><a href="#org0314ebb">シェルのバックグラウンド実行</a></h3>
<div class="outline-text-3" id="text-org0314ebb">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>再帰で処理する</label><pre class="src src-git-permalink">https://github.com/kd-collective/NetBSD/blob/89341ae2e1875e7f91cefa9b1dcc0e4549edcde0/bin/sh/jobs.c#L1716-L1865
</pre>
</div>

<div class="results" id="orgda9be53">
<p>
STATIC void
cmdtxt(union node *n)
{
	union node *np;
	struct nodelist *lp;
	const char *p;
	int i;
</p>

<p>
	if (n <code>= NULL || cmdnleft &lt;</code> 0)
		return;
	switch (n-&gt;type) {
	case NSEMI:
		cmdtxt(n-&gt;nbinary.ch1);
		cmdputs(&ldquo;; &rdquo;);
		cmdtxt(n-&gt;nbinary.ch2);
		break;
	case NAND:
		cmdtxt(n-&gt;nbinary.ch1);
		cmdputs(&ldquo; &amp;&amp; &rdquo;);
		cmdtxt(n-&gt;nbinary.ch2);
		break;
	case NOR:
		cmdtxt(n-&gt;nbinary.ch1);
		cmdputs(&ldquo; || &rdquo;);
		cmdtxt(n-&gt;nbinary.ch2);
		break;
	case NDNOT:
		cmdputs(&ldquo;! &rdquo;);
		<i>* FALLTHROUGH *</i>
	case NNOT:
		cmdputs(&ldquo;! &rdquo;);
		cmdtxt(n-&gt;nnot.com);
		break;
	case NPIPE:
		for (lp = n-&gt;npipe.cmdlist ; lp ; lp = lp-&gt;next) {
			cmdtxt(lp-&gt;n);
			if (lp-&gt;next)
				cmdputs(&ldquo; | &rdquo;);
		}
		if (n-&gt;npipe.backgnd)
			cmdputs(&ldquo; &amp;&rdquo;);
		break;
	case NSUBSHELL:
		cmdputs(&ldquo;(&rdquo;);
		cmdtxt(n-&gt;nredir.n);
		cmdputs(&ldquo;)&rdquo;);
		break;
	case NREDIR:
	case NBACKGND:
		cmdtxt(n-&gt;nredir.n);
		break;
	case NIF:
		cmdputs(&ldquo;if &rdquo;);
		cmdtxt(n-&gt;nif.test);
		cmdputs(&ldquo;; then &rdquo;);
		cmdtxt(n-&gt;nif.ifpart);
		if (n-&gt;nif.elsepart) {
			cmdputs(&ldquo;; else &rdquo;);
			cmdtxt(n-&gt;nif.elsepart);
		}
		cmdputs(&ldquo;; fi&rdquo;);
		break;
	case NWHILE:
		cmdputs(&ldquo;while &rdquo;);
		goto until;
	case NUNTIL:
		cmdputs(&ldquo;until &rdquo;);
 until:
		cmdtxt(n-&gt;nbinary.ch1);
		cmdputs(&ldquo;; do &rdquo;);
		cmdtxt(n-&gt;nbinary.ch2);
		cmdputs(&ldquo;; done&rdquo;);
		break;
	case NFOR:
		cmdputs(&ldquo;for &rdquo;);
		cmdputs(n-&gt;nfor.var);
		cmdputs(&ldquo; in &rdquo;);
		cmdlist(n-&gt;nfor.args, 1);
		cmdputs(&ldquo;; do &rdquo;);
		cmdtxt(n-&gt;nfor.body);
		cmdputs(&ldquo;; done&rdquo;);
		break;
	case NCASE:
		cmdputs(&ldquo;case &rdquo;);
		cmdputs(n-&gt;ncase.expr-&gt;narg.text);
		cmdputs(&ldquo; in &rdquo;);
		for (np = n-&gt;ncase.cases; np; np = np-&gt;nclist.next) {
			cmdtxt(np-&gt;nclist.pattern);
			cmdputs(&ldquo;) &rdquo;);
			cmdtxt(np-&gt;nclist.body);
			switch (n-&gt;type) {	<i>* switch (not if) for later *</i>
			case NCLISTCONT:
				cmdputs(&ldquo;;&amp; &rdquo;);
				break;
			default:
				cmdputs(&ldquo;;; &rdquo;);
				break;
			}
		}
		cmdputs(&ldquo;esac&rdquo;);
		break;
	case NDEFUN:
		cmdputs(n-&gt;narg.text);
		cmdputs(&ldquo;() { &#x2026; }&rdquo;);
		break;
	case NCMD:
		cmdlist(n-&gt;ncmd.args, 1);
		cmdlist(n-&gt;ncmd.redirect, 0);
		if (n-&gt;ncmd.backgnd)
			cmdputs(&ldquo; &amp;&rdquo;);
		break;
	case NARG:
		cmdputs(n-&gt;narg.text);
		break;
	case NTO:
		p = &ldquo;&gt;&rdquo;;  i = 1;  goto redir;
	case NCLOBBER:
		p = &ldquo;&gt;|&rdquo;;  i = 1;  goto redir;
	case NAPPEND:
		p = &ldquo;&gt;&gt;&rdquo;;  i = 1;  goto redir;
	case NTOFD:
		p = &ldquo;&gt;&amp;&rdquo;;  i = 1;  goto redir;
	case NFROM:
		p = &ldquo;&lt;&rdquo;;  i = 0;  goto redir;
	case NFROMFD:
		p = &ldquo;&lt;&amp;&rdquo;;  i = 0;  goto redir;
	case NFROMTO:
		p = &ldquo;&lt;&gt;&rdquo;;  i = 0;  goto redir;
 redir:
		if (n-&gt;nfile.fd != i)
			cmdputi(n-&gt;nfile.fd);
		cmdputs(p);
		if (n-&gt;type <code>= NTOFD || n-&gt;type =</code> NFROMFD) {
			if (n-&gt;ndup.dupfd &lt; 0)
				cmdputs(&ldquo;-&rdquo;);
			else
				cmdputi(n-&gt;ndup.dupfd);
		} else {
			cmdtxt(n-&gt;nfile.fname);
		}
		break;
	case NHERE:
	case NXHERE:
		cmdputs(&ldquo;&lt;&lt;&#x2026;&rdquo;);
		break;
	default:
		cmdputs(&ldquo;???&rdquo;);
		break;
	}
}
</p>

</div>
</div>
</div>

<div id="outline-container-org9a7debd" class="outline-3">
<h3 id="org9a7debd"><a href="#org9a7debd">カレントディレクトリのファイルサイズ</a></h3>
<div class="outline-text-3" id="text-org9a7debd">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>-s: 総容量だけ、-h 適当なファイルサイズで表示</label><pre class="src src-shell">du -sh .
</pre>
</div>

<div class="results" id="org440bb21">
<p>
388M	.
</p>

</div>
</div>
</div>

<div id="outline-container-orga5dbf06" class="outline-3">
<h3 id="orga5dbf06"><a href="#orga5dbf06">ファイルサイズのランキング</a></h3>
<div class="outline-text-3" id="text-orga5dbf06">
<p>
サイズ順に、最も大きい10ディレクトリを表示する。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 4: </span>-s: 総容量だけ、 -k キロバイト</label><pre class="src src-shell">du -sk * | sort -rn | head -10
</pre>
</div>

<div class="results" id="org8973211">
<p>
360676	node_modules
3696	public
196	package-lock.json
124	20210624232811-digger.org
100	20210910122240-bookmarks.org
72	20210926143813-clojure.org
68	20210907223510-haskell.org
64	20210508234743-emacs.org
56	20210911113057-go.org
56	20210901101339-rust.org
</p>

</div>

<p>
比較するディレクトリサイズによって単位オプションをKBやMBにする。ソートが機能しなくなるので-hオプションは使用しない。
</p>
</div>
</div>

<div id="outline-container-org9eec247" class="outline-3">
<h3 id="org9eec247"><a href="#org9eec247">エラー: 公開鍵を利用できないため、以下の署名は検証できませんでした を解決する</a></h3>
<div class="outline-text-3" id="text-org9eec247">
<p>
sudo apt-get updateしたとき、GPGエラーが出る解決法。
</p>

<blockquote>
<p>
GPG エラー: <a href="https://">https://</a>&#x2026;. focal InRelease: 公開鍵を利用できないため、以下の署名は検証できませんでした: NO_PUBKEY &#x2026;
</p>
</blockquote>

<p>
pubkeyを追加する。
</p>

<div class="org-src-container">
<pre class="src src-shell">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys aaaaaa... <span class="org-comment-delimiter"># </span><span class="org-comment">aaaaaa...&#12395;&#12289;&#20844;&#38283;&#37749;&#12434;&#21033;&#29992;&#12391;&#12365;&#12394;&#12356;&#12383;&#12417;&#12289;&#20197;&#19979;&#12398;&#32626;&#21517;&#12399;&#26908;&#35388;&#12391;&#12365;&#12414;&#12379;&#12435;&#12391;&#12375;&#12383;: NO_PUBKEY ...&#8592; &#12434;&#20837;&#12428;&#12427;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org059c2ec" class="outline-3">
<h3 id="org059c2ec"><a href="#org059c2ec">cinnamonを再起動する</a></h3>
<div class="outline-text-3" id="text-org059c2ec">
<p>
ウィンドウマネージャを再起動したいときがある。
</p>
<div class="org-src-container">
<pre class="src src-shell">cinnamon --replace
</pre>
</div>
</div>
</div>
<div id="outline-container-org7e43f41" class="outline-3">
<h3 id="org7e43f41"><a href="#org7e43f41">sourceコマンド</a></h3>
<div class="outline-text-3" id="text-org7e43f41">
<p>
sourceは環境変数関係を再読み込みするのによく使う。
<code>source ~~/.bashrc</code> みたいに。
</p>

<p>
bashでは、 <code>.</code> でもできる。
つまり、 <code>. ~~/.bashrc</code> と書いても同じ意味になる。
</p>
</div>
</div>
<div id="outline-container-org1610258" class="outline-3">
<h3 id="org1610258"><a href="#org1610258">sshが切れた時に処理が止まらないようにする</a></h3>
<div class="outline-text-3" id="text-org1610258">
<p>
nohupをつけて実行すると、SSHが切れても実行され続ける。
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 5: </span>ssh先のターミナルにて</label><pre class="src src-shell">nohup make long_job &amp;
</pre>
</div>

<p>
<a href="https://qiita.com/f0o0o/items/7f9dfaf3f7392c0ce52f">sshが切れた時に処理が止まらないようにする - Qiita</a>
</p>
</div>
</div>
<div id="outline-container-orgd0a01a2" class="outline-3">
<h3 id="orgd0a01a2"><a href="#orgd0a01a2">コマンドの実行と出力結果を記録する</a></h3>
<div class="outline-text-3" id="text-orgd0a01a2">
<p>
<code>script</code> コマンドが便利。
実行してオンになると、 <code>exit</code> するまでの履歴をファイルに保存できる。
</p>

<p>
<a href="https://staffblog.amelieff.jp/entry/2020/04/20/130000">簡単にコマンドの実行ログをファイルに記録する方法 - アメリエフの技術ブログ</a>
</p>
</div>
</div>
<div id="outline-container-org552718d" class="outline-3">
<h3 id="org552718d"><a href="#org552718d">踏み台を経由したssh</a></h3>
<div class="outline-text-3" id="text-org552718d">
<p>
普通にやると、2回sshコマンドを実行するので面倒。
configに記入しておいて、一度に実行する。
</p>

<pre class="example">
Host &lt;alias_name&gt;
  HostName &lt;target_server&gt;
  User &lt;target_user&gt;
  IdentityFile &lt;target_id_rsa&gt;
  ProxyCommand ssh -W %h:%p -i &lt;bastion_id_rsa&gt; -p &lt;bastion_port&gt; &lt;bastion_user&gt;@&lt;bastion_server&gt;
</pre>

<p>
<a href="https://qiita.com/hkak03key/items/3b0c4752bfbcc52e676d">踏み台サーバを飛び越えて一発で目的のサーバへsshする方法 - Qiita</a>
</p>
</div>
</div>
<div id="outline-container-orgef2d0f6" class="outline-3">
<h3 id="orgef2d0f6"><a href="#orgef2d0f6">input関係の設定を.bash_profile等でしてはいけない理由</a></h3>
<div class="outline-text-3" id="text-orgef2d0f6">
<p>
<a href="https://wiki.archlinux.jp/index.php/Fcitx#.E6.97.A5.E6.9C.AC.E8.AA.9E">Fcitx - ArchWiki</a>
</p>

<blockquote>
<p>
上記の設定を .bashrc でしないでください。.bashrc はインタラクティブな bash セッションを初期化するときに使われます。インタラクティブでないセッションや X セッションの初期化では用いられません。さらに、.bashrc で環境変数を設定すると、コマンドラインから実行した診断ツールに誤解を与えて、X セッションでは環境変数が使われていないのに正しく設定されているかのように表示されることがあります。
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org63bc381" class="outline-3">
<h3 id="org63bc381"><a href="#org63bc381">cronで通知する</a></h3>
<div class="outline-text-3" id="text-org63bc381">
<p>
cronで時報を通知したいけど、表示されないことがある。これはcronがCLI向けのコマンドであって、画面出力があることを想定してないから。
</p>

<p>
指定する。普通はこれでOK。
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 7: </span>GUIが関係するコマンドを実行するときはDISPLAY=:0をつける</label><pre class="src src-shell"><span class="org-builtin">export</span> <span class="org-variable-name">DISPLAY</span>=:0 &amp;&amp; notify-send <span class="org-string">"&#26178;&#22577;"</span> <span class="org-string">"$(date +\%H):00!"</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 8: </span>実行ログを見る</label><pre class="src src-shell">cat /var/log/syslog
</pre>
</div>

<p>
<a href="20210905140122-exwm.html#ID-eb196529-bdbd-48c5-9d5b-a156fe5c2f41">EXWM</a> + dunstの環境でうまくいかなかった。
DBUS_SESSION_BUS_ADDRESSの設定が必要なよう。参考サイトをコピペすると通知できるようになった。
</p>
<div class="org-src-container">
<pre class="src src-shell">00 * * * * <span class="org-variable-name">DISPLAY</span>=:0 <span class="org-variable-name">DBUS_SESSION_BUS_ADDRESS</span>=unix:<span class="org-variable-name">path</span>=/run/user/1000/bus setpriv --euid=1000 notify-send <span class="org-string">"Timebot"</span> <span class="org-string">"$(date +\%H):00!"</span>
</pre>
</div>
<p>
<a href="https://bbs.archlinux.org/viewtopic.php?id=223050">Cannot run notify-send from cron job / Newbie Corner / Arch Linux Forums</a>
</p>
</div>
</div>
<div id="outline-container-org3a21203" class="outline-3">
<h3 id="org3a21203"><a href="#org3a21203">xargsで一括削除</a></h3>
<div class="outline-text-3" id="text-org3a21203">
<p>
TODO: xargsシリーズどこかにまとめたい。
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 9: </span>.logファイルを一括削除する</label><pre class="src src-shell">find . -name <span class="org-string">"*.log"</span> | xargs rm -fv
</pre>
</div>

<p>
findでファイルのリストを作成して、xargsに渡す。
xargsはファイルを1つずつrmに渡す。
</p>

<p>
xargsにはdry-runモードがある。
</p>
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 10: </span>pオプションがついてると生成コマンドを確認するだけで実行しない</label><pre class="src src-shell">find . -name <span class="org-string">"*.log"</span> | xargs -p rm -fv
</pre>
</div>

<p>
<a href="https://techblog.kyamanak.com/entry/2018/02/12/202256">【Linux】xargs コマンドの使い方がよく分からない - きゃまなかのブログ</a>
</p>
</div>
</div>
<div id="outline-container-orgdb6f66e" class="outline-3">
<h3 id="orgdb6f66e"><a href="#orgdb6f66e">xargsでリポジトリ内一括置換</a></h3>
<div class="outline-text-3" id="text-orgdb6f66e">
<p>
git grep、xargs、sedを組み合わせる。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 11: </span>リポジトリの2.6.5という文字列を2.7.1に置換する例</label><pre class="src src-shell">git grep -l <span class="org-string">'2\.6\.5'</span> | xargs sed -i <span class="org-string">'s/2\.6\.5/2.7.1/g'</span>
</pre>
</div>

<ul class="org-ul">
<li>git grepの <code>l</code> オプションはヒットしたファイル名を出力する。</li>
<li>xargsは標準出力からリストを読み込み、出力を次のコマンドの引数に渡すコマンド。</li>
<li>sedは置換。 <code>i</code> オプションは結果を画面出力しないオプション。 本来は <code>sed -i "s/aaa/bbb/s" Gemfile</code> みたいな順だが、xargsで自動で渡されている。</li>
</ul>
</div>
</div>
<div id="outline-container-orgbc4d85f" class="outline-3">
<h3 id="orgbc4d85f"><a href="#orgbc4d85f">一括git clone</a></h3>
<div class="outline-text-3" id="text-orgbc4d85f">
<p>
<a href="20210926103926-github.html#ID-6b889822-21f1-4a3e-9755-e3ca52fa0bc4">GitHub</a>から、
個人 or 組織のリポジトリをすべてダウンロードする方法。
</p>
<div class="org-src-container">
<pre class="src src-shell">curl https://api.github.com/users/{USER}/repos?<span class="org-variable-name">per_page</span>=100 | jq .[].ssh_url | xargs -n 1 git clone
</pre>
</div>

<div class="org-src-container">
<pre class="src src-shell">curl https://api.github.com/orgs/{ORG}/repos?<span class="org-variable-name">per_page</span>=100  | jq .[].ssh_url | xargs -n 1 git clone
</pre>
</div>

<p>
<code>?per_page=100</code> をつけないとデフォルトの30件しか取ってこないので注意。
100を超えるとページを指定する必要がある。
</p>

<ul class="org-ul">
<li><a href="https://tic40.hatenablog.com/entry/2018/03/26/073000">https://tic40.hatenablog.com/entry/2018/03/26/073000</a></li>
</ul>

<p>
参考に読む用リポジトリは、organizationにまとめておく。
ローカルですぐ閲覧できて便利。
</p>
</div>
</div>
<div id="outline-container-org0e61fab" class="outline-3">
<h3 id="org0e61fab"><a href="#org0e61fab">Cinnamonのコントロールパネルを出す</a></h3>
<div class="outline-text-3" id="text-org0e61fab">
<p>
これが起動できればサウンドやディスプレイ設定もできる。
</p>
<div class="org-src-container">
<pre class="src src-shell">cinnamon-settings
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfc4b4f7" class="outline-3">
<h3 id="orgfc4b4f7"><a href="#orgfc4b4f7">失敗時例外を出す</a></h3>
<div class="outline-text-3" id="text-orgfc4b4f7">
<div class="org-src-container">
<pre class="src src-shell"><span class="org-comment-delimiter">#</span><span class="org-comment">!/bin/</span><span class="org-keyword">bash</span>

<span class="org-builtin">set</span> -e

<span class="org-comment-delimiter"># </span><span class="org-comment">...</span>
</pre>
</div>
<p>
というように、しておくと、実行時できなかったときにエラーメッセージを出す。
何も指定しないと、どこで失敗したのか把握するのが困難。
ローカル環境だといいのだが、CIだと確認コストがかかるので必ず指定しておくとよい。
</p>
</div>
</div>
<div id="outline-container-org0dd98fc" class="outline-3">
<h3 id="org0dd98fc"><a href="#org0dd98fc">デバッグメッセージ出力</a></h3>
<div class="outline-text-3" id="text-org0dd98fc">
<div class="org-src-container">
<pre class="src src-shell"><span class="org-comment-delimiter">#</span><span class="org-comment">!/bin/</span><span class="org-keyword">bash</span><span class="org-comment"> -x</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">...</span>
</pre>
</div>
<p>
-xをつけると評価結果を逐一出力する。
</p>
</div>
</div>
<div id="outline-container-org4eaf84b" class="outline-3">
<h3 id="org4eaf84b"><a href="#org4eaf84b">GNOMEの音量調整</a></h3>
<div class="outline-text-3" id="text-org4eaf84b">
<div class="org-src-container">
<pre class="src src-shell">pactl set-sink-volume @DEFAULT_SINK@ +5%
pactl set-sink-volume @DEFAULT_SINK@ -5%
</pre>
</div>
</div>
</div>
<div id="outline-container-org30f0523" class="outline-3">
<h3 id="org30f0523"><a href="#org30f0523">カレントディレクトリ行数カウント</a></h3>
<div class="outline-text-3" id="text-org30f0523">
<div class="org-src-container">
<pre class="src src-shell">wc -l <span class="org-sh-quoted-exec">`find ./ -name '*.el'`</span>
</pre>
</div>

<p>
別解。
</p>
<div class="org-src-container">
<pre class="src src-shell">git ls-files *.org | xargs wc -c | sort -n
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb01ff10" class="outline-3">
<h3 id="orgb01ff10"><a href="#orgb01ff10">ディレクトリの全ファイルで実行する</a></h3>
<div class="outline-text-3" id="text-orgb01ff10">
<div class="org-src-container">
<pre class="src src-shell"><span class="org-keyword">for</span> file<span class="org-keyword"> in</span> <span class="org-sh-quoted-exec">`\find ./src -name '*.py'`</span>;
<span class="org-keyword">do</span>
<span class="org-builtin">echo</span> $<span class="org-variable-name">file</span>
python $<span class="org-variable-name">file</span> | sed -e s/.*[0-9]m// &gt;&gt; ./docs/query.org
<span class="org-keyword">done</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbd5cbe4" class="outline-3">
<h3 id="orgbd5cbe4"><a href="#orgbd5cbe4">port検索する</a></h3>
<div class="outline-text-3" id="text-orgbd5cbe4">
<p>
port already in used. が出たとき。
</p>

<p>
プロセスを探す。
</p>
<div class="org-src-container">
<pre class="src src-shell">sudo lsof -i:5432
</pre>
</div>

<p>
ポートを使ってるプロセスを削除する。
</p>
<div class="org-src-container">
<pre class="src src-shell">sudo lsof -t -i tcp:5432 | sudo xargs kill -9
</pre>
</div>
</div>
</div>
<div id="outline-container-org0e5080a" class="outline-3">
<h3 id="org0e5080a"><a href="#org0e5080a">LinuxでWindowsのブートメディアを作成する</a></h3>
<div class="outline-text-3" id="text-org0e5080a">
<p>
woeusbというパッケージをインストールして行う。
</p>
<div class="org-src-container">
<pre class="src src-shell">sudo add-apt-repository ppa:tomtomtom/woeusb
sudo apt update &amp;&amp; sudo apt install woeusb-frontend-wxgtk
</pre>
</div>
<p>
<a href="https://www.omgubuntu.co.uk/2017/06/create-bootable-windows-10-usb-ubuntu">https://www.omgubuntu.co.uk/2017/06/create-bootable-windows-10-usb-ubuntu</a>
</p>
</div>
</div>
<div id="outline-container-orga9b61e0" class="outline-3">
<h3 id="orga9b61e0"><a href="#orga9b61e0">aptコマンド</a></h3>
<div class="outline-text-3" id="text-orga9b61e0">
<p>
aptはdebian系ディストリビューションで用いられるパッケージマネージャ。
</p>
<ul class="org-ul">
<li>パッケージ検索</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell">apt search libffi
</pre>
</div>
</div>
</div>
<div id="outline-container-org324f891" class="outline-3">
<h3 id="org324f891"><a href="#org324f891">suspendする</a></h3>
<div class="outline-text-3" id="text-org324f891">
<p>
コマンドでサスペンドする方法。
</p>

<p>
Ubuntuのとき。
</p>
<div class="org-src-container">
<pre class="src src-shell">systemctl suspend
</pre>
</div>

<p>
GNU Guixのとき。
</p>
<div class="org-src-container">
<pre class="src src-shell">loginctl suspend
</pre>
</div>
</div>
</div>
<div id="outline-container-org37a1805" class="outline-3">
<h3 id="org37a1805"><a href="#org37a1805">プロセスを止める</a></h3>
<div class="outline-text-3" id="text-org37a1805">
<p>
簡単に検索、killできる。
</p>
<div class="org-src-container">
<pre class="src src-shell">pgrep firefox
pkill firefox
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org55ce42c" class="outline-2">
<h2 id="org55ce42c"><a href="#org55ce42c">References</a></h2>
<div class="outline-text-2" id="text-org55ce42c">
</div>
<div id="outline-container-orgeaecd01" class="outline-3">
<h3 id="orgeaecd01"><a href="#orgeaecd01"><a href="https://github.com/stedolan/jq">stedolan/jq: Command-line JSON processor</a></a></h3>
<div class="outline-text-3" id="text-orgeaecd01">
<p>
jsonを扱う便利コマンド。
</p>
</div>
</div>
</div>
<div id="outline-container-orgd626c05" class="outline-2">
<h2 id="orgd626c05"><a href="#orgd626c05">Tasks</a></h2>
<div class="outline-text-2" id="text-orgd626c05">
</div>
<div id="outline-container-org83b3225" class="outline-3">
<h3 id="org83b3225"><a href="#org83b3225"><span class="todo TODO">TODO</span> <a href="https://www.itmedia.co.jp/enterprise/articles/0811/20/news019.html">インストール済みUbuntuのクローンを新しいハードディスクに作成する：Linux Hacks（1/2 ページ） - ITmedia エンタープライズ</a></a></h3>
<div class="outline-text-3" id="text-org83b3225">
<p>
まとめておく。
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<footer class="footer py-3"><div class="container"><div class="row "><div class="col-md-4"></div><div class="col-sm col-md"><nav class="navbar"><a class="nav-link text-secondary small px-0" href="./index.html">Insomnia</a><a class="nav-link text-secondary small px-0" href="./sitemap.html">Sitemap</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD/roam">Repository</a><a class="nav-link text-secondary small px-0" href="https://github.com/kijimaD">@kijimaD</a></nav></div><div class="col-md-4"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"/>
</div>
</body>
</html>
